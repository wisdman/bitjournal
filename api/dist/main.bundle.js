(function(e){var n={};function t(r){if(n[r]){return n[r].exports}var i=n[r]={i:r,l:false,exports:{}};e[r].call(i.exports,i,i.exports,t);i.l=true;return i.exports}t.m=e;t.c=n;t.d=function(e,n,r){if(!t.o(e,n)){Object.defineProperty(e,n,{configurable:false,enumerable:true,get:r})}};t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};t.d(n,'a',n);return n};t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.p='';return t(t.s=57)})([function(e,t,n){'use strict';var o=Math.max,d=n(9),u=n.n(d);class p extends Error{constructor(e,t,n){if(t instanceof Error){n=t;t=n.message}if(n===undefined){n=new Error(t||'Unknown internal server error')}if(!t||500<=e){t=d.STATUS_CODES[e]||'Undefined error'}super(t);this.status=e;this.originError=n}}var l=n(13),g=n.n(l),c=n(26),f=n.n(c);class m{constructor(e,t){this.req=e;this.ctx=t}getHeader(e){let t=this.req.headers[e.toLowerCase()];return Array.isArray(t)?t.join(';'):t}get socket(){return this.req.socket}get ip(){return this.getHeader('X-Real-IP')||this.getHeader('X-Forwarded-For')||this.req.connection.remoteAddress||''}get host(){let e=this.getHeader('X-Forwarded-Host')||this.getHeader('Host');return e&&e.split(/\s*,\s*/)[0]||''}get hostname(){if(!this.host)return'';if('['===this.host[0]){let e=/^\[[a-f0-9:]+\]/.exec(this.host);return e&&e[0]||''}return this.host.split(':')[0]||''}get port(){let e=/\:([0-9]+)$/.exec(this.host);return e&&~~e[1]||80}get method(){return(this.req.method||'').toUpperCase()}get path(){return this.req.url||''}get pathname(){return(this.req.url||'').split('?')[0].split(/\/+/).filter((e)=>!!e)}get query(){let e=(this.req.url||'').split('?').slice(1).join('?');return Object(c.parse)(e)}get type(){let e=this.getHeader('Content-Type');if('string'!==typeof e)return;return e.split(';')[0].trim()}get length(){return~~(this.getHeader('content-length')||'')}async raw(){const e=this.length;return new Promise((t,n)=>{let r=Buffer.alloc(0);const i=()=>{u();n(new p(400,'Request aborted'))},s=()=>{u();n(new p(400,'Receive data error'))},a=(e)=>{r=Buffer.concat([r,e])},o=()=>{u();if(0<e&&r.length!==e){n(new p(400,'Request size did not match content length'))}t(r)},d=()=>{u()};var u=()=>{this.req.removeListener('aborted',i);this.req.removeListener('end',s);this.req.removeListener('data',a);this.req.removeListener('error',o);this.req.removeListener('close',d);this.req.unpipe()};this.req.on('aborted',i);this.req.on('error',s);this.req.on('data',a);this.req.on('end',o);this.req.on('close',d)})}async text(){let e=await this.raw();try{let t=new l.StringDecoder('utf8');return t.end(e)}catch(e){throw new p(400,'Receive data is not a UTF8 string',e)}}async json(){if('application/json'!==this.type){throw new p(400,'Only application/json data are allowed')}let e=await this.text();try{return JSON.parse(e)}catch(e){throw new p(400,'Invalid json received')}}valueOf(){return{heders:this.req.headers,ip:this.ip,host:this.host,hostname:this.hostname,port:this.port,method:this.method,path:this.path,pathname:this.pathname,query:this.query,type:this.type,length:this.length}}toJSON(){return this.valueOf()}}var y=n(10),b=n.n(y),h=[{mime:'image/jpeg',extension:'jpg',offset:0,header:new Uint8Array([255,216,255])},{mime:'image/png',extension:'png',offset:0,header:new Uint8Array([137,80,78,71,13,10,26,10])},{mime:'image/gif',extension:'gif',offset:0,header:new Uint8Array([71,73,70])},{mime:'image/webp',extension:'webp',offset:8,header:new Uint8Array([87,69,66,80])}];const w=/<!--([\s\S]*?)-->/g,_=/^\s*(?:<\?xml[^>]*>\s*)?(?:<!doctype svg[^>]*\s*(?:<![^>]*>)*[^>]*>\s*)?<svg[^>]*>[^]*<\/svg>\s*$/i,v=(e)=>{for(let t=0;24>t;t++)if(65533===e[t]||8>=e[t])return true;return false};var E=(e)=>!v(e)&&_.test(e.toString().replace(w,''));class S{constructor(e){const t=e instanceof Uint8Array?e:new Uint8Array(e);if(1>=t.length)return this;for(let n of h)if(this.check(t,n.header,n.offset)){this.mime=n.mime;this.extension=n.extension;return this}if(E(t)){this.mime='image/svg+xml';this.extension='svg';return this}this.mime='application/octet-stream';this.extension=''}check(e,t,n=0){for(let r=0;r<t.length;r++)if(t[r]!==e[r+n])return false;return true}toJSON(){return{extension:this.extension,mime:this.mime}}toString(){return this.mime}[Symbol.toPrimitive](e){switch(e){case'number':throw new TypeError('Cannot convert a FileType value to a number value');case'string':case'default':return this.mime;default:throw new TypeError('Cannot convert a FileType value to unknown value');}}[Symbol.toStringTag](){return'FileType'}}class I{constructor(e,t){this.res=e;this.ctx=t;this.set(404)}get finished(){return this.res.finished}hasHeader(e){return this.res.hasHeader(e)}getHeader(e){let t=this.res.getHeader(e);return Array.isArray(t)?t.join(';'):t}setHeader(e,t){this.res.setHeader(e,t)}removeHeader(e){return this.res.removeHeader(e)}flushHeaders(){return this.res.flushHeaders()}get type(){let e=this.getHeader('Content-Type');if('string'!==typeof e)return;return e.split(';')[0].trim()}get length(){return~~(this.getHeader('Content-Length')||'')}get status(){return this.res.statusCode}get body(){return this._body}set(e,t){if(this.finished)return;if(this.res.headersSent)throw new Error('Headears was sended');if('number'!==typeof e){t=e;e=undefined}if(t===undefined||null===t){this.res.statusCode=e||404;this._body=d.STATUS_CODES[this.res.statusCode];this.removeHeader('Content-Type');this.removeHeader('Content-Length');this.removeHeader('Transfer-Encoding');return}if(null===t){this.res.statusCode=e||204;this._body=null;this.removeHeader('Content-Type');this.removeHeader('Content-Length');this.removeHeader('Transfer-Encoding');return}this.res.statusCode=e||200;if('string'===typeof t){this._body=t;this.setHeader('Content-Type',(/^\s*</.test(t)?'text/html':'text/plain')+'; charset=utf-8');this.setHeader('Content-Length',Buffer.byteLength(t));return}if(Buffer.isBuffer(t)){let e=new S(t);this._body=t;this.setHeader('Content-Type',e.mime||'application/octet-stream');this.setHeader('Content-Length',t.length);let n='inline';const r=Object(y.parse)(this.ctx.request.path);if(r.name){const t=e.extension||r.ext||'';if(t)n+=`; filename=${r.name}.${t}`}this.setHeader('Content-Disposition',n);return}if('object'===typeof t){let e=JSON.stringify(t);this._body=e;this.setHeader('Content-Type','application/json; charset=utf-8');this.setHeader('Content-Length',Buffer.byteLength(e));return}throw TypeError('Unknown response body type')}respond(){if(this.finished)return;if(null===this._body||this._body===undefined){this.res.end()}else{this.res.end(this._body)}}end(e,t){this.set(e,t);this.respond()}valueOf(){return{heders:this.res.getHeaders(),status:this.status,type:this.type,length:this.length,body:this.body}}toJSON(){return this.valueOf()}}var O=n(4),T=n.n(O);function r(e,t){if(!e.status||500<=e.status)console.error('\x1B[31m=== Internal context error ===\n',e,'\x1B[0m\n=== with Context ===\n',t===undefined?undefined:Object(O.inspect)(t.valueOf(),{depth:3,colors:true}))}class A{constructor(e,t){try{this.request=new m(e,this);this.response=new I(t,this)}catch(e){this.throw(e)}}get finished(){return this.response.finished}set(e,t){this.response.set(e,t)}respond(){this.response.respond()}end(e,t){this.response.end(e,t)}throw(e){if(e instanceof p)this.end(e.status,e.message);else this.end(500);r(e,this)}valueOf(){return{request:this.request.valueOf(),response:this.response.valueOf()}}toJSON(){return this.valueOf()}}function i(e){return async function(t,n=()=>Promise.resolve()){let r=-1;const s=(a)=>async()=>{if(a<=r){throw new Error('next() called multiple times')}r=a;if(a>=e.length){return await n()}await e[a].call(this,t,s(a+1))};await s(0)()}}class C extends Function{constructor(e){super('throw new TypeError("CallableClass was called")');return Object.setPrototypeOf(e,new.target.prototype)}}class x extends C{constructor(){super(async(e,t)=>await this.main(e,t))}async main(e,t){await t()}}class R extends Array{static get(e){return this.List.get(e)||new R}static set(e,t){this.List.set(e,t)}}R.List=new WeakMap;const P=/^\*+$/,q=/^\:+(.*)$/,D=/^[a-z][a-z0-9]*$/i,N=(e)=>e.replace(/([.+*?=^!:${}()[\]|/\\])/g,'\\$1');class L{constructor(e=''){this.keys=['*'];let t=e.split(/\s*\/\s*/).filter((e)=>e.length).map((e)=>{if(P.test(e))return'[^/]+';let t=q.exec(e);if(!t)return N(e);let n=t[1];if(!D.test(n))throw TypeError(`Key name "${n}" does not match "${D.source}" pattern`);this.keys.push(n);return'([^/]+)'}).join('(?:/+)');this.pattern=new RegExp('^(?:/+)?'+t+'(?:/+)?$')}exec(e=''){let t=this.pattern.exec(e);if(!t)return;return t.reduce((e,t,n)=>{e[this.keys[n]]=t;return e},{})}}function s(e,t,n,r){const i=new L(t);return async function(s,a){const o=s.route;if(!o)return await a();if(o.finished)return await a();if(o.method!==e||'HEAD'===o.method&&'GET'!==e)return await a();const d=i.exec(o.pathname);if(!d)return await a();for(let e of n)if(!(e in o.query))return await a();o.data=d;s.debug('=== Route %s [%s] ===\n%s %s => %s\nData: %s\nQuery: %s',o.method,o.path,t,n,r,o.data,o.query);await this[r](s,a)}}function a(e,t='',...n){return(r,i)=>{if('symbol'===typeof i)throw new TypeError('Property name must be a string');let a=R.get(r.constructor);a.push(s(e,t,n,i));R.set(r.constructor,a)}}const k=(e,...t)=>a('DELETE',e,...t),M=(e,...t)=>a('GET',e,...t),j=(e,...t)=>a('POST',e,...t),F=(e,...t)=>a('PUT',e,...t);class Q{constructor(e){this.finished=false;this.data={};this.method=e.request.method;this.path=e.request.path;this.pathname='/'+e.request.pathname.join('/');this.query=e.request.query}valueOf(){return{method:this.method,path:this.path,pathname:this.pathname,query:this.query,finished:this.finished,data:this.data}}toJSON(){return this.valueOf()}}const U=Symbol('Route');class $ extends x{constructor(e=Q){super();this.BaseClass=e;this[U]=i(R.get(this.constructor))}async main(e,t){e.route=new this.BaseClass(e);return this[U].call(this,e,t)}}const G=process.env.SERVICE_HOSTNAME||'0.0.0.0',H=o(~~(process.env.SERVICE_PORT||'')||0,0)||80,B=o(~~(process.env.SERVICE_TIMEOUT||'')||0,0)||120,V=o(~~(process.env.SERVICE_KEEP_ALIVE||'')||0,0)||5,z=(process.env.NODE_DEBUG||'').split(/\s*,\s*/).map((e)=>e.toLowerCase().trim()).filter((e)=>!!e);class X extends x{constructor(){super(...arguments);this.enable=z.includes('service'.toLowerCase())}log(...e){let t=e.shift();e=e.map((e)=>Object(O.inspect)(e&&e.valueOf instanceof Function?e.valueOf():e,{depth:3,colors:true}));console.log(t,...e)}async main(e,t){e.debug=this.enable?(...e)=>this.log(...e):()=>undefined;e.debug('=== Input context ===\n%s',e);await t();e.debug('=== Output context ===\n%s',e)}}class W extends d.Server{constructor(...e){super();e.unshift(new X);const t=i(e.map((e)=>e));this.on('request',(e,n)=>{const i=new A(e,n);t(i,()=>Promise.resolve()).then(()=>i.respond()).catch((e)=>{r(e,i);try{i.throw(e)}catch(e){}})});this.on('clientError',(e,t)=>{t.end('HTTP/1.1 400 Bad Request\r\n\r\n');r(e)});this.timeout=B;this.keepAliveTimeout=V;this.listen(H,G,()=>{const e=this.address();console.log(`Opened HTTP server on ${e.address}:${e.port}`)})}}n.d(t,'a',function(){return A});n.d(t,false,function(){return m});n.d(t,false,function(){return I});n.d(t,false,function(){return p});n.d(t,false,function(){return i});n.d(t,'d',function(){return x});n.d(t,'b',function(){return k});n.d(t,'c',function(){return M});n.d(t,'e',function(){return j});n.d(t,'f',function(){return F});n.d(t,false,function(){return Q});n.d(t,'g',function(){return $});n.d(t,'h',function(){return W})},function(e,t,n){'use strict';var r=n(12),i=n.n(r),s=r.randomBytes;const a=['00','01','02','03','04','05','06','07','08','09','0a','0b','0c','0d','0e','0f','10','11','12','13','14','15','16','17','18','19','1a','1b','1c','1d','1e','1f','20','21','22','23','24','25','26','27','28','29','2a','2b','2c','2d','2e','2f','30','31','32','33','34','35','36','37','38','39','3a','3b','3c','3d','3e','3f','40','41','42','43','44','45','46','47','48','49','4a','4b','4c','4d','4e','4f','50','51','52','53','54','55','56','57','58','59','5a','5b','5c','5d','5e','5f','60','61','62','63','64','65','66','67','68','69','6a','6b','6c','6d','6e','6f','70','71','72','73','74','75','76','77','78','79','7a','7b','7c','7d','7e','7f','80','81','82','83','84','85','86','87','88','89','8a','8b','8c','8d','8e','8f','90','91','92','93','94','95','96','97','98','99','9a','9b','9c','9d','9e','9f','a0','a1','a2','a3','a4','a5','a6','a7','a8','a9','aa','ab','ac','ad','ae','af','b0','b1','b2','b3','b4','b5','b6','b7','b8','b9','ba','bb','bc','bd','be','bf','c0','c1','c2','c3','c4','c5','c6','c7','c8','c9','ca','cb','cc','cd','ce','cf','d0','d1','d2','d3','d4','d5','d6','d7','d8','d9','da','db','dc','dd','de','df','e0','e1','e2','e3','e4','e5','e6','e7','e8','e9','ea','eb','ec','ed','ee','ef','f0','f1','f2','f3','f4','f5','f6','f7','f8','f9','fa','fb','fc','fd','fe','ff'];var o=(e)=>a[e[0]]+a[e[1]]+a[e[2]]+a[e[3]]+'-'+a[e[4]]+a[e[5]]+'-'+a[e[6]]+a[e[7]]+'-'+a[e[8]]+a[e[9]]+'-'+a[e[10]]+a[e[11]]+a[e[12]]+a[e[13]]+a[e[14]]+a[e[15]];const d=s(16),u=[1|d[0],d[1],d[2],d[3],d[4],d[5]];let p=16383&(d[6]<<8|d[7]),l=0,g=0;var c=()=>{let e=new Date().getTime(),t=g+1,n=e-l+(t-g)/1e4,r=0>n?16383&p+1:p;if(0>n||e>l){t=0}if(1e4<=t)throw new Error('uuid.v1(): Can\'t create more than 10M uuids/sec');l=e;g=t;p=r;e+=1.22192928e13;let s=0,i=new Uint8Array(16),a=(1e4*(268435455&e)+t)%4294967296;i[s++]=255&a>>>24;i[s++]=255&a>>>16;i[s++]=255&a>>>8;i[s++]=255&a;let d=268435455&1e4*(e/4294967296);i[s++]=255&d>>>8;i[s++]=255&d;i[s++]=16|15&d>>>24;i[s++]=255&d>>>16;i[s++]=128|r>>>8;i[s++]=255&r;for(let e=0;6>e;++e)i[s+e]=u[e];return o(i)};const f=/^[a-f0-9]{8}-[a-f0-9]{4}-1[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}$/i,m=/^[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}$/i,y='00000000-0000-0000-0000-000000000000',b=/^00000000-0000-0000-0000-000000000000$/;class h{constructor(e=null){if(e instanceof h){this.version=e.version;this.uuid=e.uuid;return this}if('string'===typeof e){let t=e.toLowerCase();if(b.test(t)){this.version=null;this.uuid=t;return this}if(f.test(t)){this.version=1;this.uuid=t;return this}if(m.test(t)){this.version=4;this.uuid=t;return this}throw new Error(`UUID "${e}" does not match the UUID string`)}if(null===e){this.version=null;this.uuid=y;return this}if(1===e){this.version=1;this.uuid=c();return this}if(4===e){this.version=4;this.uuid=c();return this}throw new Error(`Illegal UUID version of "${e}"`)}get value(){return this.uuid}valueOf(){return this.uuid}toNumber(){return NaN}toString(){return this.uuid}toJSON(){return this.uuid}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert UUID value to unknown value');}}[Symbol.toStringTag](){return'UUID'}}n.d(t,'a',function(){return h});n.d(t,false,function(){return'[a-f0-9]{8}-[a-f0-9]{4}-1[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}'});n.d(t,false,function(){return f});n.d(t,false,function(){return'[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}'});n.d(t,false,function(){return m});n.d(t,false,function(){return y});n.d(t,false,function(){return b})},function(e,t,n){'use strict';var r=Math.max;class i{constructor(e={}){this.like=r(~~e.like,0);this.dislike=r(~~e.dislike,0)}get value(){return this.like/(this.like+this.dislike)}get stars(){return 5*this.value}valueOf(){return{like:this.like,dislike:this.dislike}}toJSON(){return{like:this.like,dislike:this.dislike}}toNumber(){return this.value}toString(){return String(this.value)}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Raiting value to unknown value');}}[Symbol.toStringTag](){return'Raiting'}}i.MainFields=['symbol','enable','logo','extUrl','title'];class s{constructor(e={}){if(!e)e={};this.symbol=String(e.symbol||'').trim();this.enable=!!e.enable;this.extUrl=String(e.extUrl||'').trim();this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=r(~~e.image,0)||null;this.ogImage=r(~~e.ogImage,0)||null;this.content=String(e.content||'').trim();this.rating=new i(e.rating);this.branding={}}valueOf(){return{symbol:this.symbol,enable:this.enable,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,content:this.content,branding:this.branding}}toJSON(){return{symbol:this.symbol,enable:this.enable,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,content:this.content,rating:this.rating,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Currency value to unknown value');}}[Symbol.toStringTag](){return'Currency'}}s.MainFields=['symbol','enable','extUrl','title','image','rating'];var a=n(1);class o{constructor(e={}){if(!e)e={};this.id=new a.a(e.id||null);this.enable=!!e.enable;this.url=String(e.url||'').trim()||null;this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=r(~~e.image,0)||null;this.ogImage=r(~~e.ogImage,0)||null;this.content=String(e.content||'').trim();this.branding={}}valueOf(){return{enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,content:this.content,branding:this.branding}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,content:this.content,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Exchange value to unknown value');}}[Symbol.toStringTag](){return'Exchange'}}o.MainFields=['id','enable','url','title'];class d{constructor(e={}){if(!e)e={};this.id=new a.a(e.id||null);this.enable=!!e.enable;this.url=String(e.url||'').trim()||null;this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=r(~~e.image,0)||null;this.ogImage=r(~~e.ogImage,0)||null;this.content=String(e.content||'').trim();this.branding={}}valueOf(){return{enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,content:this.content,branding:this.branding}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,content:this.content,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert ICO value to unknown value');}}[Symbol.toStringTag](){return'ICO'}}d.MainFields=['id','enable','url','title'];class u{constructor(e={}){if(!e)e={};this.id=new a.a(e.id||null);this.enable=!!e.enable;this.url=String(e.url||'').trim()||null;this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=r(~~e.image,0)||null;this.ogImage=r(~~e.ogImage,0)||null;this.content=String(e.content||'').trim();this.branding={}}valueOf(){return{enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,content:this.content,branding:this.branding}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,content:this.content,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Market value to unknown value');}}[Symbol.toStringTag](){return'Market'}}u.MainFields=['id','enable','url','title'];class p extends Date{constructor(e){super(e)}get isValid(){return!Number.isNaN(this.getTime())}get isInvalid(){return!this.isValid}valueOf(){return new Date(this)}toNumber(){return this.getTime()}toString(){return this.toISOString()}toJSON(){return this.toISOString()}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Model value to unknown value');}}[Symbol.toStringTag](){return'Timestamp'}}class l{constructor(e={}){if(!e)e={};this.id=new a.a(e.id||null);this.ts=new p(e.ts);this.url=String(e.url||'').trim();this.enable=!!e.enable;this.currencies=Array.isArray(e.currencies)?e.currencies.map(()=>new a.a(e&&e.id||e)).filter((e)=>null!==e.version):new Array;this.exchanges=Array.isArray(e.exchanges)?e.exchanges.map(()=>new a.a(e&&e.id||e)).filter((e)=>null!==e.version):new Array;this.ico=Array.isArray(e.ico)?e.ico.map(()=>new a.a(e&&e.id||e)).filter((e)=>null!==e.version):new Array;this.markets=Array.isArray(e.markets)?e.markets.map(()=>new a.a(e&&e.id||e)).filter((e)=>null!==e.version):new Array;this.sections=Array.isArray(e.sections)?e.sections.map(()=>new a.a(e&&e.id||e)).filter((e)=>null!==e.version):new Array;this.weight=r(~~e.weight,0);this.bigTitle=String(e.bigTitle||'').trim();this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=r(~~e.image,0)||null;this.ogImage=r(~~e.ogImage,0)||null;this.authors=Array.isArray(e.authors)?e.authors.map(()=>new a.a(e&&e.id||e)).filter((e)=>null!==e.version):new Array;this.tags=Array.isArray(e.tags)?e.tags.map((e)=>String(e).trim().toLowerCase()).filter((e)=>!!e):new Array;this.sharing=!!e.sharing;this.comments=!!e.comments;this.advertising=!!e.advertising;this.rss=!!e.rss;this.yandexNews=!!e.yandexNews;this.yandexZen=!!e.yandexZen;this.facebookIA=!!e.facebookIA;this.content=String(e.content||'').trim();this.branding={};this.lastModified=new p(e.lastModified)}valueOf(){return{ts:this.ts,url:this.url,enable:this.enable,currencies:this.currencies,exchanges:this.exchanges,ico:this.ico,markets:this.markets,sections:this.sections,weight:this.weight,bigTitle:this.bigTitle,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,authors:this.authors,tags:this.tags,sharing:this.sharing,comments:this.comments,advertising:this.advertising,rss:this.rss,yandexNews:this.yandexNews,yandexZen:this.yandexZen,facebookIA:this.facebookIA,branding:this.branding,content:this.content,lastModified:this.lastModified}}toJSON(){return{id:this.id,ts:this.ts,url:this.url,enable:this.enable,currencies:this.currencies,exchanges:this.exchanges,ico:this.ico,markets:this.markets,sections:this.sections,weight:this.weight,bigTitle:this.bigTitle,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,authors:this.authors,tags:this.tags,sharing:this.sharing,comments:this.comments,advertising:this.advertising,rss:this.rss,yandexNews:this.yandexNews,yandexZen:this.yandexZen,facebookIA:this.facebookIA,branding:this.branding,content:this.content,lastModified:this.lastModified}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Publication value to unknown value');}}[Symbol.toStringTag](){return'Publication'}}l.MainFields=['id','ts','url','enable','weight','title','lastModified'];class g{constructor(e={}){if(!e)e={};this.id=new a.a(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;this.url=String(e.url||'').trim()||null;this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=r(~~e.image,0)||null;this.ogImage=r(~~e.ogImage,0)||null;this.branding={}}valueOf(){return{enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,branding:this.branding}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Section value to unknown value');}}[Symbol.toStringTag](){return'Section'}}g.MainFields=['id','enable','url','title'];class c{constructor(e={}){if(!e)e={};this.id=new a.a(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;this.title=String(e.title||'').trim();this.image=r(~~e.image,0)||null}valueOf(){return{enable:this.enable,title:this.title,image:this.image}}toJSON(){return{id:this.id,enable:this.enable,title:this.title,image:this.image}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Status value to unknown value');}}[Symbol.toStringTag](){return'Status'}}c.MainFields=['id','enable','title','image'];const f=/^[a-z][a-z0-9]*$/;class m{constructor(e,t){this.id=e;this.value=t;if(!f.test(e))throw new TypeError(`Enum ID "${e}" does not matc the pattern "${f.source}"`)}static*[Symbol.iterator](){const e=Object.keys(this);for(let t of e){yield this[t]}}static get(e){let t=String(e&&e.id||e);for(let n of this)if(n.id===t)return n}static getArray(e){return new Array().concat(e).map((e)=>this.get(e)).filter((e)=>e!==undefined)}valueOf(){return this.id}toNumber(){return NaN}toString(){return this.value}toJSON(){return this.id}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Enum value to unknown value');}}[Symbol.toStringTag](){return'Enum'}}class y extends m{constructor(e,t,n){super(e,t);this.icon=n}[Symbol.toStringTag](){return'UserRole'}}y.User=new y('user','\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C',null);y.Author=new y('author','\u0410\u0432\u0442\u043E\u0440',null);y.Publisher=new y('publisher','\u041F\u0443\u0431\u043B\u0438\u043A\u0430\u0442\u043E\u0440',null);y.Chief=new y('chief','\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440',null);y.Administrator=new y('administrator','\u0410\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440',null);y.Su=new y('su','Super user',null);const b=/^\{([a-z0-9,]+)\}$/;class h{constructor(e={}){if(!e)e={};this.id=new a.a(e.id||null);this.enable=!!e.enable;if(e.roles){const t=b.exec(e.roles),n=t&&t[1].split(',')||e.roles;this.roles=y.getArray(n)}else this.roles=new Array;this.url=String(e.url||'').trim()||null;this.title=String(e.title||'').trim();this.description=String(e.description||'').trim();this.email=String(e.email||'').trim();this.phone=String(e.phone||'').trim()||null;this.image=r(~~e.image,0)||null;this.card={};this.statuses=Array.isArray(e.statuses)?e.statuses.map(()=>new a.a(e&&e.id||e)).filter((e)=>null!==e.version):new Array}checkRole(e){for(let t of e)if(this.roles.includes(t))return true;return false}get valid(){return null!==this.id&&null!==this.id.version}valueOf(){return{enable:this.enable,roles:this.roles,url:this.url,title:this.title,description:this.description,email:this.email,phone:this.phone,image:this.image,card:this.card,statuses:this.statuses}}toJSON(){return{id:this.id,enable:this.enable,roles:this.roles,url:this.url,title:this.title,description:this.description,email:this.email,phone:this.phone,image:this.image,card:this.card,statuses:this.statuses}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert User value to unknown value');}}[Symbol.toStringTag](){return'User'}}h.MainFields=['id','enable','roles','url','title','description','email','phone','image','statuses'];class w{constructor(e={}){if(!e)e={};this.id=String(e.id||'').trim();this.enable=e.enable===undefined?true:!!e.enable}valueOf(){return{id:this.id,enable:this.enable}}toJSON(){return{id:this.id,enable:this.enable}}toNumber(){return NaN}toString(){return this.id}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Video value to unknown value');}}[Symbol.toStringTag](){return'Video'}}w.MainFields=['id','enable'];n.d(t,'a',function(){return s});n.d(t,'b',function(){return o});n.d(t,'c',function(){return d});n.d(t,'d',function(){return u});n.d(t,'e',function(){return l});n.d(t,false,function(){return i});n.d(t,'f',function(){return g});n.d(t,'g',function(){return c});n.d(t,'h',function(){return h});n.d(t,'i',function(){return y});n.d(t,'j',function(){return w})},function(e,t,n){'use strict';var i=Math.max,s=n(0),a=n(14),o=n.n(a);const d=process.env.POSTGRES_HOST||'localhost',u=i(~~(process.env.POSTGRES_PORT||''),0)||5432,p=process.env.POSTGRES_DB||'postgres',l=process.env.POSTGRES_USER||'postgres',g=process.env.POSTGRES_PASSWORD||'',c=i(~~(process.env.POSTGRES_IDLE_TIMEOUT||'')||0,0)||10,f=i(~~(process.env.POSTGRES_POOL_SIZE||'')||0,0)||10,m={host:d,port:u,user:l,password:g,database:p,idleTimeoutMillis:1e3*c,max:f},y=new a.Pool(m);class b extends s.d{constructor(e=m){super();this.pool=new a.Pool(e)}async main(e,t){e.db=await y.connect();await t();e.db.release()}}function r(e=[]){const t=e.map((e)=>e.id);return(n,r,i)=>{if(!i)return i;const s=i.value;i.value=async function(n,r){n.session;if(!n.session){n.debug('=== ACL %s Denied ===\nSession is undefined',t);n.set(403);return await r()}if(!n.session.valid){n.debug('=== ACL %s Denied ===\nSession: %s',t,n.session);n.set(403);return await r()}if(!n.session.user.checkRole(e)){n.debug('=== ACL %s Denied ===\nSession: %s',t,n.session);n.set(403);return await r()}n.debug('=== ACL %s Allow ===\nSession: %s',t,n.session);await s.call(this,n,r)};return i}}var h=n(2);const w=/^[0-9a-z]{128}$/,_=/token\s+([0-9a-f]{128})/;class v{constructor(e){this._ctx=e;this._id='';this._user=null;const t=_.exec(e.request.getHeader('Authorization')||'');this._id=t&&t[1]||''}get id(){return this._id}set id(e){this._id=w.test(e)?e:''}get user(){return this._user}set user(e){if(!e)this._user=null;else{let t=e instanceof h.h?e:new h.h(e);this._user=t.valid?t:null}}get ip(){return this._ctx.request.ip}get valid(){return 0<this.id.length&&this._user instanceof h.h&&this._user.valid}valueOf(){return{id:this._id,user:this._user}}toJSON(){return this.valueOf()}}class E extends s.d{async main(e,t){const n=new v(e),r=e.db,i={text:`SELECT
               "users".*
             FROM
               "sessions"
               LEFT JOIN
               "users"
               ON "sessions"."owner" = "users"."id"
             WHERE
               "sessions"."id" = $1
               AND
               "users"."enable"
               AND
               "sessions"."expires" > timezone('UTC', now())`,values:[n.id]};e.debug(`=== SQL Query SESSION ===\n%s`,i);const s=await r.query(i);e.debug(`=== SQL Result SESSION ===\n%s`,s.rows);if(1===s.rowCount)n.user=new h.h(s.rows[0]);e.session=n;e.debug('=== Input session ===\n%s',e.session);await t();e.debug('=== Output session ===\n%s',e.session)}}n.d(t,'b',function(){return b});n.d(t,'a',function(){return r});n.d(t,false,function(){return v});n.d(t,'c',function(){return E})},function(e){e.exports=require('util')},function(e){e.exports=require('events')},function(e,t,n){'use strict';e.exports={host:'localhost',user:'win32'===process.platform?process.env.USERNAME:process.env.USER,database:'win32'===process.platform?process.env.USERNAME:process.env.USER,password:null,connectionString:undefined,port:5432,rows:0,binary:false,max:10,idleTimeoutMillis:3e4,client_encoding:'',ssl:false,application_name:undefined,fallback_application_name:undefined,parseInputDatesAsUTC:false,statement_timeout:false};var r=n(7),i=r.getTypeParser(20,'text'),s=r.getTypeParser(1016,'text');e.exports.__defineSetter__('parseInt8',function(e){r.setTypeParser(20,'text',e?r.getTypeParser(23,'text'):i);r.setTypeParser(1016,'text',e?r.getTypeParser(1007,'text'):s)})},function(e,t,n){var i=n(28),s=n(33),a=n(16);t.getTypeParser=function(e,t){t=t||'text';if(!o[t]){return r}return o[t][e]||r};t.setTypeParser=function(e,t,n){if('function'==typeof t){n=t;t='text'}o[t][e]=n};t.arrayParser=a;var o={text:{},binary:{}};function r(e){return String(e)}i.init(function(e,t){o.text[e]=t});s.init(function(e,t){o.binary[e]=t})},function(e){e.exports=require('stream')},function(e){e.exports=require('http')},function(e){e.exports=require('path')},function(e,t,n){'use strict';const u=n(12),p=n(6);function r(e){var t=e.replace(/\\/g,'\\\\').replace(/"/g,'\\"');return'"'+t+'"'}function s(e){for(var t='{',n=0;n<e.length;n++){if(0<n){t=t+','}if(null===e[n]||'undefined'===typeof e[n]){t=t+'NULL'}else if(Array.isArray(e[n])){t=t+s(e[n])}else if(e[n]instanceof Buffer){t+='\\\\x'+e[n].toString('hex')}else{t+=r(l(e[n]))}}t=t+'}';return t}var l=function(e,t){if(e instanceof Buffer){return e}if(ArrayBuffer.isView(e)){var n=Buffer.from(e.buffer,e.byteOffset,e.byteLength);if(n.length===e.byteLength){return n}return n.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(e instanceof Date){if(p.parseInputDatesAsUTC){return d(e)}else{return o(e)}}if(Array.isArray(e)){return s(e)}if(null===e||'undefined'===typeof e){return null}if('object'===typeof e){return i(e,t)}return e.toString()};function i(e,t){if(e&&'function'===typeof e.toPostgres){t=t||[];if(-1!==t.indexOf(e)){throw new Error('circular reference detected while preparing "'+e+'" for query')}t.push(e);return l(e.toPostgres(l),t)}return JSON.stringify(e)}function a(e,t){e=''+e;while(e.length<t){e='0'+e}return e}function o(e){var t=-e.getTimezoneOffset(),n=a(e.getFullYear(),4)+'-'+a(e.getMonth()+1,2)+'-'+a(e.getDate(),2)+'T'+a(e.getHours(),2)+':'+a(e.getMinutes(),2)+':'+a(e.getSeconds(),2)+'.'+a(e.getMilliseconds(),3);if(0>t){n+='-';t*=-1}else{n+='+'}return n+a(Math.floor(t/60),2)+':'+a(t%60,2)}function d(e){var t=a(e.getUTCFullYear(),4)+'-'+a(e.getUTCMonth()+1,2)+'-'+a(e.getUTCDate(),2)+'T'+a(e.getUTCHours(),2)+':'+a(e.getUTCMinutes(),2)+':'+a(e.getUTCSeconds(),2)+'.'+a(e.getUTCMilliseconds(),3);return t+'+00:00'}const g=function(e){return u.createHash('md5').update(e,'utf-8').digest('hex')};e.exports={prepareValue:function(e){return l(e)},normalizeQueryConfig:function(e,t,n){e='string'===typeof e?{text:e}:e;if(t){if('function'===typeof t){e.callback=t}else{e.values=t}}if(n){e.callback=n}return e},postgresMd5PasswordHash:function(e,t,n){var r=g(t+e),i=g(Buffer.concat([Buffer.from(r),n]));return'md5'+i},md5:g}},function(e){e.exports=require('crypto')},function(e){e.exports=require('string_decoder')},function(e,t,n){'use strict';var r=n(4),i=n(27),s=n(6),a=n(19),o=n(49);const d=(e)=>{var t=function(t){var n=Object.assign({Client:e},t);return new o(n)};r.inherits(t,o);return t};var u=function(e){this.defaults=s;this.Client=e;this.Query=this.Client.Query;this.Pool=d(this.Client);this._pools=[];this.Connection=a;this.types=n(7)};if('undefined'!==typeof process.env.NODE_PG_FORCE_NATIVE){e.exports=new u(n(21))}else{e.exports=new u(i);e.exports.__defineGetter__('native',function(){delete e.exports.native;var t=null;try{t=new u(n(21))}catch(e){if('MODULE_NOT_FOUND'!==e.code){throw e}console.error(e.message)}e.exports.native=t;return t})}},function(e,t){'use strict';t.parse=function(e,t){return new n(e,t).parse()};function n(e,t){this.source=e;this.transform=t||r;this.position=0;this.entries=[];this.recorded=[];this.dimension=0}n.prototype.isEof=function(){return this.position>=this.source.length};n.prototype.nextCharacter=function(){var e=this.source[this.position++];if('\\'===e){return{value:this.source[this.position++],escaped:true}}return{value:e,escaped:false}};n.prototype.record=function(e){this.recorded.push(e)};n.prototype.newEntry=function(e){var t;if(0<this.recorded.length||e){t=this.recorded.join('');if('NULL'===t&&!e){t=null}if(null!==t)t=this.transform(t);this.entries.push(t);this.recorded=[]}};n.prototype.parse=function(e){var t,r,i;while(!this.isEof()){t=this.nextCharacter();if('{'===t.value&&!i){this.dimension++;if(1<this.dimension){r=new n(this.source.substr(this.position-1),this.transform);this.entries.push(r.parse(true));this.position+=r.position-2}}else if('}'===t.value&&!i){this.dimension--;if(!this.dimension){this.newEntry();if(e)return this.entries}}else if('"'===t.value&&!t.escaped){if(i)this.newEntry(true);i=!i}else if(','===t.value&&!i){this.newEntry()}else{this.record(t.value)}}if(0!==this.dimension){throw new Error('array dimension not balanced')}return this.entries};function r(e){return e}},function(e,t,n){var r=n(15);e.exports={create:function(e,t){return{parse:function(){return r.parse(e,t)}}}}},function(e,t,n){'use strict';var i=n(7);function r(e){this._types=e||i;this.text={};this.binary={}}r.prototype.getOverrides=function(e){switch(e){case'text':return this.text;case'binary':return this.binary;default:return{};}};r.prototype.setTypeParser=function(e,t,n){if('function'===typeof t){n=t;t='text'}this.getOverrides(t)[e]=n};r.prototype.getTypeParser=function(e,t){t=t||'text';return this.getOverrides(t)[e]||this._types.getTypeParser(e,t)};e.exports=r},function(e,t,n){'use strict';var r=n(39),i=n(6),s=n(40).parse,a=function(e,t,n){if(n===undefined){n=process.env['PG'+e.toUpperCase()]}else if(!(false===n)){n=process.env[n]}return t[e]||n||i[e]},o=function(){switch(process.env.PGSSLMODE){case'disable':return false;case'prefer':case'require':case'verify-ca':case'verify-full':return true;}return i.ssl},d=function(e){e='string'===typeof e?s(e):e||{};if(e.connectionString){e=Object.assign({},e,s(e.connectionString))}this.user=a('user',e);this.database=a('database',e);this.port=parseInt(a('port',e),10);this.host=a('host',e);this.password=a('password',e);this.binary=a('binary',e);this.ssl='undefined'===typeof e.ssl?o():e.ssl;this.client_encoding=a('client_encoding',e);this.replication=a('replication',e);this.isDomainSocket=!(this.host||'').indexOf('/');this.application_name=a('application_name',e,'PGAPPNAME');this.fallback_application_name=a('fallback_application_name',e,false);this.statement_timeout=a('statement_timeout',e,false)},u=function(e){return'\''+(''+e).replace(/\\/g,'\\\\').replace(/'/g,'\\\'')+'\''},p=function(e,t,n){var r=t[n];if(r){e.push(n+'='+u(r))}};d.prototype.getLibpqConnectionString=function(e){var t=[];p(t,this,'user');p(t,this,'password');p(t,this,'port');p(t,this,'application_name');p(t,this,'fallback_application_name');var n='object'===typeof this.ssl?this.ssl:{sslmode:this.ssl};p(t,n,'sslmode');p(t,n,'sslca');p(t,n,'sslkey');p(t,n,'sslcert');p(t,n,'sslrootcert');if(this.database){t.push('dbname='+u(this.database))}if(this.replication){t.push('replication='+u(this.replication))}if(this.host){t.push('host='+u(this.host))}if(this.isDomainSocket){return e(null,t.join(' '))}if(this.client_encoding){t.push('client_encoding='+u(this.client_encoding))}r.lookup(this.host,function(n,r){if(n)return e(n,null);t.push('hostaddr='+u(r));return e(null,t.join(' '))})};e.exports=d},function(e,t,n){'use strict';var r=n(45),i=n(5).EventEmitter,s=n(4),a=n(46),o=n(47),d=0,u=function(e){i.call(this);e=e||{};this.stream=e.stream||new r.Stream;this._keepAlive=e.keepAlive;this.lastBuffer=false;this.lastOffset=0;this.buffer=null;this.offset=null;this.encoding=e.encoding||'utf8';this.parsedStatements={};this.writer=new a;this.ssl=e.ssl||false;this._ending=false;this._mode=d;this._emitMessage=false;this._reader=new o({headerSize:1,lengthPadding:-4});var t=this;this.on('newListener',function(e){if('message'===e){t._emitMessage=true}})};s.inherits(u,i);u.prototype.connect=function(e,t){if('closed'===this.stream.readyState){this.stream.connect(e,t)}else if('open'===this.stream.readyState){this.emit('connect')}var r=this;this.stream.on('connect',function(){if(r._keepAlive){r.stream.setKeepAlive(true)}r.emit('connect')});this.stream.on('error',function(e){if(r._ending&&'ECONNRESET'===e.code){return}r.emit('error',e)});this.stream.on('close',function(){r.emit('end')});if(!this.ssl){return this.attachListeners(this.stream)}this.stream.once('data',function(e){var i=e.toString('utf8');if('S'!==i){return r.emit('error',new Error('The server does not support SSL connections'))}var s=n(48);r.stream=s.connect({socket:r.stream,servername:t,rejectUnauthorized:r.ssl.rejectUnauthorized,ca:r.ssl.ca,pfx:r.ssl.pfx,key:r.ssl.key,passphrase:r.ssl.passphrase,cert:r.ssl.cert,NPNProtocols:r.ssl.NPNProtocols});r.attachListeners(r.stream);r.emit('sslconnect');r.stream.on('error',function(e){r.emit('error',e)})})};u.prototype.attachListeners=function(e){var t=this;e.on('data',function(e){t._reader.addChunk(e);var n=t._reader.read();while(n){var r=t.parseMessage(n);if(t._emitMessage){t.emit('message',r)}t.emit(r.name,r);n=t._reader.read()}});e.on('end',function(){t.emit('end')})};u.prototype.requestSsl=function(){var e=this.writer.addInt16(1234).addInt16(5679).flush(),t=e.length+4,n=new a().addInt32(t).add(e).join();this.stream.write(n)};u.prototype.startup=function(e){var t=this.writer.addInt16(3).addInt16(0);Object.keys(e).forEach(function(n){var r=e[n];t.addCString(n).addCString(r)});t.addCString('client_encoding').addCString('\'utf-8\'');var n=t.addCString('').flush(),r=n.length+4,i=new a().addInt32(r).add(n).join();this.stream.write(i)};u.prototype.cancel=function(e,t){var n=this.writer.addInt16(1234).addInt16(5678).addInt32(e).addInt32(t).flush(),r=n.length+4,i=new a().addInt32(r).add(n).join();this.stream.write(i)};u.prototype.password=function(e){this._send(112,this.writer.addCString(e))};u.prototype._send=function(e,t){if(!this.stream.writable){return false}if(true===t){this.writer.addHeader(e)}else{return this.stream.write(this.writer.flush(e))}};u.prototype.query=function(e){this.stream.write(this.writer.addCString(e).flush(81))};u.prototype.parse=function(e,t){e.name=e.name||'';if(63<e.name.length){console.error('Warning! Postgres only supports 63 characters for query names.');console.error('You supplied',e.name,'(',e.name.length,')');console.error('This can cause conflicts and silent errors executing queries')}e.types=e.types||[];for(var n=e.types.length,r=this.writer.addCString(e.name).addCString(e.text).addInt16(n),s=0;s<n;s++){r.addInt32(e.types[s])}this._send(80,t)};u.prototype.bind=function(e,t){e=e||{};e.portal=e.portal||'';e.statement=e.statement||'';e.binary=e.binary||false;for(var n=e.values||[],r=n.length,s=false,a=0;a<r;a++){s|=n[a]instanceof Buffer}var o=this.writer.addCString(e.portal).addCString(e.statement);if(!s){o.addInt16(0)}else{o.addInt16(r);for(a=0;a<r;a++){o.addInt16(n[a]instanceof Buffer)}}o.addInt16(r);for(var d=0,i;d<r;d++){i=n[d];if(null===i||'undefined'===typeof i){o.addInt32(-1)}else if(i instanceof Buffer){o.addInt32(i.length);o.add(i)}else{o.addInt32(Buffer.byteLength(i));o.addString(i)}}if(e.binary){o.addInt16(1);o.addInt16(1)}else{o.addInt16(0)}this._send(66,t)};u.prototype.execute=function(e,t){e=e||{};e.portal=e.portal||'';e.rows=e.rows||'';this.writer.addCString(e.portal).addInt32(e.rows);this._send(69,t)};var p=Buffer.alloc(0);u.prototype.flush=function(){this.writer.add(p);this._send(72)};u.prototype.sync=function(){this.writer.flush(0);this.writer.add(p);this._ending=true;this._send(83)};const l=Buffer.from([88,0,0,0,4]);u.prototype.end=function(){this.writer.add(p);this._ending=true;return this.stream.write(l)};u.prototype.close=function(e,t){this.writer.addCString(e.type+(e.name||''));this._send(67,t)};u.prototype.describe=function(e,t){this.writer.addCString(e.type+(e.name||''));this._send(68,t)};u.prototype.sendCopyFromChunk=function(e){this.stream.write(this.writer.add(e).flush(100))};u.prototype.endCopyFrom=function(){this.stream.write(this.writer.add(p).flush(99))};u.prototype.sendCopyFail=function(e){this.writer.addCString(e);this._send(102)};var g=function(e,t){this.name=e;this.length=t};u.prototype.parseMessage=function(e){this.offset=0;var t=e.length+4;switch(this._reader.header){case 82:return this.parseR(e,t);case 83:return this.parseS(e,t);case 75:return this.parseK(e,t);case 67:return this.parseC(e,t);case 90:return this.parseZ(e,t);case 84:return this.parseT(e,t);case 68:return this.parseD(e,t);case 69:return this.parseE(e,t);case 78:return this.parseN(e,t);case 49:return new g('parseComplete',t);case 50:return new g('bindComplete',t);case 51:return new g('closeComplete',t);case 65:return this.parseA(e,t);case 110:return new g('noData',t);case 73:return new g('emptyQuery',t);case 115:return new g('portalSuspended',t);case 71:return this.parseG(e,t);case 72:return this.parseH(e,t);case 87:return new g('replicationStart',t);case 99:return new g('copyDone',t);case 100:return this.parsed(e,t);}};u.prototype.parseR=function(e,t){var n=0,r=new g('authenticationOk',t);if(8===r.length){n=this.parseInt32(e);if(3===n){r.name='authenticationCleartextPassword'}return r}if(12===r.length){n=this.parseInt32(e);if(5===n){r.name='authenticationMD5Password';r.salt=Buffer.alloc(4);e.copy(r.salt,0,this.offset,this.offset+4);this.offset+=4;return r}}throw new Error('Unknown authenticationOk message type'+s.inspect(r))};u.prototype.parseS=function(e,t){var n=new g('parameterStatus',t);n.parameterName=this.parseCString(e);n.parameterValue=this.parseCString(e);return n};u.prototype.parseK=function(e,t){var n=new g('backendKeyData',t);n.processID=this.parseInt32(e);n.secretKey=this.parseInt32(e);return n};u.prototype.parseC=function(e,t){var n=new g('commandComplete',t);n.text=this.parseCString(e);return n};u.prototype.parseZ=function(e,t){var n=new g('readyForQuery',t);n.name='readyForQuery';n.status=this.readString(e,1);return n};u.prototype.parseT=function(e,t){var n=new g('rowDescription',t);n.fieldCount=this.parseInt16(e);for(var r=[],s=0;s<n.fieldCount;s++){r.push(this.parseField(e))}n.fields=r;return n};var c=function(){this.name=null;this.tableID=null;this.columnID=null;this.dataTypeID=null;this.dataTypeSize=null;this.dataTypeModifier=null;this.format=null};u.prototype.parseField=function(e){var t=new c;t.name=this.parseCString(e);t.tableID=this.parseInt32(e);t.columnID=this.parseInt16(e);t.dataTypeID=this.parseInt32(e);t.dataTypeSize=this.parseInt16(e);t.dataTypeModifier=this.parseInt32(e);if(this.parseInt16(e)===d){this._mode=d;t.format='text'}else{this._mode=1;t.format='binary'}return t};var f=function(e,t){this.name='dataRow';this.length=e;this.fieldCount=t;this.fields=[]};u.prototype.parseD=function(e,t){for(var n=this.parseInt16(e),r=new f(t,n),s=0;s<n;s++){r.fields.push(this._readValue(e))}return r};u.prototype._readValue=function(e){var t=this.parseInt32(e);if(-1===t)return null;if(this._mode===d){return this.readString(e,t)}return this.readBytes(e,t)};u.prototype.parseE=function(e,t){var n={},r,i,s=new g('error',t),a=this.readString(e,1);while('\0'!==a){n[a]=this.parseCString(e);a=this.readString(e,1)}if('error'===s.name){r=new Error(n.M);for(i in s){if(s.hasOwnProperty(i)){r[i]=s[i]}}}else{r=s;r.message=n.M}r.severity=n.S;r.code=n.C;r.detail=n.D;r.hint=n.H;r.position=n.P;r.internalPosition=n.p;r.internalQuery=n.q;r.where=n.W;r.schema=n.s;r.table=n.t;r.column=n.c;r.dataType=n.d;r.constraint=n.n;r.file=n.F;r.line=n.L;r.routine=n.R;return r};u.prototype.parseN=function(e,t){var n=this.parseE(e,t);n.name='notice';return n};u.prototype.parseA=function(e,t){var n=new g('notification',t);n.processId=this.parseInt32(e);n.channel=this.parseCString(e);n.payload=this.parseCString(e);return n};u.prototype.parseG=function(e,t){var n=new g('copyInResponse',t);return this.parseGH(e,n)};u.prototype.parseH=function(e,t){var n=new g('copyOutResponse',t);return this.parseGH(e,n)};u.prototype.parseGH=function(e,t){var n=0!==e[this.offset];this.offset++;t.binary=n;var r=this.parseInt16(e);t.columnTypes=[];for(var s=0;s<r;s++){t.columnTypes.push(this.parseInt16(e))}return t};u.prototype.parsed=function(e,t){var n=new g('copyData',t);n.chunk=this.readBytes(e,n.length-4);return n};u.prototype.parseInt32=function(e){var t=e.readInt32BE(this.offset,true);this.offset+=4;return t};u.prototype.parseInt16=function(e){var t=e.readInt16BE(this.offset,true);this.offset+=2;return t};u.prototype.readString=function(e,t){return e.toString(this.encoding,this.offset,this.offset+=t)};u.prototype.readBytes=function(e,t){return e.slice(this.offset,this.offset+=t)};u.prototype.parseCString=function(e){var t=this.offset,n=e.indexOf(0,t);this.offset=n+1;return e.toString(this.encoding,t,n)};e.exports=u},function(e){e.exports=require('assert')},function(e,t,n){'use strict';e.exports=n(50)},function(e){'use strict';e.exports=function(e,t,n){const r=n&&n.twoArgs;return new Promise(function(n,i){e.call(t,function(e,t,s){if(e){i(e);return}if(r){n([t,s])}else{n(t)}})})}},function(e,t,n){'use strict';var i=n(22),s=n(24),a=n(25);function r(e,t,n){this._query=e;this.oid=t;this._fd=n}r.SEEK_SET=0;r.SEEK_CUR=1;r.SEEK_END=2;r.prototype.close=function(e){this._query({name:'npg_lo_close',text:'SELECT lo_close($1) as ok',values:[this._fd]},e?function(t){e(t)}:undefined)};r.prototype.closeAsync=function(){return i(function(e){this.close(e)},this)};r.prototype.read=function(e,t){this._query({name:'npg_loread',text:'SELECT loread($1, $2) as data',values:[this._fd,e]},function(e,n){if(e)return t(e);var r=n.rows[0].data;t(null,r)})};r.prototype.readAsync=function(e){return i(function(t){this.read(e,t)},this)};r.prototype.write=function(e,t){this._query({name:'npg_lowrite',text:'SELECT lowrite($1, $2)',values:[this._fd,e]},t?function(e){t(e)}:undefined)};r.prototype.writeAsync=function(e){return i(function(t){this.write(e,t)},this)};r.prototype.seek=function(e,t,n){this._query({name:'npg_lo_lseek64',text:'SELECT lo_lseek64($1, $2, $3) as location',values:[this._fd,e,t]},n?function(e,t){if(e)return n(e);var r=t.rows[0].location;n(null,r)}:undefined)};r.prototype.seekAsync=function(e,t){return i(function(n){this.seek(e,t,n)},this)};r.prototype.tell=function(e){this._query({name:'npg_lo_tell64',text:'SELECT lo_tell64($1) as location',values:[this._fd]},function(t,n){if(t)return e(t);var r=n.rows[0].location;e(null,r)})};r.prototype.tellAsync=function(){return i(function(e){this.tell(e)},this)};r.prototype.size=function(e){this._query({name:'npg_size',text:'SELECT lo_lseek64($1, location, 0), seek.size FROM (SELECT lo_lseek64($1, 0, 2) AS SIZE, tell.location FROM (SELECT lo_tell64($1) AS location) tell) seek;',values:[this._fd]},function(t,n){if(t)return e(t);var r=n.rows[0].size;e(null,r)})};r.prototype.sizeAsync=function(){return i(function(e){this.size(e)},this)};r.prototype.truncate=function(e,t){this._query({name:'npg_lo_truncate64',text:'SELECT lo_truncate64($1, $2)',values:[this._fd,e]},t?function(e){t(e)}:undefined)};r.prototype.truncateAsync=function(e){return i(function(t){this.truncate(e,t)},this)};r.prototype.getReadableStream=function(e){return new s(this,e)};r.prototype.getWritableStream=function(e){return new a(this,e)};e.exports=r},function(e,t,n){'use strict';var i=n(8);function r(e,t){i.Readable.call(this,{highWaterMark:t||16384,encoding:null,objectMode:false});this._largeObject=e}r.prototype=Object.create(i.Readable.prototype);r.prototype._read=function(e){if(0>=e){throw'Illegal Argument'}this._largeObject.read(e,function(t,n){if(t){this.emit('error',t);return}this.push(n);if(n.length<e){this.push(null)}}.bind(this))};e.exports=r},function(e,t,n){'use strict';var i=n(8);function r(e,t){i.Writable.call(this,{highWaterMark:t||16384,decodeStrings:true,objectMode:false});this._largeObject=e}r.prototype=Object.create(i.Writable.prototype);r.prototype._write=function(e,t,n){if(!Buffer.isBuffer(e)){throw'Illegal Argument'}this._largeObject.write(e,n)};e.exports=r},function(e){e.exports=require('querystring')},function(e,t,n){'use strict';var r=n(5).EventEmitter,i=n(4),s=n(11),a=n(34),o=n(17),d=n(18),u=n(42),p=n(6),l=n(19),g=function(e){r.call(this);this.connectionParameters=new d(e);this.user=this.connectionParameters.user;this.database=this.connectionParameters.database;this.port=this.connectionParameters.port;this.host=this.connectionParameters.host;this.password=this.connectionParameters.password;this.replication=this.connectionParameters.replication;var t=e||{};this._types=new o(t.types);this._ending=false;this._connecting=false;this._connected=false;this._connectionError=false;this.connection=t.connection||new l({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||false,encoding:this.connectionParameters.client_encoding||'utf8'});this.queryQueue=[];this.binary=t.binary||p.binary;this.processID=null;this.secretKey=null;this.ssl=this.connectionParameters.ssl||false};i.inherits(g,r);g.prototype.connect=function(e){var n=this,r=this.connection;if(this._connecting||this._connected){const t=new Error('Client has already been connected. You cannot reuse a client.');if(e){e(t);return}return Promise.reject(t)}this._connecting=true;if(this.host&&0===this.host.indexOf('/')){r.connect(this.host+'/.s.PGSQL.'+this.port)}else{r.connect(this.port,this.host)}r.on('connect',function(){if(n.ssl){r.requestSsl()}else{r.startup(n.getStartupConf())}});r.on('sslconnect',function(){r.startup(n.getStartupConf())});function t(e){return function(t){if(null!==n.password){e(t)}else{a(n.connectionParameters,function(r){if(undefined!==r){n.connectionParameters.password=n.password=r}e(t)})}}}r.on('authenticationCleartextPassword',t(function(){r.password(n.password)}));r.on('authenticationMD5Password',t(function(e){r.password(s.postgresMd5PasswordHash(n.user,n.password,e.salt))}));r.once('backendKeyData',function(e){n.processID=e.processID;n.secretKey=e.secretKey});const i=(t)=>{if(this._connectionError){return}this._connectionError=true;if(e){return e(t)}this.emit('error',t)},o=(e)=>{if(this.activeQuery){var t=n.activeQuery;this.activeQuery=null;return t.handleError(e,r)}this.emit('error',e)};r.on('error',i);r.once('readyForQuery',function(){n._connecting=false;n._connected=true;n._attachListeners(r);r.removeListener('error',i);r.on('error',o);if(e){e(null,n);e=null}n.emit('connect')});r.on('readyForQuery',function(){var e=n.activeQuery;n.activeQuery=null;n.readyForQuery=true;if(e){e.handleReadyForQuery(r)}n._pulseQueryQueue()});r.once('end',()=>{if(this.activeQuery){var t=new Error('Connection terminated');this.activeQuery.handleError(t,r);this.activeQuery=null}if(!this._ending){const t=new Error('Connection terminated unexpectedly');if(this._connecting&&!this._connectionError){if(e){e(t)}else{this.emit('error',t)}}else if(!this._connectionError){this.emit('error',t)}}this.emit('end')});r.on('notice',function(e){n.emit('notice',e)});if(!e){return new global.Promise((e,t)=>{this.once('error',t);this.once('connect',()=>{this.removeListener('error',t);e()})})}};g.prototype._attachListeners=function(e){const t=this;e.on('rowDescription',function(e){t.activeQuery.handleRowDescription(e)});e.on('dataRow',function(e){t.activeQuery.handleDataRow(e)});e.on('portalSuspended',function(){t.activeQuery.handlePortalSuspended(e)});e.on('emptyQuery',function(){t.activeQuery.handleEmptyQuery(e)});e.on('commandComplete',function(n){t.activeQuery.handleCommandComplete(n,e)});e.on('parseComplete',function(){if(t.activeQuery.name){e.parsedStatements[t.activeQuery.name]=true}});e.on('copyInResponse',function(){t.activeQuery.handleCopyInResponse(t.connection)});e.on('copyData',function(e){t.activeQuery.handleCopyData(e,t.connection)});e.on('notification',function(e){t.emit('notification',e)})};g.prototype.getStartupConf=function(){var e=this.connectionParameters,t={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;if(n){t.application_name=n}if(e.replication){t.replication=''+e.replication}if(e.statement_timeout){t.statement_timeout=String(parseInt(e.statement_timeout,10))}return t};g.prototype.cancel=function(e,t){if(e.activeQuery===t){var n=this.connection;if(this.host&&0===this.host.indexOf('/')){n.connect(this.host+'/.s.PGSQL.'+this.port)}else{n.connect(this.port,this.host)}n.on('connect',function(){n.cancel(e.processID,e.secretKey)})}else if(-1!==e.queryQueue.indexOf(t)){e.queryQueue.splice(e.queryQueue.indexOf(t),1)}};g.prototype.setTypeParser=function(e,t,n){return this._types.setTypeParser(e,t,n)};g.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)};g.prototype.escapeIdentifier=function(e){for(var t='"',n=0,r;n<e.length;n++){r=e[n];if('"'===r){t+=r+r}else{t+=r}}t+='"';return t};g.prototype.escapeLiteral=function(e){for(var t=false,n='\'',r=0,i;r<e.length;r++){i=e[r];if('\''===i){n+=i+i}else if('\\'===i){n+=i+i;t=true}else{n+=i}}n+='\'';if(true===t){n=' E'+n}return n};g.prototype._pulseQueryQueue=function(){if(true===this.readyForQuery){this.activeQuery=this.queryQueue.shift();if(this.activeQuery){this.readyForQuery=false;this.hasExecuted=true;this.activeQuery.submit(this.connection)}else if(this.hasExecuted){this.activeQuery=null;this.emit('drain')}}};g.prototype.query=function(e,t,n){var r,i;if('function'===typeof e.submit){i=r=e;if('function'===typeof t){r.callback=r.callback||t}}else{r=new u(e,t,n);if(!r.callback){let e,t;i=new Promise((n,r)=>{e=n;t=r});r.callback=(n,r)=>n?t(n):e(r)}}if(this.binary&&!r.binary){r.binary=true}if(r._result){r._result._getTypeParser=this._types.getTypeParser.bind(this._types)}this.queryQueue.push(r);this._pulseQueryQueue();return i};g.prototype.end=function(e){this._ending=true;if(this.activeQuery){this.connection.stream.destroy(new Error('Connection terminated by user'));return e?e():Promise.resolve()}if(e){this.connection.end();this.connection.once('end',e)}else{return new global.Promise((e)=>{this.connection.end();this.connection.once('end',e)})}};g.Query=u;e.exports=g},function(e,t,n){var u=n(15),l=n(16),p=n(29),g=n(30),c=n(32);function r(e){return function(t){if(null===t)return t;return e(t)}}function i(e){if(null===e)return e;return'TRUE'===e||'t'===e||'true'===e||'y'===e||'yes'===e||'on'===e||'1'===e}function s(e){if(!e)return null;return u.parse(e,i)}function a(e){return parseInt(e,10)}function o(e){if(!e)return null;return u.parse(e,r(a))}function d(e){if(!e)return null;return u.parse(e,r(function(e){return _(e).trim()}))}var f=function(e){if(!e){return null}var t=l.create(e,function(e){if(null!==e){e=E(e)}return e});return t.parse()},m=function(e){if(!e){return null}var t=l.create(e,function(e){if(null!==e){e=parseFloat(e)}return e});return t.parse()},y=function(e){if(!e){return null}var t=l.create(e);return t.parse()},b=function(e){if(!e){return null}var t=l.create(e,function(e){if(null!==e){e=p(e)}return e});return t.parse()},h=function(e){if(!e){return null}return u.parse(e,r(c))},w=function(e){return parseInt(e,10)},_=function(e){var t=String(e);if(/^\d+$/.test(t)){return t}return e},v=function(e){var t=y(e);if(!t){return t}return t.map(function(e){return JSON.parse(e)})},E=function(e){if('('!==e[0]){return null}e=e.substring(1,e.length-1).split(',');return{x:parseFloat(e[0]),y:parseFloat(e[1])}},S=function(e){if('<'!==e[0]&&'('!==e[1]){return null}for(var t='(',n='',r=false,s=2;s<e.length-1;s++){if(!r){t+=e[s]}if(')'===e[s]){r=true;continue}else if(!r){continue}if(','===e[s]){continue}n+=e[s]}var i=E(t);i.radius=parseFloat(n);return i};e.exports={init:function(e){e(20,_);e(21,w);e(23,w);e(26,w);e(700,parseFloat);e(701,parseFloat);e(16,i);e(1082,p);e(1114,p);e(1184,p);e(600,E);e(651,y);e(718,S);e(1e3,s);e(1001,h);e(1005,o);e(1007,o);e(1028,o);e(1016,d);e(1017,f);e(1021,m);e(1022,m);e(1231,m);e(1014,y);e(1015,y);e(1008,y);e(1009,y);e(1040,y);e(1041,y);e(1115,b);e(1182,b);e(1185,b);e(1186,g);e(17,c);e(114,JSON.parse.bind(JSON));e(3802,JSON.parse.bind(JSON));e(199,v);e(3807,v);e(3907,y);e(2951,y);e(791,y);e(1183,y);e(1270,y)}}},function(e){'use strict';var r=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?/,i=/^(\d{1,})-(\d{2})-(\d{2})$/,s=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,a=/BC$/,o=/^-?infinity$/;e.exports=function(e){if(o.test(e)){return Number(e.replace('i','I'))}var s=r.exec(e);if(!s){return i.test(e)?t(e):null}var d=a.test(e),u=parseInt(s[1],10),p=0<u&&100>u;u=(d?'-':'')+u;var l=parseInt(s[2],10)-1,g=s[3],c=parseInt(s[4],10),f=parseInt(s[5],10),m=parseInt(s[6],10),y=s[7];y=y?1e3*parseFloat(y):0;var b,h=n(e);if(null!=h){var w=Date.UTC(u,l,g,c,f,m,y);b=new Date(w-h)}else{b=new Date(u,l,g,c,f,m,y)}if(p){b.setUTCFullYear(u)}return b};function t(e){var t=i.exec(e),n=parseInt(t[1],10),r=parseInt(t[2],10)-1,s=t[3],a=new Date(n,r,s);a.setFullYear(n);return a}function n(e){var t=s.exec(e.split(' ')[1]);if(!t)return;var n=t[1];if('Z'===n){return 0}var r='-'===n?-1:1,i=3600*parseInt(t[2],10)+60*parseInt(t[3]||0,10)+parseInt(t[4]||0,10);return 1e3*(i*r)}},function(e,t,n){'use strict';var a=n(31);e.exports=r;function r(e){if(!(this instanceof r)){return new r(e)}a(this,s(e))}var o=['seconds','minutes','hours','days','months','years'];r.prototype.toPostgres=function(){var e=o.filter(this.hasOwnProperty,this);if(this.milliseconds&&0>e.indexOf('seconds')){e.push('seconds')}if(0===e.length)return'0';return e.map(function(e){var t=this[e]||0;if('seconds'===e&&this.milliseconds){t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,'')}return t+' '+e},this).join(' ')};var d={years:'Y',months:'M',days:'D',hours:'H',minutes:'M',seconds:'S'},u=['years','months','days'],p=['hours','minutes','seconds'];r.prototype.toISO=function(){var t=u.map(e,this).join(''),n=p.map(e,this).join('');return'P'+t+'T'+n;function e(e){var t=this[e]||0;if('seconds'===e&&this.milliseconds){t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,'')}return t+d[e]}};var l='([+-]?\\d+)',g=new RegExp([l+'\\s+years?',l+'\\s+mons?',l+'\\s+days?','([+-])?([\\d]*):(\\d\\d):(\\d\\d).?(\\d{1,6})?'].map(function(e){return'('+e+')?'}).join('\\s*')),c={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},f=['hours','minutes','seconds','milliseconds'];function i(e){var t=e+'000000'.slice(e.length);return parseInt(t,10)/1e3}function s(e){if(!e)return{};var t=g.exec(e),n='-'===t[8];return Object.keys(c).reduce(function(e,r){var s=c[r],a=t[s];if(!a)return e;a='milliseconds'===r?i(a):parseInt(a,10);if(!a)return e;if(n&&~f.indexOf(r)){a*=-1}e[r]=a;return e},{})}},function(e){e.exports=function(e){for(var n=1,r;n<arguments.length;n++){r=arguments[n];for(var i in r){if(t.call(r,i)){e[i]=r[i]}}}return e};var t=Object.prototype.hasOwnProperty},function(e){'use strict';var t=Math.floor;e.exports=function(e){if(/^\\x/.test(e)){return new Buffer(e.substr(2),'hex')}var n='',r=0;while(r<e.length){if('\\'!==e[r]){n+=e[r];++r}else{if(/[0-7]{3}/.test(e.substr(r+1,3))){n+=String.fromCharCode(parseInt(e.substr(r+1,3),8));r+=4}else{var i=1;while(r+i<e.length&&'\\'===e[r+i]){i++}for(var s=0;s<t(i/2);++s){n+='\\'}r+=2*t(i/2)}}}return new Buffer(n,'binary')}},function(e){var t=Math.pow,n=function(e,n,r,s,a){r=r||0;s=s||false;a=a||function(e,n,r){return e*t(2,r)+n};var o=r>>3,d=function(e){if(s){return 255&~e}return e},u=255,p=8-r%8;if(n<p){u=255&255<<8-n;p=n}if(r){u=u>>r%8}var l=0;if(8<=r%8+n){l=a(0,d(e[o])&u,p)}for(var g=n+r>>3,c=o+1;c<g;c++){l=a(l,d(e[c]),8)}var i=(n+r)%8;if(0<i){l=a(l,d(e[g])>>8-i,i)}return l},r=function(e,r,i){var s=t(2,i-1)-1,a=n(e,1),o=n(e,i,1);if(0===o){return 0}var d=1,u=n(e,r,i+1,false,function(e,t,n){if(0===e){e=1}for(var r=1;r<=n;r++){d/=2;if(0<(t&1<<n-r)){e+=d}}return e});if(o==t(2,i+1)-1){if(0===u){return 0===a?Infinity:-Infinity}return NaN}return(0===a?1:-1)*t(2,o-s)*u},i=function(e){if(1==n(e,1)){return-1*(n(e,15,1,true)+1)}return n(e,15,1)},s=function(e){if(1==n(e,1)){return-1*(n(e,31,1,true)+1)}return n(e,31,1)},a=function(e){return r(e,23,8)},o=function(e){return r(e,52,11)},d=function(e){var r=n(e,16,32);if(49152==r){return NaN}for(var s=t(1e4,n(e,16,16)),a=0,o=n(e,16),d=0;d<o;d++){a+=n(e,16,64+16*d)*s;s/=1e4}var i=t(10,n(e,16,48));return(0===r?1:-1)*Math.round(a*i)/i},u=function(e,t){var r=n(t,1),i=n(t,63,1),s=new Date((0===r?1:-1)*i/1e3+9.466848e11);if(!e){s.setTime(s.getTime()+6e4*s.getTimezoneOffset())}s.usec=i%1e3;s.getMicroSeconds=function(){return this.usec};s.setMicroSeconds=function(e){this.usec=e};s.getUTCMicroSeconds=function(){return this.usec};return s},p=function(e){for(var t=n(e,32),r=n(e,32,32),s=n(e,32,64),a=96,o=[],d=0;d<t;d++){o[d]=n(e,32,a);a+=32;a+=32}var u=function(t){var r=n(e,32,a);a+=32;if(4294967295==r){return null}var i;if(23==t||20==t){i=n(e,8*r,a);a+=8*r;return i}else if(25==t){i=e.toString(this.encoding,a>>3,(a+=r<<3)>>3);return i}else{console.log('ERROR: ElementType not implemented: '+t)}},p=function(e,t){var n=[],r;if(1<e.length){var i=e.shift();for(r=0;r<i;r++){n[r]=p(e,t)}e.unshift(i)}else{for(r=0;r<e[0];r++){n[r]=u(t)}}return n};return p(o,s)},l=function(e){return e.toString('utf8')},g=function(e){if(null===e)return null;return 0<n(e,8)};e.exports={init:function(e){e(21,i);e(23,s);e(26,s);e(1700,d);e(700,a);e(701,o);e(16,g);e(1114,u.bind(null,false));e(1184,u.bind(null,true));e(1e3,p);e(1007,p);e(1016,p);e(1008,p);e(1009,p);e(25,l)}}},function(e,t,n){'use strict';var r=n(10),i=n(35),s=n(36);e.exports=function(e,t){var n=s.getFileName();i.stat(n,function(r,a){if(r||!s.usePgPass(a,n)){return t(undefined)}var o=i.createReadStream(n);s.getPassword(e,o,t)})};e.exports.warnTo=s.warnTo},function(e){e.exports=require('fs')},function(e,t,n){'use strict';var s=n(10),a=n(8).Stream,o=n(37),d=n(4),u='win32'===process.platform,p=process.stderr;function r(e){return(e&61440)==32768}var l=['host','port','database','user','password'],g=l.length,c=l[g-1];function i(){var e=p instanceof a&&true===p.writable;if(e){var t=Array.prototype.slice.call(arguments).concat('\n');p.write(d.format.apply(d,t))}}Object.defineProperty(e.exports,'isWin',{get:function(){return u},set:function(e){u=e}});e.exports.warnTo=function(e){var t=p;p=e;return t};e.exports.getFileName=function(e){e=e||process.env;var t=e.PGPASSFILE||(u?s.join(e.APPDATA,'postgresql','pgpass.conf'):s.join(e.HOME,'.pgpass'));return t};e.exports.usePgPass=function(e,t){if(Object.prototype.hasOwnProperty.call(process.env,'PGPASSWORD')){return false}if(u){return true}t=t||'<unkn>';if(!r(e.mode)){i('WARNING: password file "%s" is not a plain file',t);return false}if(e.mode&(56|7)){i('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',t);return false}return true};var f=e.exports.match=function(e,t){return l.slice(0,-1).reduce(function(n,r,i){if(1==i){if(Number(e[r]||5432)===Number(t[r])){return n&&true}}return n&&('*'===t[r]||t[r]===e[r])},true)};e.exports.getPassword=function(e,t,n){var r,s=t.pipe(new o);var a=function(e){t.destroy();i('WARNING: error on reading file: %s',e);n(undefined)};t.on('error',a);s.on('data',function(t){var n=m(t);if(n&&y(n)&&f(e,n)){r=n[c];s.end()}}).on('end',function(){t.destroy();n(r)}).on('error',a)};var m=e.exports.parseLine=function(e){if(11>e.length||e.match(/^\s+#/)){return null}for(var t='',n='',r=0,s=0,a={},o=false,d=function(t,n,r){var i=e.substring(n,r);if(!Object.hasOwnProperty.call(process.env,'PGPASS_NO_DEESCAPE')){i=i.replace(/\\([:\\])/g,'$1')}a[l[t]]=i},u=0;u<e.length-1;u+=1){t=e.charAt(u+1);n=e.charAt(u);o=r==g-1;if(o){d(r,s);break}if(0<=u&&':'==t&&'\\'!==n){d(r,s,u+1);s=u+2;r+=1}}a=Object.keys(a).length===g?a:null;return a},y=e.exports.isValidEntry=function(e){for(var t={0:function(e){return 0<e.length},1:function(e){if('*'===e){return true}e=Number(e);return isFinite(e)&&0<e&&9007199254740992>e&&Math.floor(e)===e},2:function(e){return 0<e.length},3:function(e){return 0<e.length},4:function(e){return 0<e.length}},n=0;n<l.length;n+=1){var r=t[n],i=e[l[n]]||'',s=r(i);if(!s){return false}}return true}},function(e,t,n){var r=n(38),i=n(13).StringDecoder;e.exports=function(e,t,n){var o=new i,d='',u=n&&n.maxLength,p=n&&false===n.trailing?false:true;if('function'===typeof e)t=e,e=null;if(!e)e=/\r?\n/;function s(e,n){if(t){try{n=t(n)}catch(t){return e.emit('error',t)}if('undefined'!==typeof n)e.queue(n)}else e.queue(n)}function a(t,n){var r=((null!=d?d:'')+n).split(e);d=r.pop();if(u&&d.length>u)return t.emit('error',new Error('maximum buffer reached'));for(var a=0,i;a<r.length;a++){i=r[a];s(t,i)}}return r(function(e){a(this,o.write(e))},function(){if(o.end)a(this,o.end());if(p&&null!=d)s(this,d);this.queue(null)})}},function(e,t,n){var i=n(8);t=e.exports=r;r.through=r;function r(e,t,n){e=e||function(e){this.queue(e)};t=t||function(){this.queue(null)};var a=false,o=false,d=[],u=false,p=new i;p.readable=p.writable=true;p.paused=false;p.autoDestroy=!(n&&false===n.autoDestroy);p.write=function(t){e.call(this,t);return!p.paused};function r(){while(d.length&&!p.paused){var e=d.shift();if(null===e)return p.emit('end');else p.emit('data',e)}}p.queue=p.push=function(e){if(u)return p;if(null===e)u=true;d.push(e);r();return p};p.on('end',function(){p.readable=false;if(!p.writable&&p.autoDestroy)process.nextTick(function(){p.destroy()})});function s(){p.writable=false;t.call(p);if(!p.readable&&p.autoDestroy)p.destroy()}p.end=function(e){if(a)return;a=true;if(arguments.length)p.write(e);s();return p};p.destroy=function(){if(o)return;o=true;a=true;d.length=0;p.writable=p.readable=false;p.emit('close');return p};p.pause=function(){if(p.paused)return;p.paused=true;return p};p.resume=function(){if(p.paused){p.paused=false;p.emit('resume')}r();if(!p.paused)p.emit('drain');return p};return p}},function(e){e.exports=require('dns')},function(e,t,n){'use strict';var r=n(41);e.exports={parse:function(e){var t;if('/'===e.charAt(0)){t=e.split(' ');return{host:t[0],database:t[1]}}if(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(e)){e=encodeURI(e).replace(/\%25(\d\d)/g,'%$1')}var n=r.parse(e,true);t={};if(n.query.application_name){t.application_name=n.query.application_name}if(n.query.fallback_application_name){t.fallback_application_name=n.query.fallback_application_name}t.port=n.port;if('socket:'==n.protocol){t.host=decodeURI(n.pathname);t.database=n.query.db;t.client_encoding=n.query.encoding;return t}t.host=n.hostname;var i=n.pathname;if(i&&'/'===i.charAt(0)){i=n.pathname.slice(1)||null}t.database=i&&decodeURI(i);var s=(n.auth||':').split(':');t.user=s[0];t.password=s.splice(1).join(':');var a=n.query.ssl;if('true'===a||'1'===a){t.ssl=true}return t}}},function(e){e.exports=require('url')},function(e,t,n){'use strict';var r=n(5).EventEmitter,i=n(4),s=n(43),a=n(11),o=function(e,t,n){if(!(this instanceof o)){return new o(e,t,n)}e=a.normalizeQueryConfig(e,t,n);this.text=e.text;this.values=e.values;this.rows=e.rows;this.types=e.types;this.name=e.name;this.binary=e.binary;this.stream=e.stream;this.portal=e.portal||'';this.callback=e.callback;this._rowMode=e.rowMode;if(process.domain&&e.callback){this.callback=process.domain.bind(e.callback)}this._result=new s(this._rowMode,this.types);this._results=this._result;this.isPreparedStatement=false;this._canceledDueToError=false;this._promise=null;r.call(this)};i.inherits(o,r);o.prototype.requiresPreparation=function(){if(this.name){return true}if(this.rows){return true}if(!this.text){return false}if(!this.values){return false}return 0<this.values.length};o.prototype._checkForMultirow=function(){if(this._result.command){if(!Array.isArray(this._results)){this._results=[this._result]}this._result=new s(this._rowMode,this.types);this._results.push(this._result)}};o.prototype.handleRowDescription=function(e){this._checkForMultirow();this._result.addFields(e.fields);this._accumulateRows=this.callback||!this.listeners('row').length};o.prototype.handleDataRow=function(e){var t;if(this._canceledDueToError){return}try{t=this._result.parseRow(e.fields)}catch(e){this._canceledDueToError=e;return}this.emit('row',t,this._result);if(this._accumulateRows){this._result.addRow(t)}};o.prototype.handleCommandComplete=function(e,t){this._checkForMultirow();this._result.addCommandComplete(e);if(this.isPreparedStatement){t.sync()}};o.prototype.handleEmptyQuery=function(e){if(this.isPreparedStatement){e.sync()}};o.prototype.handleReadyForQuery=function(e){if(this._canceledDueToError){return this.handleError(this._canceledDueToError,e)}if(this.callback){this.callback(null,this._results)}this.emit('end',this._results)};o.prototype.handleError=function(e,t){if(this.isPreparedStatement){t.sync()}if(this._canceledDueToError){e=this._canceledDueToError;this._canceledDueToError=false}if(this.callback){return this.callback(e)}this.emit('error',e)};o.prototype.submit=function(e){if('string'!==typeof this.text&&'string'!==typeof this.name){const t=new Error('A query must have either text or a name. Supplying neither is unsupported.');e.emit('error',t);e.emit('readyForQuery');return}if(this.values&&!Array.isArray(this.values)){const t=new Error('Query values must be an array');e.emit('error',t);e.emit('readyForQuery');return}if(this.requiresPreparation()){this.prepare(e)}else{e.query(this.text)}};o.prototype.hasBeenParsed=function(e){return this.name&&e.parsedStatements[this.name]};o.prototype.handlePortalSuspended=function(e){this._getRows(e,this.rows)};o.prototype._getRows=function(e,t){e.execute({portal:this.portalName,rows:t},true);e.flush()};o.prototype.prepare=function(e){var t=this;this.isPreparedStatement=true;if(!this.hasBeenParsed(e)){e.parse({text:t.text,name:t.name,types:t.types},true)}if(t.values){t.values=t.values.map(a.prepareValue)}e.bind({portal:t.portalName,statement:t.name,values:t.values,binary:t.binary},true);e.describe({type:'P',name:t.portalName||''},true);this._getRows(e,this.rows)};o.prototype.handleCopyInResponse=function(e){if(this.stream)this.stream.startStreamingToConnection(e);else e.sendCopyFail('No source stream defined')};o.prototype.handleCopyData=function(e){var t=e.chunk;if(this.stream){this.stream.handleChunk(t)}};e.exports=o},function(e,t,n){'use strict';var r=n(7),s=n(44),i=function(e){this.command=null;this.rowCount=null;this.oid=null;this.rows=[];this.fields=[];this._parsers=[];this.RowCtor=null;this.rowAsArray='array'===e;if(this.rowAsArray){this.parseRow=this._parseRowAsArray}},a=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/;i.prototype.addCommandComplete=function(e){var t;if(e.text){t=a.exec(e.text)}else{t=a.exec(e.command)}if(t){this.command=t[1];if(t[3]){this.oid=parseInt(t[2],10);this.rowCount=parseInt(t[3],10)}else if(t[2]){this.rowCount=parseInt(t[2],10)}}};i.prototype._parseRowAsArray=function(e){for(var t=[],n=0,r=e.length,i;n<r;n++){i=e[n];if(null!==i){t.push(this._parsers[n](i))}else{t.push(null)}}return t};i.prototype.parseRow=function(e){return new this.RowCtor(this._parsers,e)};i.prototype.addRow=function(e){this.rows.push(e)};var o=function(e,t){return'\nthis[\''+s(e)+'\'] = rowData['+t+'] == null ? null : parsers['+t+'](rowData['+t+']);'};i.prototype.addFields=function(e){if(this.fields.length){this.fields=[];this._parsers=[]}for(var t='',n=0,r;n<e.length;n++){r=e[n];this.fields.push(r);var i=this._getTypeParser(r.dataTypeID,r.format||'text');this._parsers.push(i);t+=o(r.name,n)}if(!this.rowAsArray){this.RowCtor=Function('parsers','rowData',t)}};i.prototype._getTypeParser=r.getTypeParser;e.exports=i},function(e){e.exports=function(e){return(''+e).replace(/["'\\\n\r\u2028\u2029]/g,function(e){switch(e){case'"':case'\'':case'\\':return'\\'+e;case'\n':return'\\n';case'\r':return'\\r';case'\u2028':return'\\u2028';case'\u2029':return'\\u2029';}})}},function(e){e.exports=require('net')},function(e){var t=e.exports=function(e){this.size=e||1024;this.buffer=Buffer(this.size+5);this.offset=5;this.headerPosition=0};t.prototype._ensure=function(e){var t=this.buffer.length-this.offset;if(t<e){var n=this.buffer,r=n.length+(n.length>>1)+e;this.buffer=new Buffer(r);n.copy(this.buffer)}};t.prototype.addInt32=function(e){this._ensure(4);this.buffer[this.offset++]=255&e>>>24;this.buffer[this.offset++]=255&e>>>16;this.buffer[this.offset++]=255&e>>>8;this.buffer[this.offset++]=255&e>>>0;return this};t.prototype.addInt16=function(e){this._ensure(2);this.buffer[this.offset++]=255&e>>>8;this.buffer[this.offset++]=255&e>>>0;return this};var n=function(e,t,n,r){e.write(t,n,r)};if(3===Buffer.prototype.write.length){n=function(e,t,n){e.write(t,n)}}t.prototype.addCString=function(e){if(!e){this._ensure(1)}else{var t=Buffer.byteLength(e);this._ensure(t+1);n(this.buffer,e,this.offset,t);this.offset+=t}this.buffer[this.offset++]=0;return this};t.prototype.addChar=function(e){this._ensure(1);n(this.buffer,e,this.offset,1);this.offset++;return this};t.prototype.addString=function(e){e=e||'';var t=Buffer.byteLength(e);this._ensure(t);this.buffer.write(e,this.offset);this.offset+=t;return this};t.prototype.getByteLength=function(){return this.offset-5};t.prototype.add=function(e){this._ensure(e.length);e.copy(this.buffer,this.offset);this.offset+=e.length;return this};t.prototype.clear=function(){this.offset=5;this.headerPosition=0;this.lastEnd=0};t.prototype.addHeader=function(e,t){var n=this.offset;this.offset=this.headerPosition;this.buffer[this.offset++]=e;this.addInt32(n-(this.headerPosition+1));this.headerPosition=n;this.offset=n;if(!t){this._ensure(5);this.offset+=5}};t.prototype.join=function(e){if(e){this.addHeader(e,true)}return this.buffer.slice(e?0:5,this.offset)};t.prototype.flush=function(e){var t=this.join(e);this.clear();return t}},function(e,t,n){var r=n(20),i=e.exports=function(e){if('number'==typeof e){e={headerSize:e}}e=e||{};this.offset=0;this.lastChunk=false;this.chunk=null;this.chunkLength=0;this.headerSize=e.headerSize||0;this.lengthPadding=e.lengthPadding||0;this.header=null;r(2>this.headerSize,'pre-length header of more than 1 byte length not currently supported')};i.prototype.addChunk=function(e){if(!this.chunk||this.offset===this.chunkLength){this.chunk=e;this.chunkLength=e.length;this.offset=0;return}var t=e.length,n=this.chunkLength+t;if(n>this.chunk.length){var r=2*this.chunk.length;while(n>=r){r*=2}var i=new Buffer(r);this.chunk.copy(i);this.chunk=i}e.copy(this.chunk,this.chunkLength);this.chunkLength=n};i.prototype.read=function(){if(this.chunkLength<this.headerSize+4+this.offset){return false}if(this.headerSize){this.header=this.chunk[this.offset]}var e=this.chunk.readUInt32BE(this.offset+this.headerSize)+this.lengthPadding,t=this.chunkLength-(this.offset+4+this.headerSize);if(e>t){return false}this.offset+=this.headerSize+4;var n=this.chunk.slice(this.offset,this.offset+e);this.offset+=e;return n}},function(e){e.exports=require('tls')},function(e,t,n){'use strict';const a=n(5).EventEmitter,o=function(){},d=(e,t)=>{const n=e.findIndex(t);return-1===n?undefined:e.splice(n,1)[0]};class u{constructor(e,t){this.client=e;this.timeoutId=t}}function r(){throw new Error('Release called on client which has already been released to the pool.')}function i(e,t){e.release=r;if(t||this.ending){this._remove(e);this._pulseQueue();return}let n;if(this.options.idleTimeoutMillis){n=setTimeout(()=>{this.log('remove idle client');this._remove(e)},this.options.idleTimeoutMillis)}this._idle.push(new u(e,n));this._pulseQueue()}function s(e,t){if(t){return{callback:t,result:undefined}}let n,r;const i=new e(function(e,t){r=e;n=t});return{callback:function(e,t){e?n(e):r(t)},result:i}}class p extends a{constructor(e,t){super();this.options=Object.assign({},e);this.options.max=this.options.max||this.options.poolSize||10;this.log=this.options.log||function(){};this.Client=this.options.Client||t||n(14).Client;this.Promise=this.options.Promise||global.Promise;if('undefined'===typeof this.options.idleTimeoutMillis){this.options.idleTimeoutMillis=1e4}this._clients=[];this._idle=[];this._pendingQueue=[];this._endCallback=undefined;this.ending=false}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){this.log('pulse queue');if(this.ending){this.log('pulse queue on ending');if(this._idle.length){this._idle.slice().map((e)=>{this._remove(e.client)})}if(!this._clients.length){this._endCallback()}return}if(!this._pendingQueue.length){this.log('no queued requests');return}if(!this._idle.length&&this._isFull()){return}const e=this._pendingQueue.shift();if(this._idle.length){const t=this._idle.pop();clearTimeout(t.timeoutId);const n=t.client;n.release=i.bind(this,n);this.emit('acquire',n);return e(undefined,n,n.release)}if(!this._isFull()){return this.connect(e)}throw new Error('unexpected condition')}_remove(e){const t=d(this._idle,(t)=>t.client===e);if(t!==undefined){clearTimeout(t.timeoutId)}this._clients=this._clients.filter((t)=>t!==e);e.end();this.emit('remove',e)}connect(e){if(this.ending){const t=new Error('Cannot use a pool after calling end on the pool');return e?e(t):this.Promise.reject(t)}if(this._clients.length>=this.options.max||this._idle.length){const t=s(this.Promise,e),n=t.result;if(this._idle.length){process.nextTick(()=>this._pulseQueue())}if(!this.options.connectionTimeoutMillis){this._pendingQueue.push(t.callback);return n}const r=setTimeout(()=>{this._pendingQueue=this._pendingQueue.filter((e)=>e===t.callback);t.callback(new Error('timeout exceeded when trying to connect'))},this.options.connectionTimeoutMillis);this._pendingQueue.push(function(e,n,i){clearTimeout(r);t.callback(e,n,i)});return n}const t=new this.Client(this.options);this._clients.push(t);const n=(e)=>{e.client=t;t.removeListener('error',n);t.on('error',()=>{this.log('additional client error after disconnection due to error',e)});this._remove(t);this.emit('error',e,t)};this.log('connecting new client');let r,a=false;if(this.options.connectionTimeoutMillis){r=setTimeout(()=>{this.log('ending client due to timeout');a=true;t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)}const d=s(this.Promise,e);e=d.callback;this.log('connecting new client');t.connect((s)=>{this.log('new client connected');if(r){clearTimeout(r)}t.on('error',n);if(s){this._clients=this._clients.filter((e)=>e!==t);if(a){s.message='Connection terminiated due to connection timeout'}e(s,undefined,o)}else{t.release=i.bind(this,t);this.emit('connect',t);this.emit('acquire',t);if(this.options.verify){this.options.verify(t,e)}else{e(undefined,t,t.release)}}});return d.result}query(e,t,n){if('function'===typeof e){const t=s(this.Promise,e);setImmediate(function(){return t.callback(new Error('Passing a function as the first parameter to pool.query is not supported'))});return t.result}if('function'===typeof t){n=t;t=undefined}const r=s(this.Promise,n);n=r.callback;this.connect((r,i)=>{if(r){return n(r)}this.log('dispatching query');i.query(e,t,(e,t)=>{this.log('query dispatched');i.release(e);if(e){return n(e)}else{return n(undefined,t)}})});return r.result}end(e){this.log('ending');if(this.ending){const t=new Error('Called end on pool more than once');return e?e(t):this.Promise.reject(t)}this.ending=true;const t=s(this.Promise,e);this._endCallback=t.callback;this._pulseQueue();return t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get totalCount(){return this._clients.length}}e.exports=p},function(e,t,n){'use strict';var r=n(!function(){var t=new Error('Cannot find module "pg-native"');t.code='MODULE_NOT_FOUND';throw t}()),i=n(17),s=n(51),a=n(52),o=n(20),d=n(5).EventEmitter,u=n(4),p=n(18),l='Version >= '+a.minNativeVersion+' of pg-native required.';o(s.gte(r.version,a.minNativeVersion),l);var g=n(53),c=e.exports=function(e){d.call(this);e=e||{};this._types=new i(e.types);this.native=new r({types:this._types});this._queryQueue=[];this._connected=false;this._connecting=false;var t=this.connectionParameters=new p(e);this.user=t.user;this.password=t.password;this.database=t.database;this.host=t.host;this.port=t.port;this.namedQueries={}};c.Query=g;u.inherits(c,d);c.prototype.connect=function(e){var t=this,n=function(n){if(e)return e(n);return t.emit('error',n)},r;if(!e){var i,s;e=(e)=>e?s(e):i();r=new global.Promise(function(e,t){i=e;s=t})}if(this._connecting){process.nextTick(()=>e(new Error('Client has already been connected. You cannot reuse a client.')));return r}this._connecting=true;this.connectionParameters.getLibpqConnectionString(function(r,i){if(r)return n(r);t.native.connect(i,function(r){if(r)return n(r);t._connected=true;t.native.on('error',function(e){if(t._activeQuery&&'end'!==t._activeQuery.state){return}t.emit('error',e)});t.native.on('notification',function(e){t.emit('notification',{channel:e.relname,payload:e.extra})});t.emit('connect');t._pulseQueryQueue(true);if(e)e()})});return r};c.prototype.query=function(e,t,n){if('function'===typeof e.submit){if('function'===typeof t){e.callback=t}this._queryQueue.push(e);this._pulseQueryQueue();return e}var r=new g(e,t,n),i;if(!r.callback){let e,t;i=new Promise((n,r)=>{e=n;t=r});r.callback=(n,r)=>n?t(n):e(r)}this._queryQueue.push(r);this._pulseQueryQueue();return i};c.prototype.end=function(e){var t=this;if(!this._connected){this.once('connect',this.end.bind(this,e))}var n;if(!e){var r,i;e=(e)=>e?i(e):r();n=new global.Promise(function(e,t){r=e;i=t})}this.native.end(function(){if(t._hasActiveQuery()){t._queryQueue.length=0;t._activeQuery.handleError(new Error('Connection terminated'))}t.emit('end');if(e)e()});return n};c.prototype._hasActiveQuery=function(){return this._activeQuery&&'error'!==this._activeQuery.state&&'end'!==this._activeQuery.state};c.prototype._pulseQueryQueue=function(e){if(!this._connected){return}if(this._hasActiveQuery()){return}var t=this._queryQueue.shift();if(!t){if(!e){this.emit('drain')}return}this._activeQuery=t;t.submit(this);var n=this;t.once('_done',function(){n._pulseQueryQueue()})};c.prototype.cancel=function(e){if(this._activeQuery===e){this.native.cancel(function(){})}else if(-1!==this._queryQueue.indexOf(e)){this._queryQueue.splice(this._queryQueue.indexOf(e),1)}};c.prototype.setTypeParser=function(e,t,n){return this._types.setTypeParser(e,t,n)};c.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)}},function(e,t,n){var q,D;if('object'===typeof e&&e.exports===t)t=e.exports=s;var N;if('object'===typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG))N=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift('SEMVER');console.log.apply(console,e)};else N=function(){};t.SEMVER_SPEC_VERSION='2.0.0';var L=256,k=Number.MAX_SAFE_INTEGER||9007199254740991,M=t.re=[],j=t.src=[],F=0,R=F++;j[R]='0|[1-9]\\d*';var Q=F++;j[Q]='[0-9]+';var U=F++;j[U]='\\d*[a-zA-Z-][a-zA-Z0-9-]*';var $=F++;j[$]='('+j[R]+')\\.('+j[R]+')\\.('+j[R]+')';var G=F++;j[G]='('+j[Q]+')\\.('+j[Q]+')\\.('+j[Q]+')';var H=F++;j[H]='(?:'+j[R]+'|'+j[U]+')';var B=F++;j[B]='(?:'+j[Q]+'|'+j[U]+')';var V=F++;j[V]='(?:-('+j[H]+'(?:\\.'+j[H]+')*))';var z=F++;j[z]='(?:-?('+j[B]+'(?:\\.'+j[B]+')*))';var X=F++;j[X]='[0-9A-Za-z-]+';var W=F++;j[W]='(?:\\+('+j[X]+'(?:\\.'+j[X]+')*))';var K=F++,Y='v?'+j[$]+j[V]+'?'+j[W]+'?';j[K]='^'+Y+'$';var Z='[v=\\s]*'+j[G]+j[z]+'?'+j[W]+'?',J=F++;j[J]='^'+Z+'$';var ee=F++;j[ee]='((?:<|>)?=?)';var te=F++;j[te]=j[Q]+'|x|X|\\*';var ne=F++;j[ne]=j[R]+'|x|X|\\*';var re=F++;j[re]='[v=\\s]*('+j[ne]+')(?:\\.('+j[ne]+')(?:\\.('+j[ne]+')(?:'+j[V]+')?'+j[W]+'?)?)?';var ie=F++;j[ie]='[v=\\s]*('+j[te]+')(?:\\.('+j[te]+')(?:\\.('+j[te]+')(?:'+j[z]+')?'+j[W]+'?)?)?';var se=F++;j[se]='^'+j[ee]+'\\s*'+j[re]+'$';var ae=F++;j[ae]='^'+j[ee]+'\\s*'+j[ie]+'$';var oe=F++;j[oe]='(?:~>?)';var de=F++;j[de]='(\\s*)'+j[oe]+'\\s+';M[de]=new RegExp(j[de],'g');var ue=F++;j[ue]='^'+j[oe]+j[re]+'$';var pe=F++;j[pe]='^'+j[oe]+j[ie]+'$';var le=F++;j[le]='(?:\\^)';var ge=F++;j[ge]='(\\s*)'+j[le]+'\\s+';M[ge]=new RegExp(j[ge],'g');var ce=F++;j[ce]='^'+j[le]+j[re]+'$';var fe=F++;j[fe]='^'+j[le]+j[ie]+'$';var me=F++;j[me]='^'+j[ee]+'\\s*('+Z+')$|^$';var ye=F++;j[ye]='^'+j[ee]+'\\s*('+Y+')$|^$';var be=F++;j[be]='(\\s*)'+j[ee]+'\\s*('+Z+'|'+j[re]+')';M[be]=new RegExp(j[be],'g');var he=F++;j[he]='^\\s*('+j[re]+')\\s+-\\s+('+j[re]+')\\s*$';var we=F++;j[we]='^\\s*('+j[ie]+')\\s+-\\s+('+j[ie]+')\\s*$';var _e=F++;j[_e]='(<|>)?=?\\s*\\*';for(var ve=0;ve<F;ve++){N(ve,j[ve]);if(!M[ve])M[ve]=new RegExp(j[ve])}t.parse=r;function r(e,t){if(e.length>L)return null;var n=t?M[J]:M[K];if(!n.test(e))return null;try{return new s(e,t)}catch(e){return null}}t.valid=function(e,t){var n=r(e,t);return n?n.version:null};t.clean=function(e,t){var n=r(e.trim().replace(/^[=v]+/,''),t);return n?n.version:null};t.SemVer=s;function s(e,t){if(e instanceof s){if(e.loose===t)return e;else e=e.version}else if('string'!==typeof e){throw new TypeError('Invalid Version: '+e)}if(e.length>L)throw new TypeError('version is longer than '+L+' characters');if(!(this instanceof s))return new s(e,t);N('SemVer',e,t);this.loose=t;var n=e.trim().match(t?M[J]:M[K]);if(!n)throw new TypeError('Invalid Version: '+e);this.raw=e;this.major=+n[1];this.minor=+n[2];this.patch=+n[3];if(this.major>k||0>this.major)throw new TypeError('Invalid major version');if(this.minor>k||0>this.minor)throw new TypeError('Invalid minor version');if(this.patch>k||0>this.patch)throw new TypeError('Invalid patch version');if(!n[4])this.prerelease=[];else this.prerelease=n[4].split('.').map(function(e){return /^[0-9]+$/.test(e)?+e:e});this.build=n[5]?n[5].split('.'):[];this.format()}s.prototype.format=function(){this.version=this.major+'.'+this.minor+'.'+this.patch;if(this.prerelease.length)this.version+='-'+this.prerelease.join('.');return this.version};s.prototype.inspect=function(){return'<SemVer "'+this+'">'};s.prototype.toString=function(){return this.version};s.prototype.compare=function(e){N('SemVer.compare',this.version,this.loose,e);if(!(e instanceof s))e=new s(e,this.loose);return this.compareMain(e)||this.comparePre(e)};s.prototype.compareMain=function(e){if(!(e instanceof s))e=new s(e,this.loose);return o(this.major,e.major)||o(this.minor,e.minor)||o(this.patch,e.patch)};s.prototype.comparePre=function(e){if(!(e instanceof s))e=new s(e,this.loose);if(this.prerelease.length&&!e.prerelease.length)return-1;else if(!this.prerelease.length&&e.prerelease.length)return 1;else if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],r=e.prerelease[t];N('prerelease compare',t,n,r);if(n===undefined&&r===undefined)return 0;else if(r===undefined)return 1;else if(n===undefined)return-1;else if(n===r)continue;else return o(n,r)}while(++t)};s.prototype.inc=function(e,t){switch(e){case'premajor':this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc('pre',t);break;case'preminor':this.prerelease.length=0;this.patch=0;this.minor++;this.inc('pre',t);break;case'prepatch':this.prerelease.length=0;this.inc('patch',t);this.inc('pre',t);break;case'prerelease':if(0===this.prerelease.length)this.inc('patch',t);this.inc('pre',t);break;case'major':if(0!==this.minor||0!==this.patch||0===this.prerelease.length)this.major++;this.minor=0;this.patch=0;this.prerelease=[];break;case'minor':if(0!==this.patch||0===this.prerelease.length)this.minor++;this.patch=0;this.prerelease=[];break;case'patch':if(0===this.prerelease.length)this.patch++;this.prerelease=[];break;case'pre':if(0===this.prerelease.length)this.prerelease=[0];else{var n=this.prerelease.length;while(0<=--n){if('number'===typeof this.prerelease[n]){this.prerelease[n]++;n=-2}}if(-1===n)this.prerelease.push(0)}if(t){if(this.prerelease[0]===t){if(isNaN(this.prerelease[1]))this.prerelease=[t,0]}else this.prerelease=[t,0]}break;default:throw new Error('invalid increment argument: '+e);}this.format();return this};t.inc=function(e,t,n,r){if('string'===typeof n){r=n;n=undefined}try{return new s(e,n).inc(t,r).version}catch(e){return null}};t.diff=function(e,t){if(g(e,t)){return null}else{var n=r(e),i=r(t);if(n.prerelease.length||i.prerelease.length){for(var s in n){if('major'===s||'minor'===s||'patch'===s){if(n[s]!==i[s]){return'pre'+s}}}return'prerelease'}for(var s in n){if('major'===s||'minor'===s||'patch'===s){if(n[s]!==i[s]){return s}}}}};t.compareIdentifiers=o;var i=/^[0-9]+$/;function o(e,t){var n=i.test(e),r=i.test(t);if(n&&r){e=+e;t=+t}return n&&!r?-1:r&&!n?1:e<t?-1:e>t?1:0}t.rcompareIdentifiers=function(e,t){return o(t,e)};t.major=function(e,t){return new s(e,t).major};t.minor=function(e,t){return new s(e,t).minor};t.patch=function(e,t){return new s(e,t).patch};t.compare=d;function d(e,t,n){return new s(e,n).compare(t)}t.compareLoose=function(e,t){return d(e,t,true)};t.rcompare=u;function u(e,t,n){return d(t,e,n)}t.sort=function(e,n){return e.sort(function(e,r){return t.compare(e,r,n)})};t.rsort=function(e,n){return e.sort(function(e,r){return t.rcompare(e,r,n)})};t.gt=p;function p(e,t,n){return 0<d(e,t,n)}t.lt=l;function l(e,t,n){return 0>d(e,t,n)}t.eq=g;function g(e,t,n){return 0===d(e,t,n)}t.neq=c;function c(e,t,n){return 0!==d(e,t,n)}t.gte=f;function f(e,t,n){return 0<=d(e,t,n)}t.lte=m;function m(e,t,n){return 0>=d(e,t,n)}t.cmp=a;function a(e,t,n,r){var i;switch(t){case'===':if('object'===typeof e)e=e.version;if('object'===typeof n)n=n.version;i=e===n;break;case'!==':if('object'===typeof e)e=e.version;if('object'===typeof n)n=n.version;i=e!==n;break;case'':case'=':case'==':i=g(e,n,r);break;case'!=':i=c(e,n,r);break;case'>':i=p(e,n,r);break;case'>=':i=f(e,n,r);break;case'<':i=l(e,n,r);break;case'<=':i=m(e,n,r);break;default:throw new TypeError('Invalid operator: '+t);}return i}t.Comparator=y;function y(e,t){if(e instanceof y){if(e.loose===t)return e;else e=e.value}if(!(this instanceof y))return new y(e,t);N('comparator',e,t);this.loose=t;this.parse(e);if(this.semver===Ee)this.value='';else this.value=this.operator+this.semver.version;N('comp',this)}var Ee={};y.prototype.parse=function(e){var t=this.loose?M[me]:M[ye],n=e.match(t);if(!n)throw new TypeError('Invalid comparator: '+e);this.operator=n[1];if('='===this.operator)this.operator='';if(!n[2])this.semver=Ee;else this.semver=new s(n[2],this.loose)};y.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'};y.prototype.toString=function(){return this.value};y.prototype.test=function(e){N('Comparator.test',e,this.loose);if(this.semver===Ee)return true;if('string'===typeof e)e=new s(e,this.loose);return a(e,this.operator,this.semver,this.loose)};t.Range=b;function b(e,t){if(e instanceof b&&e.loose===t)return e;if(!(this instanceof b))return new b(e,t);this.loose=t;this.raw=e;this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length});if(!this.set.length){throw new TypeError('Invalid SemVer Range: '+e)}this.format()}b.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'};b.prototype.format=function(){this.range=this.set.map(function(e){return e.join(' ').trim()}).join('||').trim();return this.range};b.prototype.toString=function(){return this.range};b.prototype.parseRange=function(e){var t=this.loose;e=e.trim();N('range',e,t);var n=t?M[we]:M[he];e=e.replace(n,A);N('hyphen replace',e);e=e.replace(M[be],'$1$2$3');N('comparator trim',e,M[be]);e=e.replace(M[de],'$1~');e=e.replace(M[ge],'$1^');e=e.split(/\s+/).join(' ');var r=t?M[me]:M[ye],i=e.split(' ').map(function(e){return h(e,t)}).join(' ').split(/\s+/);if(this.loose){i=i.filter(function(e){return!!e.match(r)})}i=i.map(function(e){return new y(e,t)});return i};t.toComparators=function(e,t){return new b(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(' ').trim().split(' ')})};function h(e,t){N('comp',e);e=E(e,t);N('caret',e);e=_(e,t);N('tildes',e);e=I(e,t);N('xrange',e);e=T(e,t);N('stars',e);return e}function w(e){return!e||'x'===e.toLowerCase()||'*'===e}function _(e,t){return e.trim().split(/\s+/).map(function(e){return v(e,t)}).join(' ')}function v(e,t){var n=t?M[pe]:M[ue];return e.replace(n,function(t,n,r,i,s){N('tilde',e,t,n,r,i,s);var a;if(w(n))a='';else if(w(r))a='>='+n+'.0.0 <'+(+n+1)+'.0.0';else if(w(i))a='>='+n+'.'+r+'.0 <'+n+'.'+(+r+1)+'.0';else if(s){N('replaceTilde pr',s);if('-'!==s.charAt(0))s='-'+s;a='>='+n+'.'+r+'.'+i+s+' <'+n+'.'+(+r+1)+'.0'}else a='>='+n+'.'+r+'.'+i+' <'+n+'.'+(+r+1)+'.0';N('tilde return',a);return a})}function E(e,t){return e.trim().split(/\s+/).map(function(e){return S(e,t)}).join(' ')}function S(e,t){N('caret',e,t);var n=t?M[fe]:M[ce];return e.replace(n,function(t,n,r,i,s){N('caret',e,t,n,r,i,s);var a;if(w(n))a='';else if(w(r))a='>='+n+'.0.0 <'+(+n+1)+'.0.0';else if(w(i)){if('0'===n)a='>='+n+'.'+r+'.0 <'+n+'.'+(+r+1)+'.0';else a='>='+n+'.'+r+'.0 <'+(+n+1)+'.0.0'}else if(s){N('replaceCaret pr',s);if('-'!==s.charAt(0))s='-'+s;if('0'===n){if('0'===r)a='>='+n+'.'+r+'.'+i+s+' <'+n+'.'+r+'.'+(+i+1);else a='>='+n+'.'+r+'.'+i+s+' <'+n+'.'+(+r+1)+'.0'}else a='>='+n+'.'+r+'.'+i+s+' <'+(+n+1)+'.0.0'}else{N('no pr');if('0'===n){if('0'===r)a='>='+n+'.'+r+'.'+i+' <'+n+'.'+r+'.'+(+i+1);else a='>='+n+'.'+r+'.'+i+' <'+n+'.'+(+r+1)+'.0'}else a='>='+n+'.'+r+'.'+i+' <'+(+n+1)+'.0.0'}N('caret return',a);return a})}function I(e,t){N('replaceXRanges',e,t);return e.split(/\s+/).map(function(e){return O(e,t)}).join(' ')}function O(e,t){e=e.trim();var n=t?M[ae]:M[se];return e.replace(n,function(t,n,r,i,s,a){N('xRange',e,t,n,r,i,s,a);var o=w(r),d=o||w(i),u=d||w(s),p=u;if('='===n&&p)n='';if(o){if('>'===n||'<'===n){t='<0.0.0'}else{t='*'}}else if(n&&p){if(d)i=0;if(u)s=0;if('>'===n){n='>=';if(d){r=+r+1;i=0;s=0}else if(u){i=+i+1;s=0}}else if('<='===n){n='<';if(d)r=+r+1;else i=+i+1}t=n+r+'.'+i+'.'+s}else if(d){t='>='+r+'.0.0 <'+(+r+1)+'.0.0'}else if(u){t='>='+r+'.'+i+'.0 <'+r+'.'+(+i+1)+'.0'}N('xRange return',t);return t})}function T(e,t){N('replaceStars',e,t);return e.trim().replace(M[_e],'')}function A(e,t,n,r,i,s,a,o,d,u,p,l){if(w(n))t='';else if(w(r))t='>='+n+'.0.0';else if(w(i))t='>='+n+'.'+r+'.0';else t='>='+t;if(w(d))o='';else if(w(u))o='<'+(+d+1)+'.0.0';else if(w(p))o='<'+d+'.'+(+u+1)+'.0';else if(l)o='<='+d+'.'+u+'.'+p+'-'+l;else o='<='+o;return(t+' '+o).trim()}b.prototype.test=function(e){if(!e)return false;if('string'===typeof e)e=new s(e,this.loose);for(var t=0;t<this.set.length;t++){if(C(this.set[t],e))return true}return false};function C(e,t){for(var n=0;n<e.length;n++){if(!e[n].test(t))return false}if(t.prerelease.length){for(var n=0;n<e.length;n++){N(e[n].semver);if(e[n].semver===Ee)return true;if(0<e[n].semver.prerelease.length){var r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return true}}return false}return true}t.satisfies=x;function x(e,t,n){try{t=new b(t,n)}catch(e){return false}return t.test(e)}t.maxSatisfying=function(e,t,n){return e.filter(function(e){return x(e,t,n)}).sort(function(e,t){return u(e,t,n)})[0]||null};t.validRange=function(e,t){try{return new b(e,t).range||'*'}catch(e){return null}};t.ltr=function(e,t,n){return P(e,t,'<',n)};t.gtr=function(e,t,n){return P(e,t,'>',n)};t.outside=P;function P(e,t,n,r){e=new s(e,r);t=new b(t,r);var a,o,d,u,g;switch(n){case'>':a=p;o=m;d=l;u='>';g='>=';break;case'<':a=l;o=f;d=p;u='<';g='<=';break;default:throw new TypeError('Must provide a hilo val of "<" or ">"');}if(x(e,t,r)){return false}for(var c=0;c<t.set.length;++c){var i=t.set[c],y=null,h=null;i.forEach(function(e){y=y||e;h=h||e;if(a(e.semver,y.semver,r)){y=e}else if(d(e.semver,h.semver,r)){h=e}});if(y.operator===u||y.operator===g){return false}if((!h.operator||h.operator===u)&&o(e,h.semver)){return false}else if(h.operator===g&&d(e,h.semver)){return false}}return true}!(q=t,D='function'===typeof q?q.call(t,n,t,e):q,D!==undefined&&(e.exports=D))},function(e){e.exports={_from:'pg@^7.4.0',_id:'pg@7.4.0',_inBundle:false,_integrity:'sha1-4lYGHSxScjw8hY3vuX8RWcpmD4M=',_location:'/pg',_phantomChildren:{},_requested:{type:'range',registry:true,raw:'pg@^7.4.0',name:'pg',escapedName:'pg',rawSpec:'^7.4.0',saveSpec:null,fetchSpec:'^7.4.0'},_requiredBy:['/'],_resolved:'https://registry.npmjs.org/pg/-/pg-7.4.0.tgz',_shasum:'e256061d2c52723c3c858defb97f1159ca660f83',_spec:'pg@^7.4.0',_where:'/Users/wisdman/Projects/bitjournal',author:{name:'Brian Carlson',email:'brian.m.carlson@gmail.com'},bugs:{url:'https://github.com/brianc/node-postgres/issues'},bundleDependencies:false,dependencies:{"buffer-writer":'1.0.1',"js-string-escape":'1.0.1',"packet-reader":'0.3.1',"pg-connection-string":'0.1.3',"pg-pool":'~2.0.3',"pg-types":'~1.12.1',pgpass:'1.x',semver:'4.3.2'},deprecated:false,description:'PostgreSQL client - pure javascript & libpq with the same API',devDependencies:{async:'0.9.0',co:'4.6.0',eslint:'4.2.0',"eslint-config-standard":'10.2.1',"eslint-plugin-import":'2.7.0',"eslint-plugin-node":'5.1.0',"eslint-plugin-promise":'3.5.0',"eslint-plugin-standard":'3.0.1',"pg-copy-streams":'0.3.0'},engines:{node:'>= 4.5.0'},homepage:'http://github.com/brianc/node-postgres',keywords:['database','libpq','pg','postgre','postgres','postgresql','rdbms'],license:'MIT',main:'./lib',minNativeVersion:'2.0.0',name:'pg',repository:{type:'git',url:'git://github.com/brianc/node-postgres.git'},scripts:{test:'make test-all'},version:'7.4.0'}},function(e,t,n){'use strict';var r=n(5).EventEmitter,i=n(4),s=n(11),a=e.exports=function(e,t,n){r.call(this);e=s.normalizeQueryConfig(e,t,n);this.text=e.text;this.values=e.values;this.name=e.name;this.callback=e.callback;this.state='new';this._arrayMode='array'===e.rowMode;this._emitRowEvents=false;this.on('newListener',function(e){if('row'===e)this._emitRowEvents=true}.bind(this))};i.inherits(a,r);var o={sqlState:'code',statementPosition:'position',messagePrimary:'message',context:'where',schemaName:'schema',tableName:'table',columnName:'column',dataTypeName:'dataType',constraintName:'constraint',sourceFile:'file',sourceLine:'line',sourceFunction:'routine'};a.prototype.handleError=function(e){var t=this.native.pq.resultErrorFields();if(t){for(var n in t){var r=o[n]||n;e[r]=t[n]}}if(this.callback){this.callback(e)}else{this.emit('error',e)}this.state='error'};a.prototype.then=function(e,t){return this._getPromise().then(e,t)};a.prototype.catch=function(e){return this._getPromise().catch(e)};a.prototype._getPromise=function(){if(this._promise)return this._promise;this._promise=new Promise(function(e,t){this._once('end',e);this._once('error',t)}.bind(this));return this._promise};a.prototype.submit=function(e){this.state='running';var t=this;this.native=e.native;e.native.arrayMode=this._arrayMode;var n=function(n,r,s){e.native.arrayMode=false;setImmediate(function(){t.emit('_done')});if(n){return t.handleError(n)}if(t._emitRowEvents){if(1<s.length){r.forEach((e,n)=>{e.forEach((e)=>{t.emit('row',e,s[n])})})}else{r.forEach(function(e){t.emit('row',e,s)})}}t.state='end';t.emit('end',s);if(t.callback){t.callback(null,s)}};if(process.domain){n=process.domain.bind(n)}if(this.name){if(63<this.name.length){console.error('Warning! Postgres only supports 63 characters for query names.');console.error('You supplied',this.name,'(',this.name.length,')');console.error('This can cause conflicts and silent errors executing queries')}var r=(this.values||[]).map(s.prepareValue);if(e.namedQueries[this.name]){return e.native.execute(this.name,r,n)}return e.native.prepare(this.name,this.text,r.length,function(i){if(i)return n(i);e.namedQueries[t.name]=true;return t.native.execute(t.name,r,n)})}else if(this.values){if(!Array.isArray(this.values)){const e=new Error('Query values must be an array');return n(e)}var i=this.values.map(s.prepareValue);e.native.query(this.text,i,n)}else{e.native.query(this.text,n)}}},function(e,t,n){'use strict';var s=Number.parseFloat,a=Math.floor,o=Number.isNaN,d=Math.max,u=n(0);class p{constructor(){}static*[Symbol.iterator](){const e=Object.keys(this);for(let t of e){yield this[t]}}static parseError(e){const t=e&&parseInt(e.code)||NaN;if(!t)return NaN;for(let n of this)if(n===t)return n;return NaN}}p.UNIQUE_VIOLATION=23505;p.UNDEFINED_OBJECT=42704;class l{constructor(e){this.name=e}valueOf(){return{text:this.text,values:this.values}}}class g{constructor(e=null,t=0,n=[]){this.text='';this.values=[];if(null===e){this.values=[];this.text='';return this}if('string'===typeof e){let r=t;this.values=[];this.text=' WHERE '+e.replace(/\$\d+/g,(e)=>{let t=~~/\d+/.exec(e)[0]-1;if(n[t]===undefined)return'DEFAULT';this.values.push(n[t]);return`$${++r}`});return this}throw new TypeError('value is not a null, array, object or string')}}class c{constructor(e=null){if(null===e){this.text='';return this}if(Array.isArray(e)){this.text=' ORDER BY '+e.map((e)=>`"${e}" ASC`).join(', ');return this}if('object'===typeof e){let t=Object.keys(e);if(0===t.length){this.text='';return this}this.text=' ORDER BY '+t.map((t)=>`"${t}" ${e[t]}`).join(', ');return this}if('string'===typeof e){this.text=` ORDER BY "${e}" ASC`;return this}throw new TypeError('value is not a null, array, object or string')}}class f{constructor(e=Infinity){if(o(e))throw new TypeError('limit is not a number');if(0>=e)throw new TypeError('limit is less than or equal to zero');if(e<Infinity)this.text=' LIMIT ${limit}';else this.text=''}}class m{constructor(e=0){if(o(e))throw new TypeError('offset is not a number');if(0>e)throw new TypeError('offset is less than zero');if(e===Infinity)throw new TypeError('offset is Infinity');if(0<e)this.text=' OFFSET ${offset}';else this.text=''}}class y extends l{constructor(e,t=[]){super('SELECT');this._where=new g;this._order=new c;this._limit=new f;this._offset=new m;let n=Array.isArray(t)?t:Object.keys(t);n=n.map((e)=>`"${e}"`);this._command=`SELECT ${n.join(', ')||'*'} FROM "${e.scheme}"."${e.table}"`}where(e,...t){this._where=new g(e,0,t);return this}order(e){this._order=new c(e);return this}limit(e){this._limit=new f(e);return this}offset(e){this._offset=new m(e);return this}get text(){return this._command+this._where.text+this._order.text+this._limit.text+this._offset.text}get values(){return this._where.values}}class b{constructor(e=[]){let t=Array.isArray(e)?e:Object.keys(e);t=t.map((e)=>`"${e}"`);this.text=` RETURNING ${t.join(', ')||'*'}`}}class h extends l{constructor(e,t={}){super('INSERT');this._returning=new b;let n=Object.keys(t);if(0===n.length)throw new TypeError('filtred value is an empty object');this.values=[];let r=[];n.forEach((e)=>{if(t[e]===undefined){r.push('DEFAULT');return}let n=this.values.push(t[e]);r.push(`$${n}`)});n=n.map((e)=>`"${e}"`);this._command=`INSERT INTO "${e.scheme}"."${e.table}" (${n.join(', ')}) VALUES (${r.join(', ')})`}returning(e){this._returning=new b(e);return this}get text(){return this._command+this._returning.text}}class w extends l{constructor(e,t=[]){super('UPDATE');this._returning=new b;this._where=new g;let n=Object.keys(t);if(0===n.length)throw new TypeError('filtred value is an empty object');this._values=[];n=n.map((e)=>{let n=`"${e}" = `;if(t[e]===undefined){return n+'DEFAULT'}let r=this._values.push(t[e]);return n+`$${r}`});this._command=`UPDATE "${e.scheme}"."${e.table}" SET ${n.join(', ')}`}where(e,...t){this._where=new g(e,this._values.length,t);return this}returning(e){this._returning=new b(e);return this}get text(){return this._command+this._where.text+this._returning.text}get values(){return[...this._values,...this._where.values]}}class _ extends l{constructor(e){super('DELETE');this._where=new g;this._returning=new b;this._command=`DELETE FROM "${e.scheme}"."${e.table}"`}where(e,...t){this._where=new g(e,0,t);return this}returning(e){this._returning=new b(e);return this}get text(){return this._command+this._where.text+this._returning.text}get values(){return this._where.values}}class v{constructor(e,t='public'){this.table=e;this.scheme=t}select(e){return new y(this,e)}insert(e){return new h(this,e)}update(e){return new w(this,e)}delete(){return new _(this)}}var E=n(12),S=n.n(E);const I=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];function r(e){const t=Buffer.isBuffer(e)?e:new Buffer(e);let n=0,r=0,i=0,s=0;const o=a(t.length/5),d=0===t.length%5?o:o+1,u=new Buffer(8*d);while(n<t.length){let e=t[n];if(3<i){s=e&255>>i;i=(i+5)%8;s=s<<i|(n+1<t.length?t[n+1]:0)>>8-i;n++}else{s=31&e>>8-(i+5);i=(i+5)%8;if(0===i)n++}u[r]='ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'.charCodeAt(s);r++}for(n=r;n<u.length;n++)u[n]=61;return u}function i(e){const t=Buffer.isBuffer(e)?e:new Buffer(e);let n=0,r=0,i=0,s=0;const a=new Buffer(Math.ceil(5*t.length/8));for(let o=0;o<t.length;o++){if(61===t[o])break;let e=t[o]-48;if(e<I.length){r=I[e];if(3>=n){n=(n+5)%8;if(0===n){i|=r;a[s]=i;s++;i=0}else i|=255&r<<8-n}else{n=(n+5)%8;i|=255&r>>>n;a[s]=i;s++;i=255&r<<8-n}}else throw new Error('Invalid input - it is not base32 encoded string')}return a.slice(0,s)}class O{constructor({digits:t=6,step:n=30,secret:e,length:r=32}={}){this._digits=d(a(t),1);this._step=d(a(n),1);this._secret=e?e:Object(E.randomBytes)(d(a(r),1)).toString('hex')}hotpToken(e){const t=Number(e).toString(16).padStart(16,'0'),n=i(this.base32Secret).toString('hex'),r=Object(E.createHmac)('sha1',new Buffer(n,'hex')).update(new Buffer(t,'hex')).digest(),s=15&r[r.length-1],a=(127&r[s])<<24|(255&r[s+1])<<16|(255&r[s+2])<<8|255&r[s+3];return String(a%Math.pow(10,this._digits)).padStart(this._digits,'0')}hotpCheck(e,t){const n=this.hotpToken(t);if(1>n.length)return false;return s(e)===s(n)}totpToken(e=0){const t=a(Date.now()/this._step/1e3)+e;return this.hotpToken(t)}totpCheck(e,t=0){const n=[];if(0<t){for(let e=-1*t;e<=t;e++)n.push(s(this.totpToken(e)))}else n.push(s(this.totpToken()));return n.includes(s(e))}get base32Secret(){return r(this._secret).toString().replace(/=/g,'')}}var T=n(2),A=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},C=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const x='auth';class R extends u.g{async auth(e){if(e.session.valid)e.set(204);else e.set(403)}async logout(e){if(e.session.valid){const t=e.session.user,n=e.db,r=new v('sessions').delete().where('owner = $1',String(t.id));e.debug(`=== SQL Query [GET /${x}/logout] ===\n%s`,r);const i=await n.query(r.valueOf());e.debug(`=== SQL Result [GET /${x}/logout] ===\n%s`,i.rows)}e.session.user=null;e.session.id='';e.set(204)}async login(e){const t=await e.request.json();if('object'!==typeof t||!t.email||!t.password){e.set(403);return}const n=e.db,r={text:`SELECT
               *
             FROM
               "users"
             WHERE
               "users"."email" = $1
               AND
               "users"."password" = encode(digest($2, 'sha512'), 'hex')
               AND
               enable`,values:[t.email,t.password]};e.debug(`=== SQL Query [POST /${x}/login] ===\n%s`,r);const i=await n.query(r);e.debug(`=== SQL Result [POST /${x}/login] ===\n%s`,i.rows);if(1!==i.rowCount){e.set(403);return}const s=i.rows[0].totp;if(s){if(!t.otp){e.set(403);return}const n=new O({secret:s});if(!n.totpCheck(t.otp,2)){e.set(403);return}}e.session.user=new T.h(i.rows[0]);if(!e.session.user){e.set(403);return}const a={text:`INSERT INTO
               "sessions" ("owner", "ip")
             VALUES
               ($1, $2)
             RETURNING
               "id"`,values:[String(e.session.user.id),e.session.ip]};e.debug(`=== SQL Query [POST /${x}/login] NEW ===\n%s`,a);const o=await n.query(a);e.debug(`=== SQL Result [POST /${x}/login] NEW ===\n%s`,o.rows);e.session.id=o.rows[0]&&o.rows[0].id||'';e.set({token:e.session.id})}}A([Object(u.c)(`/${x}`),C('design:type',Function),C('design:paramtypes',[u.a,Function]),C('design:returntype',Promise)],R.prototype,'auth',null);A([Object(u.c)(`/${x}/logout`),C('design:type',Function),C('design:paramtypes',[u.a,Function]),C('design:returntype',Promise)],R.prototype,'logout',null);A([Object(u.e)(`/${x}/login`),C('design:type',Function),C('design:paramtypes',[u.a,Function]),C('design:returntype',Promise)],R.prototype,'login',null);var P=n(3),q=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},D=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const N='currencies',L='currencies';class k extends u.g{async getAll(e){const t=e.db,n=new v(L).select(T.a.MainFields);e.debug(`=== SQL Query [GET /${N}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${N}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.a(e));e.set(i)}async getAllEnabled(e){const t=e.db,n=new v(L).select(T.a.MainFields).where('enable');e.debug(`=== SQL Query [GET /${N}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${N}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.a(e));e.set(i)}async getOne(e){const t=e.route,n=e.db,r=t.data.symbol.trim();if(!r){e.set(404);return}const i=new v(L).select().where('symbol = $1',r);e.debug(`=== SQL Query [GET /${N}/:symbol] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${N}/:symbol] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.a(s.rows[0]);e.set(a)}async getOneEnabled(e){const t=e.route,n=e.db,r=t.data.symbol.trim();if(!r){e.set(404);return}const i=new v(L).select().where('symbol = $1 AND enable',r);e.debug(`=== SQL Query [GET /${N}/:symbol] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${N}/:symbol] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.a(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db,r=t.data.symbol.trim();if(!r){e.set(404);return}const i={text:`UPDATE "${L}" SET enable = NOT enable WHERE symbol = $1 RETURNING enable`,values:[r]};e.debug(`=== SQL Query [GET /${N}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${N}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async add(e){const t=e.db,n=await e.request.json(),r=new T.a(n),i=new v(L).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${N}] ===\n%s`,i);const s=await t.query(i.valueOf());e.debug(`=== SQL Result [POST /${N}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.a(s.rows[0]);e.set(a)}async update(e){const t=e.route,n=e.db,r=t.data.symbol.trim();if(!r){e.set(404);return}const i=await e.request.json(),s=new T.a(i),a=new v(L).update(s.valueOf()).where('symbol = $1',r).returning();e.debug(`=== SQL Query [POST /${N}/:symbol] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${N}/:symbol] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.a(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db,r=t.data.symbol.trim();if(!r){e.set(404);return}const i=new v(L).delete().where('symbol = $1',r).returning();e.debug(`=== SQL Query [DELETE /${N}/:symbol] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${N}/:symbol] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.a(s.rows[0]);e.set(a)}}q([Object(u.c)(`/${N}`),Object(P.a)([T.i.Administrator,T.i.Su]),D('design:type',Function),D('design:paramtypes',[u.a,Function]),D('design:returntype',Promise)],k.prototype,'getAll',null);q([Object(u.c)(`/${N}`),D('design:type',Function),D('design:paramtypes',[u.a,Function]),D('design:returntype',Promise)],k.prototype,'getAllEnabled',null);q([Object(u.c)(`/${N}/:symbol`),Object(P.a)([T.i.Administrator,T.i.Su]),D('design:type',Function),D('design:paramtypes',[u.a,Function]),D('design:returntype',Promise)],k.prototype,'getOne',null);q([Object(u.c)(`/${N}/:symbol`),D('design:type',Function),D('design:paramtypes',[u.a,Function]),D('design:returntype',Promise)],k.prototype,'getOneEnabled',null);q([Object(u.c)(`/${N}/:symbol/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),D('design:type',Function),D('design:paramtypes',[u.a,Function]),D('design:returntype',Promise)],k.prototype,'toggle',null);q([Object(u.e)(`/${N}`),Object(P.a)([T.i.Administrator,T.i.Su]),D('design:type',Function),D('design:paramtypes',[u.a,Function]),D('design:returntype',Promise)],k.prototype,'add',null);q([Object(u.e)(`/${N}/:symbol`),Object(P.a)([T.i.Administrator,T.i.Su]),D('design:type',Function),D('design:paramtypes',[u.a,Function]),D('design:returntype',Promise)],k.prototype,'update',null);q([Object(u.b)(`/${N}/:symbol`),Object(P.a)([T.i.Administrator,T.i.Su]),D('design:type',Function),D('design:paramtypes',[u.a,Function]),D('design:returntype',Promise)],k.prototype,'delete',null);var M=n(1),j=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},F=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const Q='exchanges',U='exchanges';class $ extends u.g{async getAll(e){const t=e.db,n=new v(U).select(T.b.MainFields);e.debug(`=== SQL Query [GET /${Q}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${Q}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.b(e));e.set(i)}async getAllEnabled(e){const t=e.db,n=new v(U).select(T.b.MainFields).where('enable');e.debug(`=== SQL Query [GET /${Q}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${Q}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.b(e));e.set(i)}async getOne(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(U).select().where('id = $1',String(r));e.debug(`=== SQL Query [GET /${Q}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${Q}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.b(s.rows[0]);e.set(a)}async getOneEnabled(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(U).select().where('id = $1 AND enable',String(r));e.debug(`=== SQL Query [GET /${Q}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${Q}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.b(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i={text:`UPDATE "${U}" SET enable = NOT enable WHERE id = $1 RETURNING enable`,values:[String(r)]};e.debug(`=== SQL Query [GET /${Q}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${Q}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async add(e){const t=e.db,n=await e.request.json(),r=new T.b(n),i=new v(U).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${Q}] ===\n%s`,i);const s=await t.query(i.valueOf());e.debug(`=== SQL Result [POST /${Q}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.b(s.rows[0]);e.set(a)}async update(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=await e.request.json(),s=new T.b(i),a=new v(U).update(s.valueOf()).where('id = $1',String(r)).returning();e.debug(`=== SQL Query [POST /${Q}/:id] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${Q}/:id] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.b(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(U).delete().where('id = $1',String(r)).returning();e.debug(`=== SQL Query [DELETE /${Q}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${Q}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.b(s.rows[0]);e.set(a)}}j([Object(u.c)(`/${Q}`),Object(P.a)([T.i.Administrator,T.i.Su]),F('design:type',Function),F('design:paramtypes',[u.a,Function]),F('design:returntype',Promise)],$.prototype,'getAll',null);j([Object(u.c)(`/${Q}`),F('design:type',Function),F('design:paramtypes',[u.a,Function]),F('design:returntype',Promise)],$.prototype,'getAllEnabled',null);j([Object(u.c)(`/${Q}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),F('design:type',Function),F('design:paramtypes',[u.a,Function]),F('design:returntype',Promise)],$.prototype,'getOne',null);j([Object(u.c)(`/${Q}/:id`),F('design:type',Function),F('design:paramtypes',[u.a,Function]),F('design:returntype',Promise)],$.prototype,'getOneEnabled',null);j([Object(u.c)(`/${Q}/:id/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),F('design:type',Function),F('design:paramtypes',[u.a,Function]),F('design:returntype',Promise)],$.prototype,'toggle',null);j([Object(u.e)(`/${Q}`),Object(P.a)([T.i.Administrator,T.i.Su]),F('design:type',Function),F('design:paramtypes',[u.a,Function]),F('design:returntype',Promise)],$.prototype,'add',null);j([Object(u.e)(`/${Q}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),F('design:type',Function),F('design:paramtypes',[u.a,Function]),F('design:returntype',Promise)],$.prototype,'update',null);j([Object(u.b)(`/${Q}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),F('design:type',Function),F('design:paramtypes',[u.a,Function]),F('design:returntype',Promise)],$.prototype,'delete',null);var G=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},H=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const B='ico',V='ico';class z extends u.g{async getAll(e){const t=e.db,n=new v(V).select(T.c.MainFields);e.debug(`=== SQL Query [GET /${B}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${B}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.c(e));e.set(i)}async getAllEnabled(e){const t=e.db,n=new v(V).select(T.c.MainFields).where('enable');e.debug(`=== SQL Query [GET /${B}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${B}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.c(e));e.set(i)}async getOne(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(V).select().where('id = $1',String(r));e.debug(`=== SQL Query [GET /${B}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${B}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.c(s.rows[0]);e.set(a)}async getOneEnabled(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(V).select().where('id = $1 AND enable',String(r));e.debug(`=== SQL Query [GET /${B}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${B}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.c(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i={text:`UPDATE "${V}" SET enable = NOT enable WHERE id = $1 RETURNING enable`,values:[String(r)]};e.debug(`=== SQL Query [GET /${B}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${B}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async add(e){const t=e.db,n=await e.request.json(),r=new T.c(n),i=new v(V).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${B}] ===\n%s`,i);const s=await t.query(i.valueOf());e.debug(`=== SQL Result [POST /${B}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.c(s.rows[0]);e.set(a)}async update(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=await e.request.json(),s=new T.c(i),a=new v(V).update(s.valueOf()).where('id = $1',String(r)).returning();e.debug(`=== SQL Query [POST /${B}/:id] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${B}/:id] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.c(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(V).delete().where('id = $1',String(r)).returning();e.debug(`=== SQL Query [DELETE /${B}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${B}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.c(s.rows[0]);e.set(a)}}G([Object(u.c)(`/${B}`),Object(P.a)([T.i.Administrator,T.i.Su]),H('design:type',Function),H('design:paramtypes',[u.a,Function]),H('design:returntype',Promise)],z.prototype,'getAll',null);G([Object(u.c)(`/${B}`),H('design:type',Function),H('design:paramtypes',[u.a,Function]),H('design:returntype',Promise)],z.prototype,'getAllEnabled',null);G([Object(u.c)(`/${B}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),H('design:type',Function),H('design:paramtypes',[u.a,Function]),H('design:returntype',Promise)],z.prototype,'getOne',null);G([Object(u.c)(`/${B}/:id`),H('design:type',Function),H('design:paramtypes',[u.a,Function]),H('design:returntype',Promise)],z.prototype,'getOneEnabled',null);G([Object(u.c)(`/${B}/:id/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),H('design:type',Function),H('design:paramtypes',[u.a,Function]),H('design:returntype',Promise)],z.prototype,'toggle',null);G([Object(u.e)(`/${B}`),Object(P.a)([T.i.Administrator,T.i.Su]),H('design:type',Function),H('design:paramtypes',[u.a,Function]),H('design:returntype',Promise)],z.prototype,'add',null);G([Object(u.e)(`/${B}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),H('design:type',Function),H('design:paramtypes',[u.a,Function]),H('design:returntype',Promise)],z.prototype,'update',null);G([Object(u.b)(`/${B}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),H('design:type',Function),H('design:paramtypes',[u.a,Function]),H('design:returntype',Promise)],z.prototype,'delete',null);var X=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},W=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const K='markets',Y='markets';class Z extends u.g{async getAll(e){const t=e.db,n=new v(Y).select(T.d.MainFields);e.debug(`=== SQL Query [GET /${K}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${K}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.d(e));e.set(i)}async getAllEnabled(e){const t=e.db,n=new v(Y).select(T.d.MainFields).where('enable');e.debug(`=== SQL Query [GET /${K}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${K}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.d(e));e.set(i)}async getOne(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(Y).select().where('id = $1',String(r));e.debug(`=== SQL Query [GET /${K}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${K}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.d(s.rows[0]);e.set(a)}async getOneEnabled(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(Y).select().where('id = $1 AND enable',String(r));e.debug(`=== SQL Query [GET /${K}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${K}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.d(s.rows[0]);e.set(a)}async add(e){const t=e.db,n=await e.request.json(),r=new T.d(n),i=new v(Y).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${K}] ===\n%s`,i);const s=await t.query(i.valueOf());e.debug(`=== SQL Result [POST /${K}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.d(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i={text:`UPDATE "${Y}" SET enable = NOT enable WHERE id = $1 RETURNING enable`,values:[String(r)]};e.debug(`=== SQL Query [GET /${K}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${K}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async update(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=await e.request.json(),s=new T.d(i),a=new v(Y).update(s.valueOf()).where('id = $1',String(r)).returning();e.debug(`=== SQL Query [POST /${K}/:id] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${K}/:id] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.d(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(Y).delete().where('id = $1',String(r)).returning();e.debug(`=== SQL Query [DELETE /${K}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${K}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.d(s.rows[0]);e.set(a)}}X([Object(u.c)(`/${K}`),Object(P.a)([T.i.Administrator,T.i.Su]),W('design:type',Function),W('design:paramtypes',[u.a,Function]),W('design:returntype',Promise)],Z.prototype,'getAll',null);X([Object(u.c)(`/${K}`),W('design:type',Function),W('design:paramtypes',[u.a,Function]),W('design:returntype',Promise)],Z.prototype,'getAllEnabled',null);X([Object(u.c)(`/${K}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),W('design:type',Function),W('design:paramtypes',[u.a,Function]),W('design:returntype',Promise)],Z.prototype,'getOne',null);X([Object(u.c)(`/${K}/:id`),W('design:type',Function),W('design:paramtypes',[u.a,Function]),W('design:returntype',Promise)],Z.prototype,'getOneEnabled',null);X([Object(u.e)(`/${K}`),Object(P.a)([T.i.Administrator,T.i.Su]),W('design:type',Function),W('design:paramtypes',[u.a,Function]),W('design:returntype',Promise)],Z.prototype,'add',null);X([Object(u.c)(`/${K}/:id/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),W('design:type',Function),W('design:paramtypes',[u.a,Function]),W('design:returntype',Promise)],Z.prototype,'toggle',null);X([Object(u.e)(`/${K}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),W('design:type',Function),W('design:paramtypes',[u.a,Function]),W('design:returntype',Promise)],Z.prototype,'update',null);X([Object(u.b)(`/${K}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),W('design:type',Function),W('design:paramtypes',[u.a,Function]),W('design:returntype',Promise)],Z.prototype,'delete',null);var J=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},ee=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const te='publications',ne='publications';class re extends u.g{async getAll(e){const t=e.db,n=new v(ne).select(T.e.MainFields);e.debug(`=== SQL Query [GET /${te}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${te}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.e(e));e.set(i)}async getAllEnabled(e){const t=e.db,n=new v(ne).select(T.e.MainFields).where('enable AND ts <= timezone(\'UTC\', now())');e.debug(`=== SQL Query [GET /${te}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${te}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.e(e));e.set(i)}async getOne(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(ne).select().where('id = $1',String(r));e.debug(`=== SQL Query [GET /${te}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${te}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.e(s.rows[0]);e.set(a)}async getOneEnabled(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(ne).select().where('id = $1 AND enable',String(r));e.debug(`=== SQL Query [GET /${te}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${te}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.e(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i={text:`UPDATE "${ne}" SET enable = NOT enable WHERE id = $1 RETURNING enable`,values:[String(r)]};e.debug(`=== SQL Query [GET /${te}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${te}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async add(e){const t=e.db,n=await e.request.json(),r=new T.e(n),i=new v(ne).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${te}] ===\n%s`,i);const s=await t.query(i.valueOf());e.debug(`=== SQL Result [POST /${te}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.e(s.rows[0]);e.set(a)}async update(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=await e.request.json(),s=new T.e(i),a=new v(ne).update(s.valueOf()).where('id = $1',String(r)).returning();e.debug(`=== SQL Query [POST /${te}/:id] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${te}/:id] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.e(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(ne).delete().where('id = $1',String(r)).returning();e.debug(`=== SQL Query [DELETE /${te}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${te}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.e(s.rows[0]);e.set(a)}}J([Object(u.c)(`/${te}`),Object(P.a)([T.i.Administrator,T.i.Su]),ee('design:type',Function),ee('design:paramtypes',[u.a,Function]),ee('design:returntype',Promise)],re.prototype,'getAll',null);J([Object(u.c)(`/${te}`),ee('design:type',Function),ee('design:paramtypes',[u.a,Function]),ee('design:returntype',Promise)],re.prototype,'getAllEnabled',null);J([Object(u.c)(`/${te}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ee('design:type',Function),ee('design:paramtypes',[u.a,Function]),ee('design:returntype',Promise)],re.prototype,'getOne',null);J([Object(u.c)(`/${te}/:id`),ee('design:type',Function),ee('design:paramtypes',[u.a,Function]),ee('design:returntype',Promise)],re.prototype,'getOneEnabled',null);J([Object(u.c)(`/${te}/:id/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),ee('design:type',Function),ee('design:paramtypes',[u.a,Function]),ee('design:returntype',Promise)],re.prototype,'toggle',null);J([Object(u.e)(`/${te}`),Object(P.a)([T.i.Administrator,T.i.Su]),ee('design:type',Function),ee('design:paramtypes',[u.a,Function]),ee('design:returntype',Promise)],re.prototype,'add',null);J([Object(u.e)(`/${te}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ee('design:type',Function),ee('design:paramtypes',[u.a,Function]),ee('design:returntype',Promise)],re.prototype,'update',null);J([Object(u.b)(`/${te}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ee('design:type',Function),ee('design:paramtypes',[u.a,Function]),ee('design:returntype',Promise)],re.prototype,'delete',null);var ie=n(55),se=n.n(ie),ae=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},oe=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const de='raw';class ue extends u.g{async getOne(e){const t=e.route,n=e.db,r=t.data.id;if(!/^[0-9]+&/.test(r)){e.set(404);return}const i=parseInt(r);if(!i){e.set(404);return}e.debug(`=== GET /${de}/:id] LO [%s] ===`,i);const s=new ie.LargeObjectManager({pg:n});await n.query('BEGIN');let a;try{const e=await s.openAsync(i,ie.LargeObjectManager.READ),t=await e.sizeAsync();a=await e.readAsync(t);await e.closeAsync()}catch(t){await n.query('ROLLBACK');if(p.parseError(t)===p.UNDEFINED_OBJECT){e.set(404);return}e.throw(t);return}await n.query('COMMIT');e.set(a)}async add(e){const t=e.db,n=await e.request.raw();e.debug(`=== PUT [/${de}] LO ===`);const r=new ie.LargeObjectManager({pg:t});await t.query('BEGIN');let i;try{i=await r.createAsync();const e=await r.openAsync(i,ie.LargeObjectManager.WRITE);await e.writeAsync(n);await e.closeAsync()}catch(n){await t.query('ROLLBACK');e.throw(n);return}await t.query('COMMIT');if(!i){e.throw(new Error('LO empty oid error'));return}e.set({oid:i})}async delete(e){const t=e.route,n=e.db,r=t.data.id;if(!/^[0-9]+&/.test(r)){e.set(404);return}const i=parseInt(r);if(!i){e.set(404);return}e.debug(`=== DELETE /${de}/:id] LO [%s] ===`,i);const s=new ie.LargeObjectManager({pg:n});await n.query('BEGIN');try{await s.unlinkAsync(i)}catch(t){await n.query('ROLLBACK');if(p.parseError(t)===p.UNDEFINED_OBJECT){e.set(404);return}e.throw(t);return}await n.query('COMMIT');e.set({oid:i})}}ae([Object(u.c)(`/${de}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),oe('design:type',Function),oe('design:paramtypes',[u.a,Function]),oe('design:returntype',Promise)],ue.prototype,'getOne',null);ae([Object(u.f)(`/${de}`),Object(P.a)([T.i.Administrator,T.i.Su]),oe('design:type',Function),oe('design:paramtypes',[u.a,Function]),oe('design:returntype',Promise)],ue.prototype,'add',null);ae([Object(u.b)(`/${de}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),oe('design:type',Function),oe('design:paramtypes',[u.a,Function]),oe('design:returntype',Promise)],ue.prototype,'delete',null);var pe=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},le=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const ge='sections',ce='sections';class fe extends u.g{async getAll(e){const t=e.db,n=new v(ce).select(T.f.MainFields);e.debug(`=== SQL Query [GET /${ge}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${ge}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.f(e));e.set(i)}async getAllEnabled(e){const t=e.db,n=new v(ce).select(T.f.MainFields).where('enable');e.debug(`=== SQL Query [GET /${ge}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${ge}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.f(e));e.set(i)}async getOne(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(ce).select().where('id = $1',String(r));e.debug(`=== SQL Query [GET /${ge}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${ge}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.f(s.rows[0]);e.set(a)}async getOneEnabled(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(ce).select().where('id = $1 AND enable',String(r));e.debug(`=== SQL Query [GET /${ge}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${ge}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.f(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i={text:`UPDATE "${ce}" SET enable = NOT enable WHERE id = $1 RETURNING enable`,values:[String(r)]};e.debug(`=== SQL Query [GET /${ge}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${ge}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async add(e){const t=e.db,n=await e.request.json(),r=new T.f(n),i=new v(ce).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${ge}] ===\n%s`,i);const s=await t.query(i.valueOf());e.debug(`=== SQL Result [POST /${ge}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.f(s.rows[0]);e.set(a)}async update(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=await e.request.json(),s=new T.f(i),a=new v(ce).update(s.valueOf()).where('id = $1',String(r)).returning();e.debug(`=== SQL Query [POST /${ge}/:id] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${ge}/:id] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.f(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(ce).delete().where('id = $1',String(r)).returning();e.debug(`=== SQL Query [DELETE /${ge}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${ge}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.f(s.rows[0]);e.set(a)}}pe([Object(u.c)(`/${ge}`),Object(P.a)([T.i.Administrator,T.i.Su]),le('design:type',Function),le('design:paramtypes',[u.a,Function]),le('design:returntype',Promise)],fe.prototype,'getAll',null);pe([Object(u.c)(`/${ge}`),le('design:type',Function),le('design:paramtypes',[u.a,Function]),le('design:returntype',Promise)],fe.prototype,'getAllEnabled',null);pe([Object(u.c)(`/${ge}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),le('design:type',Function),le('design:paramtypes',[u.a,Function]),le('design:returntype',Promise)],fe.prototype,'getOne',null);pe([Object(u.c)(`/${ge}/:id`),le('design:type',Function),le('design:paramtypes',[u.a,Function]),le('design:returntype',Promise)],fe.prototype,'getOneEnabled',null);pe([Object(u.c)(`/${ge}/:id/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),le('design:type',Function),le('design:paramtypes',[u.a,Function]),le('design:returntype',Promise)],fe.prototype,'toggle',null);pe([Object(u.e)(`/${ge}`),Object(P.a)([T.i.Administrator,T.i.Su]),le('design:type',Function),le('design:paramtypes',[u.a,Function]),le('design:returntype',Promise)],fe.prototype,'add',null);pe([Object(u.e)(`/${ge}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),le('design:type',Function),le('design:paramtypes',[u.a,Function]),le('design:returntype',Promise)],fe.prototype,'update',null);pe([Object(u.b)(`/${ge}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),le('design:type',Function),le('design:paramtypes',[u.a,Function]),le('design:returntype',Promise)],fe.prototype,'delete',null);var me=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},ye=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const be='statuses',he='statuses';class we extends u.g{async getAll(e){const t=e.db,n=new v(he).select(T.g.MainFields).order('title');e.debug(`=== SQL Query [GET /${be}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${be}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.g(e));e.set(i)}async getAllEnabled(e){const t=e.db,n=new v(he).select(T.g.MainFields).where('enable').order('title');e.debug(`=== SQL Query [GET /${be}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${be}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.g(e));e.set(i)}async getOne(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(he).select().where('id = $1',String(r));e.debug(`=== SQL Query [GET /${be}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${be}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.g(s.rows[0]);e.set(a)}async getOneEnabled(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(he).select().where('id = $1 AND enable',String(r));e.debug(`=== SQL Query [GET /${be}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${be}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.g(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i={text:`UPDATE "${he}" SET enable = NOT enable WHERE id = $1 RETURNING enable`,values:[String(r)]};e.debug(`=== SQL Query [GET /${be}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${be}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async add(e){const t=e.db,n=await e.request.json(),r=new T.g(n),i=new v(he).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${be}] ===\n%s`,i);const s=await t.query(i.valueOf());e.debug(`=== SQL Result [POST /${be}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.g(s.rows[0]);e.set(a)}async update(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=await e.request.json(),s=new T.g(i),a=new v(he).update(s.valueOf()).where('id = $1',String(r)).returning();e.debug(`=== SQL Query [POST /${be}/:id] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${be}/:id] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.g(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(he).delete().where('id = $1',String(r)).returning();e.debug(`=== SQL Query [DELETE /${be}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${be}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.g(s.rows[0]);e.set(a)}}me([Object(u.c)(`/${be}`),Object(P.a)([T.i.Administrator,T.i.Su]),ye('design:type',Function),ye('design:paramtypes',[u.a,Function]),ye('design:returntype',Promise)],we.prototype,'getAll',null);me([Object(u.c)(`/${be}`),ye('design:type',Function),ye('design:paramtypes',[u.a,Function]),ye('design:returntype',Promise)],we.prototype,'getAllEnabled',null);me([Object(u.c)(`/${be}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ye('design:type',Function),ye('design:paramtypes',[u.a,Function]),ye('design:returntype',Promise)],we.prototype,'getOne',null);me([Object(u.c)(`/${be}/:id`),ye('design:type',Function),ye('design:paramtypes',[u.a,Function]),ye('design:returntype',Promise)],we.prototype,'getOneEnabled',null);me([Object(u.c)(`/${be}/:id/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),ye('design:type',Function),ye('design:paramtypes',[u.a,Function]),ye('design:returntype',Promise)],we.prototype,'toggle',null);me([Object(u.e)(`/${be}`),Object(P.a)([T.i.Administrator,T.i.Su]),ye('design:type',Function),ye('design:paramtypes',[u.a,Function]),ye('design:returntype',Promise)],we.prototype,'add',null);me([Object(u.e)(`/${be}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ye('design:type',Function),ye('design:paramtypes',[u.a,Function]),ye('design:returntype',Promise)],we.prototype,'update',null);me([Object(u.b)(`/${be}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ye('design:type',Function),ye('design:paramtypes',[u.a,Function]),ye('design:returntype',Promise)],we.prototype,'delete',null);var _e=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},ve=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ee='users',Se='users';class Ie extends u.g{async getAll(e){const t=e.db,n=new v(Se).select(T.h.MainFields);e.debug(`=== SQL Query [GET /${Ee}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${Ee}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.h(e));e.set(i)}async getMe(e){if(!e.session.valid){e.set(403);return}const t=e.db,n=e.session.user,r=new v(Se).select().where('id = $1 AND enable',String(n.id));e.debug(`=== SQL Query [GET /${Ee}/me] ===\n%s`,r);const i=await t.query(r.valueOf());e.debug(`=== SQL Result [GET /${Ee}/me] ===\n%s`,i.rows);if(1!==i.rowCount){e.set(403);return}const s=new T.h(i.rows[0]);e.set(s)}async getOne(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(Se).select().where('id = $1',String(r));e.debug(`=== SQL Query [GET /${Ee}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${Ee}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.h(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i={text:`UPDATE "${Se}" SET enable = NOT enable WHERE id = $1 RETURNING enable`,values:[String(r)]};e.debug(`=== SQL Query [GET /${Ee}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${Ee}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async resetOTP(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i={text:`UPDATE
               ${Se}
             SET
               totp = encode(digest(uuid_generate_v4()::text, 'sha256'), 'hex')
             WHERE
               id = $1
             RETURNING
               totp`,values:[String(r)]};e.debug(`=== SQL Query [POST /${Ee}/:id/otp] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [POST /${Ee}/:id/otp] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].totp;if(!a){e.set(204);return}const o=new O({secret:a});e.set({secret:o.base32Secret})}async password(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=await e.request.json(),s=i.password;if(!s){e.set(400,'Password is empty');return}const a={text:`UPDATE ${Se} SET password = encode(digest($1, 'sha512'), 'hex') WHERE id = $2 RETURNING id`,values:[s,String(r)]};e.debug(`=== SQL Query [POST /${Ee}/:id/password] ===\n%s`,a);const o=await n.query(a);e.debug(`=== SQL Result [POST /${Ee}/:id/password] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}e.set(204)}async add(e){const t=e.db,n=await e.request.json(),r=new T.h(n),i=new v(Se).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${Ee}] ===\n%s`,i);const s=await t.query(i.valueOf());e.debug(`=== SQL Result [POST /${Ee}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.h(s.rows[0]);e.set(a)}async update(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=await e.request.json(),s=new T.h(i),a=new v(Se).update(s.valueOf()).where('id = $1',String(r)).returning();e.debug(`=== SQL Query [POST /${Ee}/:id] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${Ee}/:id] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.h(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(Se).delete().where('id = $1',String(r)).returning();e.debug(`=== SQL Query [DELETE /${Ee}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${Ee}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.h(s.rows[0]);e.set(a)}async getOTP(e){const t=e.route,n=e.db;let r;try{r=new M.a(t.data.id)}catch(t){e.set(400,t.message);return}const i=new v(Se).select(['totp']).where('id = $1',String(r));e.debug(`=== SQL Query [GET /${Ee}/:id/otp] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${Ee}/:id/otp] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}let a=s.rows[0].totp;if(!a){e.set(204);return}const o=new O({secret:a});e.set({secret:o.base32Secret})}}_e([Object(u.c)(`/${Ee}`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'getAll',null);_e([Object(u.c)(`/${Ee}/me`),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'getMe',null);_e([Object(u.c)(`/${Ee}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'getOne',null);_e([Object(u.c)(`/${Ee}/:id/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'toggle',null);_e([Object(u.e)(`/${Ee}/:id/otp`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'resetOTP',null);_e([Object(u.e)(`/${Ee}/:id/password`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'password',null);_e([Object(u.e)(`/${Ee}`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'add',null);_e([Object(u.e)(`/${Ee}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'update',null);_e([Object(u.b)(`/${Ee}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'delete',null);_e([Object(u.c)(`/${Ee}/:id/otp`),Object(P.a)([T.i.Administrator,T.i.Su]),ve('design:type',Function),ve('design:paramtypes',[u.a,Function]),ve('design:returntype',Promise)],Ie.prototype,'getOTP',null);var Oe=this&&this.__decorate||function(e,t,n,s){var a=arguments.length,o=3>a?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var d=e.length-1;0<=d;d--)if(r=e[d])o=(3>a?r(o):3<a?r(t,n,o):r(t,n))||o;return 3<a&&o&&Object.defineProperty(t,n,o),o},Te=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};const Ae='video',Ce='video';class xe extends u.g{async getAll(e){const t=e.db,n=new v(Ce).select(T.j.MainFields);e.debug(`=== SQL Query [GET /${Ae}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${Ae}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.j(e));e.set(i)}async getAllEnabled(e){const t=e.db,n=new v(Ce).select(T.j.MainFields).where('enable');e.debug(`=== SQL Query [GET /${Ae}] ===\n%s`,n);const r=await t.query(n.valueOf());e.debug(`=== SQL Result [GET /${Ae}] ===\n%s`,r.rows);const i=r.rows.map((e)=>new T.j(e));e.set(i)}async getOne(e){const t=e.route,n=e.db,r=String(t.data.id),i=new v(Ce).select().where('id = $1',String(r));e.debug(`=== SQL Query [GET /${Ae}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${Ae}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.j(s.rows[0]);e.set(a)}async getOneEnabled(e){const t=e.route,n=e.db,r=String(t.data.id),i=new v(Ce).select().where('id = $1 AND enable',String(r));e.debug(`=== SQL Query [GET /${Ae}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [GET /${Ae}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.j(s.rows[0]);e.set(a)}async toggle(e){const t=e.route,n=e.db,r=t.data.id.trim(),i={text:`UPDATE "${Ce}" SET enable = NOT enable WHERE id = $1 RETURNING enable`,values:[r]};e.debug(`=== SQL Query [GET /${Ae}/:id/toggle] ===\n%s`,i);const s=await n.query(i);e.debug(`=== SQL Result [GET /${Ae}/:id/toggle] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=s.rows[0].enable;e.set({enable:a})}async add(e){const t=e.db,n=await e.request.json(),r=new T.j(n),i=new v(Ce).insert(r.valueOf()).returning();e.debug(`=== SQL Query [POST /${Ae}] ===\n%s`,i);let s;try{s=await t.query(i.valueOf())}catch(t){if(p.parseError(t)===p.UNIQUE_VIOLATION){e.set(409);return}e.throw(t);return}e.debug(`=== SQL Result [POST /${Ae}] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.j(s.rows[0]);e.set(a)}async update(e){const t=e.route,n=e.db,r=String(t.data.id),i=await e.request.json(),s=new T.j(i),a=new v(Ce).update(s.valueOf()).where('id = $1',String(r)).returning();e.debug(`=== SQL Query [POST /${Ae}/:id] ===\n%s`,a);const o=await n.query(a.valueOf());e.debug(`=== SQL Result [POST /${Ae}/:id] ===\n%s`,o.rows);if(1!==o.rowCount){e.set(404);return}const d=new T.j(o.rows[0]);e.set(d)}async delete(e){const t=e.route,n=e.db,r=String(t.data.id),i=new v(Ce).delete().where('id = $1',String(r)).returning();e.debug(`=== SQL Query [DELETE /${Ae}/:id] ===\n%s`,i);const s=await n.query(i.valueOf());e.debug(`=== SQL Result [DELETE /${Ae}/:id] ===\n%s`,s.rows);if(1!==s.rowCount){e.set(404);return}const a=new T.j(s.rows[0]);e.set(a)}}Oe([Object(u.c)(`/${Ae}`),Object(P.a)([T.i.Administrator,T.i.Su]),Te('design:type',Function),Te('design:paramtypes',[u.a,Function]),Te('design:returntype',Promise)],xe.prototype,'getAll',null);Oe([Object(u.c)(`/${Ae}`),Te('design:type',Function),Te('design:paramtypes',[u.a,Function]),Te('design:returntype',Promise)],xe.prototype,'getAllEnabled',null);Oe([Object(u.c)(`/${Ae}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),Te('design:type',Function),Te('design:paramtypes',[u.a,Function]),Te('design:returntype',Promise)],xe.prototype,'getOne',null);Oe([Object(u.c)(`/${Ae}/:id`),Te('design:type',Function),Te('design:paramtypes',[u.a,Function]),Te('design:returntype',Promise)],xe.prototype,'getOneEnabled',null);Oe([Object(u.c)(`/${Ae}/:id/toggle`),Object(P.a)([T.i.Administrator,T.i.Su]),Te('design:type',Function),Te('design:paramtypes',[u.a,Function]),Te('design:returntype',Promise)],xe.prototype,'toggle',null);Oe([Object(u.e)(`/${Ae}`),Object(P.a)([T.i.Administrator,T.i.Su]),Te('design:type',Function),Te('design:paramtypes',[u.a,Function]),Te('design:returntype',Promise)],xe.prototype,'add',null);Oe([Object(u.e)(`/${Ae}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),Te('design:type',Function),Te('design:paramtypes',[u.a,Function]),Te('design:returntype',Promise)],xe.prototype,'update',null);Oe([Object(u.b)(`/${Ae}/:id`),Object(P.a)([T.i.Administrator,T.i.Su]),Te('design:type',Function),Te('design:paramtypes',[u.a,Function]),Te('design:returntype',Promise)],xe.prototype,'delete',null);n.d(t,'a',function(){return R});n.d(t,'b',function(){return k});n.d(t,'c',function(){return $});n.d(t,'d',function(){return z});n.d(t,'e',function(){return Z});n.d(t,'f',function(){return re});n.d(t,'k',function(){return ue});n.d(t,'g',function(){return fe});n.d(t,'h',function(){return we});n.d(t,'i',function(){return Ie});n.d(t,'j',function(){return xe})},function(e,t,n){'use strict';t.LargeObjectManager=n(56);t.LargeObject=n(23);t.ReadStream=n(24);t.WriteStream=n(25)},function(e,t,n){'use strict';var s=n(22),a=n(23);function r(e){return function(t,n){e.query(t).then(function(e){n(null,{rows:e})}).catch(function(e){n(e)})}}function i(e){if('function'===typeof e.query){var t=e;this._query=t.query.bind(t)}else if(e.pg){var t=e.pg;this._query=t.query.bind(t)}else if(e.pgPromise){var n=e.pgPromise;this._query=r(n)}else{throw Error('Either the `pg` or `pgPromise` option must be given')}}i.WRITE=131072;i.READ=262144;i.READWRITE=393216;i.prototype.open=function(e,t,n){if(!e){throw Error('Illegal Argument')}this._query({name:'npg_lo_open',text:'SELECT lo_open($1, $2) AS fd',values:[e,t]},function(t,r){if(t)return n(t);var i=r.rows[0].fd;n(null,new a(this._query,e,i))}.bind(this))};i.prototype.openAsync=function(e,t){return s(function(n){this.open(e,t,n)},this)};i.prototype.create=function(e){this._query({name:'npg_lo_creat',text:'SELECT lo_creat($1) AS oid',values:[i.READWRITE]},function(t,n){if(t)return e(t);var r=n.rows[0].oid;e(null,r)})};i.prototype.createAsync=function(){return s(function(e){this.create(e)},this)};i.prototype.unlink=function(e,t){if(!e){throw Error('Illegal Argument')}this._query({name:'npg_lo_unlink',text:'SELECT lo_unlink($1) as ok',values:[e]},t?function(e){t(e)}:undefined)};i.prototype.unlinkAsync=function(e){return s(function(t){this.unlink(e,t)},this)};i.prototype.openAndReadableStream=function(e,t,n){if('function'===typeof t){n=t;t=undefined}this.open(e,i.READ,function(e,r){if(e)return n(e);r.size(function(e,i){if(e)return n(e);var s=r.getReadableStream(t);s.on('end',function(){r.close(function(e){if(e){console.error('Warning: closing a large object failed:',e)}})});n(null,i,s)})})};i.prototype.openAndReadableStreamAsync=function(e,t){return s(function(n){this.openAndReadableStream(e,t,n)},this,{twoArgs:true})};i.prototype.createAndWritableStream=function(e,t){if('function'===typeof e){t=e;e=undefined}var n=this;n.create(function(r,s){if(r)return t(r);n.open(s,i.WRITE,function(n,r){if(n)return t(n);var i=r.getWritableStream(e);i.on('finish',function(){r.close(function(e){if(e){console.error('Warning: closing a large object failed:',e)}})});t(null,s,i)})})};i.prototype.createAndWritableStreamAsync=function(e){return s(function(t){this.createAndWritableStream(e,t)},this,{twoArgs:true})};e.exports=i},function(e,t,n){e.exports=n(58)},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:true});var r=n(0),i=n(3),s=n(54);process.env.TZ='UTC';new r.h(new i.b(),new i.c(),new s.a(),new s.b(),new s.c(),new s.d(),new s.e(),new s.f(),new s.g(),new s.h(),new s.i(),new s.j())}]);