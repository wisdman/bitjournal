#!/usr/bin/env node
(function(e){var r={};function t(n){if(r[n]){return r[n].exports}var o=r[n]={i:n,l:false,exports:{}};e[n].call(o.exports,o,o.exports,t);o.l=true;return o.exports}t.m=e;t.c=r;t.d=function(e,r,n){if(!t.o(e,r)){Object.defineProperty(e,r,{configurable:false,enumerable:true,get:n})}};t.n=function(e){var r=e&&e.__esModule?function(){return e['default']}:function(){return e};t.d(r,'a',r);return r};t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.p='';return t(t.s=89)})([function(e){e.exports=require('util')},function(e,t,r){'use strict';var p=Math.max,l=r(7),d=r(8),c=r.n(d);class u extends Error{constructor(e,t,r){if(t instanceof Error){r=t;t=r.message}if(r===undefined){r=new Error(t||'Unknown internal server error')}if(!t||500<=e){t=d.STATUS_CODES[e]||'Undefined error'}super(t);this.status=e;this.origin=r}}var m=r(14),y=r.n(m),f=r(26),_=r.n(f);class h{constructor(e,t){this.req=e;this._ctx=t}getHeader(e){let t=this.req.headers[e.toLowerCase()];return Array.isArray(t)?t.join(';'):t}get socket(){return this.req.socket}get ip(){return this.getHeader('X-Real-IP')||this.getHeader('X-Forwarded-For')||this.req.connection.remoteAddress||''}get host(){let e=this.getHeader('X-Forwarded-Host')||this.getHeader('Host');return e&&e.split(/\s*,\s*/)[0]||''}get hostname(){if(!this.host)return'';if('['===this.host[0]){let e=/^\[[a-f0-9:]+\]/.exec(this.host);return e&&e[0]||''}return this.host.split(':')[0]||''}get port(){let e=/\:([0-9]+)$/.exec(this.host);return e&&~~e[1]||80}get method(){return(this.req.method||'').toUpperCase()}get path(){return this.req.url||''}get pathname(){return(this.req.url||'').split('?')[0].split(/\/+/).filter((e)=>!!e)}get query(){let e=(this.req.url||'').split('?').slice(1).join('?');return Object(f.parse)(e)}get type(){let e=this.getHeader('Content-Type');if('string'!==typeof e)return;return e.split(';')[0].trim()}get length(){return~~(this.getHeader('content-length')||'')}async raw(){const e=this.length;return new Promise((t,r)=>{let n=Buffer.alloc(0);const o=()=>{l();r(new u(400,'Request aborted'))},s=()=>{l();r(new u(400,'Receive data error'))},a=(e)=>{n=Buffer.concat([n,e])},i=()=>{l();if(0<e&&n.length!==e){r(new u(400,'Request size did not match content length'))}t(n)},p=()=>{l()};var l=()=>{this.req.removeListener('aborted',o);this.req.removeListener('end',s);this.req.removeListener('data',a);this.req.removeListener('error',i);this.req.removeListener('close',p);this.req.unpipe()};this.req.on('aborted',o);this.req.on('error',s);this.req.on('data',a);this.req.on('end',i);this.req.on('close',p)})}async text(){let e=await this.raw();try{let t=new m.StringDecoder('utf8');return t.end(e)}catch(e){throw new u(400,'Receive data is not a UTF8 string',e)}}async json(){if('application/json'!==this.type){throw new u(400,'Only application/json data are allowed')}let e=await this.text();try{return JSON.parse(e)}catch(e){throw new u(400,'Invalid json received')}}valueOf(){return{heders:this.req.headers,ip:this.ip,host:this.host,hostname:this.hostname,port:this.port,method:this.method,path:this.path,pathname:this.pathname,query:this.query,type:this.type,length:this.length}}toJSON(){return this.valueOf()}}var g=r(9),b=r.n(g),E=[{mime:'image/jpeg',extension:'jpg',offset:0,header:new Uint8Array([255,216,255])},{mime:'image/png',extension:'png',offset:0,header:new Uint8Array([137,80,78,71,13,10,26,10])},{mime:'image/gif',extension:'gif',offset:0,header:new Uint8Array([71,73,70])},{mime:'image/webp',extension:'webp',offset:8,header:new Uint8Array([87,69,66,80])}];const T=/<!--([\s\S]*?)-->/g,I=/^\s*(?:<\?xml[^>]*>\s*)?(?:<!doctype svg[^>]*\s*(?:<![^>]*>)*[^>]*>\s*)?<svg[^>]*>[^]*<\/svg>\s*$/i,S=(e)=>{for(let t=0;24>t;t++)if(65533===e[t]||8>=e[t])return true;return false};var O=(e)=>!S(e)&&I.test(e.toString().replace(T,''));class R{constructor(e){const t=e instanceof Uint8Array?e:new Uint8Array(e);if(1>=t.length)return this;for(let r of E)if(this.check(t,r.header,r.offset)){this.mime=r.mime;this.extension=r.extension;return this}if(O(t)){this.mime='image/svg+xml';this.extension='svg';return this}this.mime='application/octet-stream';this.extension=''}check(e,t,r=0){for(let n=0;n<t.length;n++)if(t[n]!==e[n+r])return false;return true}toJSON(){return{extension:this.extension,mime:this.mime}}toString(){return this.mime}[Symbol.toPrimitive](e){switch(e){case'number':throw new TypeError('Cannot convert a FileType value to a number value');case'string':case'default':return this.mime;default:throw new TypeError('Cannot convert a FileType value to unknown value');}}[Symbol.toStringTag](){return'FileType'}}class A{constructor(e,t){this.res=e;this._ctx=t;this.set(404)}get finished(){return this.res.finished}hasHeader(e){return this.res.hasHeader(e)}getHeader(e){let t=this.res.getHeader(e);return Array.isArray(t)?t.join(';'):t}setHeader(e,t){this.res.setHeader(e,t)}removeHeader(e){return this.res.removeHeader(e)}flushHeaders(){return this.res.flushHeaders()}get type(){let e=this.getHeader('Content-Type');if('string'!==typeof e)return;return e.split(';')[0].trim()}get length(){return~~(this.getHeader('Content-Length')||'')}get status(){return this.res.statusCode}get body(){return this._body}set(e,t){if(this.finished)return;if(this.res.headersSent)throw new Error('Headears was sended');if('number'!==typeof e){t=e;e=undefined}if(t===undefined||null===t){this.res.statusCode=e||404;this._body=d.STATUS_CODES[this.res.statusCode];this.removeHeader('Content-Type');this.removeHeader('Content-Length');this.removeHeader('Transfer-Encoding');return}if(null===t){this.res.statusCode=e||204;this._body=null;this.removeHeader('Content-Type');this.removeHeader('Content-Length');this.removeHeader('Transfer-Encoding');return}this.res.statusCode=e||200;if('string'===typeof t){this._body=t;this.setHeader('Content-Type',(/^\s*</.test(t)?'text/html':'text/plain')+'; charset=utf-8');this.setHeader('Content-Length',Buffer.byteLength(t));return}if(Buffer.isBuffer(t)){let e=new R(t);this._body=t;this.setHeader('Content-Type',e.mime||'application/octet-stream');this.setHeader('Content-Length',t.length);let r='inline';const n=Object(g.parse)(this._ctx.request.path);if(n.name){const t=e.extension||n.ext||'';if(t)r+=`; filename=${n.name}.${t}`}this.setHeader('Content-Disposition',r);return}if('object'===typeof t){let e=JSON.stringify(t);this._body=e;this.setHeader('Content-Type','application/json; charset=utf-8');this.setHeader('Content-Length',Buffer.byteLength(e));return}throw TypeError('Unknown response body type')}respond(){if(this.finished)return;if(null===this._body||this._body===undefined){this.res.end()}else{this.res.end(this._body)}}end(e,t){this.set(e,t);this.respond()}valueOf(){return{heders:this.res.getHeaders(),status:this.status,type:this.type,length:this.length,body:this.body}}toJSON(){return this.valueOf()}}class N{constructor(e){this._ctx=e;this.finished=false;this.data={}}get method(){return this._ctx.request.method}get path(){return this._ctx.request.path}get pathname(){return'/'+this._ctx.request.pathname.join('/')}get query(){return this._ctx.request.query}valueOf(){return{finished:this.finished,data:this.data,method:this.method,path:this.path,pathname:this.pathname,query:this.query}}toJSON(){return this.valueOf()}}class v extends Array{static get(e){return this.List.get(e)||new v}static set(e,t){this.List.set(e,t)}}v.List=new WeakMap;const C=/^\*+$/,x=/^\:+(.*)$/,P=/^[a-z][a-z0-9]*$/i,L=(e)=>e.replace(/([.+*?=^!:${}()[\]|/\\])/g,'\\$1');class D{constructor(e=''){this.keys=['*'];let t=e.split(/\s*\/\s*/).filter((e)=>e.length).map((e)=>{if(C.test(e))return'[^/]+';let t=x.exec(e);if(!t)return L(e);let r=t[1];if(!P.test(r))throw TypeError(`Key name "${r}" does not match "${P.source}" pattern`);this.keys.push(r);return'([^/]+)'}).join('(?:/+)');this.pattern=new RegExp('^(?:/+)?'+t+'(?:/+)?$')}exec(e=''){let t=this.pattern.exec(e);if(!t)return;return t.reduce((e,t,r)=>{e[this.keys[r]]=t;return e},{})}}const w=new l.a('Route');function n(e,t,r,n){const o=new D(t);w('=== Route build [%s %s ? %O] => %s',e,t,r,n);return async function(s,a){const i=s.route;if(i.finished)return await a();if(i.method!==e||'HEAD'===i.method&&'GET'!==e)return await a();const p=o.exec(i.pathname);if(!p)return await a();for(let e of r)if(!(e in i.query))return await a();i.data=p;s.debug('=== Route [%s %s] ===\n%s %o -> %s',i.method,i.path,t,r,n);await this[n](s,a)}}function o(e,t='',...r){return(o,s)=>{if('symbol'===typeof s)throw new TypeError('Property name must be a string');let a=v.get(o.constructor);a.push(n(e,t,r,s));v.set(o.constructor,a)}}const U=(e,...t)=>o('DELETE',e,...t),M=(e,...t)=>o('GET',e,...t),k=(e,...t)=>o('POST',e,...t),F=(e,...t)=>o('PUT',e,...t);function s(e){return async function(t,r=()=>Promise.resolve()){let n=-1;const o=(s)=>async()=>{if(s<=n){throw new Error('next() called multiple times')}n=s;if(s>=e.length){return await r()}await e[s].call(this,t,o(s+1))};await o(0)()}}var j=r(12);class V extends j.a{constructor(){super(async(e,t)=>await this.main(e,t))}async main(e,t){await t()}}const Q=Symbol('RouteFunction');class q extends V{constructor(){super();this[Q]=s(v.get(this.constructor))}async main(e,t){return this[Q].call(this,e,t)}}class G{constructor(){this._roles=[]}static clearInput(e=[]){return e.reduce((e,t)=>e.concat(t),new Array).map((e)=>String(e).toLowerCase().trim()).filter((e,t,r)=>!!e&&r.indexOf(e)===t)}get all(){return this._roles.slice()}add(...e){const t=G.clearInput(e);this._roles=this._roles.concat(t).filter((e,t,r)=>r.indexOf(e)===t)}remove(...e){const t=G.clearInput(e);this._roles=this._roles.filter((e)=>!t.includes(e))}toggle(...e){const t=G.clearInput(e),r=t.filter((e)=>this._roles.includes(e)),n=t.filter((e)=>!this._roles.includes(e));this._roles=this._roles.filter((e)=>!r.includes(e)).concat(n)}set(...e){this._roles=G.clearInput(e)}reset(){this._roles=[]}checkAny(...e){const t=G.clearInput(e);for(let r of t)if(this._roles.includes(r))return true;return false}checkAll(...e){const t=G.clearInput(e);if(0===t.length)return false;for(let r of t)if(!this._roles.includes(r))return false;return true}valueOf(){return this.all}toJSON(){return this.valueOf()}}function a(...e){const t=G.clearInput(e);return(e,r,n)=>{if(!n)return n;const o=n.value;n.value=async function(e,n){e.session;if(!e.session){e.debug('=== ACL Denied ===\nSession is undefined');e.set(403);return await n()}if(!e.session.roles.checkAny(t)){e.debug('=== ACL [%O] Denied ===\nSession roles: %O\nProperty key: %s',t,e.session.roles,r);e.set(403);return await n()}e.debug('=== ACL [%O] Allow ===\nSession roles: %O\nProperty key: %s',t,e.session.roles,r);await o.call(this,e,n)};return n}}const H=/^[0-9a-z]+$/;class B{constructor(e){this._ctx=e;this._id='';this.data={};this.roles=new G}get ip(){return this._ctx.request.ip}get id(){return this._id}set id(e){const t=String(e).toLowerCase().trim();if(!H.test(t))throw new TypeError('Incorrect session id value');this._id=t}set({id:e,roles:t,data:r}={}){if(e!==undefined)this.id=e;if(t!==undefined)this.roles.set(t);if(r!==undefined){for(let e in this.data)delete this.data[e];Object.assign(this.data,r)}}reset(){this.set()}valueOf(){return{ip:this.ip,id:this.id,data:this.data,roles:this.roles.valueOf()}}toJSON(){return this.valueOf()}}class X extends V{async main(e,t){const r=await this.init(e);e.session.set(r);e.debug('=== Input session ===\n%O',e.session);await t();e.debug(`=== Output session ===\n%O`,e.session);await this.finally(e)}async init(){return{}}async finally(){}}var Y=r(0),z=r.n(Y);function i(e,t){if(!e.status||500<=e.status)console.error('\x1B[31m=== Internal context error ===\n',e,'\x1B[0m\n=== with Context ===\n',t===undefined?undefined:Object(Y.inspect)(t.valueOf(),{depth:3,colors:true}))}class ${constructor(e,t){this.debug=new l.a('Service');try{this.request=new h(e,this);this.response=new A(t,this);this.route=new N(this);this.session=new B(this)}catch(e){this.throw(e)}}get finished(){return this.response.finished}set(e,t){this.response.set(e,t)}respond(){this.response.respond()}end(e,t){this.response.end(e,t)}throw(e){if(e instanceof u)this.end(e.status,e.message);else this.end(500);i(e,this)}valueOf(){return{request:this.request.valueOf(),response:this.response.valueOf(),route:this.route.valueOf(),session:this.session.valueOf()}}toJSON(){return this.valueOf()}}const W=process.env.SERVICE_HOSTNAME||'0.0.0.0',K=p(~~(process.env.SERVICE_PORT||'')||0,0)||80,Z=p(~~(process.env.SERVICE_TIMEOUT||'')||0,0)||120,J=p(~~(process.env.SERVICE_KEEP_ALIVE||'')||0,0)||5;class ee extends d.Server{constructor(...e){super();const t=s(e.map((e)=>e));this.on('request',(e,r)=>{const n=new $(e,r);n.debug('=== Input Comntext ===\n%O',n);t(n,()=>Promise.resolve()).then(()=>{n.respond();n.debug('=== Output Comntext ===\n%O',n)}).catch((e)=>{i(e,n);try{n.throw(e)}catch(e){}})});this.on('clientError',(e,t)=>{t.end('HTTP/1.1 400 Bad Request\r\n\r\n');i(e)});this.timeout=Z;this.keepAliveTimeout=J;this.listen(K,W,()=>{const e=this.address();console.log(`Opened HTTP server on ${e.address}:${e.port}`)})}}r.d(t,'b',function(){return $});r.d(t,false,function(){return h});r.d(t,false,function(){return A});r.d(t,'e',function(){return u});r.d(t,false,function(){return s});r.d(t,'f',function(){return V});r.d(t,false,function(){return N});r.d(t,'c',function(){return U});r.d(t,'d',function(){return M});r.d(t,'g',function(){return k});r.d(t,'h',function(){return F});r.d(t,'i',function(){return q});r.d(t,'j',function(){return ee});r.d(t,'a',function(){return a});r.d(t,false,function(){return B});r.d(t,'k',function(){return X})},function(e,t,r){'use strict';var n=Number.isNaN,o=Math.max,s=r(10),a=r.n(s);class i extends Error{constructor(e){if(!e){super('unknown database error');this.code='XXXXX';this.origin=undefined;return this}super(e.message&&String(e.message)||String(e));this.code=e.code&&String(e.code).toUpperCase()||'XXXXX';this.origin=e.origin instanceof Error?e.origin:e instanceof Error?e:undefined}is(e){return this.code===e.toUpperCase()}}i.CASE_NOT_FOUND='20000';i.CARDINALITY_VIOLATION='21000';i.DATA_EXCEPTION='22000';i.ARRAY_SUBSCRIPT_ERROR='2202E';i.CHARACTER_NOT_IN_REPERTOIRE='22021';i.DATETIME_FIELD_OVERFLOW='22008';i.DIVISION_BY_ZERO='22012';i.ERROR_IN_ASSIGNMENT='22005';i.ESCAPE_CHARACTER_CONFLICT='2200B';i.INDICATOR_OVERFLOW='22022';i.INTERVAL_FIELD_OVERFLOW='22015';i.INVALID_ARGUMENT_FOR_LOGARITHM='2201E';i.INVALID_ARGUMENT_FOR_NTILE_FUNCTION='22014';i.INVALID_ARGUMENT_FOR_NTH_VALUE_FUNCTION='22016';i.INVALID_ARGUMENT_FOR_POWER_FUNCTION='2201F';i.INVALID_ARGUMENT_FOR_WIDTH_BUCKET_FUNCTION='2201G';i.INVALID_CHARACTER_VALUE_FOR_CAST='22018';i.INVALID_DATETIME_FORMAT='22007';i.INVALID_ESCAPE_CHARACTER='22019';i.INVALID_ESCAPE_OCTET='2200D';i.INVALID_ESCAPE_SEQUENCE='22025';i.NONSTANDARD_USE_OF_ESCAPE_CHARACTER='22P06';i.INVALID_INDICATOR_PARAMETER_VALUE='22010';i.INVALID_PARAMETER_VALUE='22023';i.INVALID_REGULAR_EXPRESSION='2201B';i.INVALID_ROW_COUNT_IN_LIMIT_CLAUSE='2201W';i.INVALID_ROW_COUNT_IN_RESULT_OFFSET_CLAUSE='2201X';i.INVALID_TABLESAMPLE_ARGUMENT='2202H';i.INVALID_TABLESAMPLE_REPEAT='2202G';i.INVALID_TIME_ZONE_DISPLACEMENT_VALUE='22009';i.INVALID_USE_OF_ESCAPE_CHARACTER='2200C';i.MOST_SPECIFIC_TYPE_MISMATCH='2200G';i.NULL_VALUE_NOT_ALLOWED='22004';i.NULL_VALUE_NO_INDICATOR_PARAMETER='22002';i.NUMERIC_VALUE_OUT_OF_RANGE='22003';i.SEQUENCE_GENERATOR_LIMIT_EXCEEDED='2200H';i.STRING_DATA_LENGTH_MISMATCH='22026';i.STRING_DATA_RIGHT_TRUNCATION='22001';i.SUBSTRING_ERROR='22011';i.TRIM_ERROR='22027';i.UNTERMINATED_C_STRING='22024';i.ZERO_LENGTH_CHARACTER_STRING='2200F';i.FLOATING_POINT_EXCEPTION='22P01';i.INVALID_TEXT_REPRESENTATION='22P02';i.INVALID_BINARY_REPRESENTATION='22P03';i.BAD_COPY_FILE_FORMAT='22P04';i.UNTRANSLATABLE_CHARACTER='22P05';i.NOT_AN_XML_DOCUMENT='2200L';i.INVALID_XML_DOCUMENT='2200M';i.INVALID_XML_CONTENT='2200N';i.INVALID_XML_COMMENT='2200S';i.INVALID_XML_PROCESSING_INSTRUCTION='2200T';i.INTEGRITY_CONSTRAINT_VIOLATION='23000';i.RESTRICT_VIOLATION='23001';i.NOT_NULL_VIOLATION='23502';i.FOREIGN_KEY_VIOLATION='23503';i.UNIQUE_VIOLATION='23505';i.CHECK_VIOLATION='23514';i.EXCLUSION_VIOLATION='23P01';i.INVALID_CURSOR_STATE='24000';i.INVALID_TRANSACTION_STATE='25000';i.ACTIVE_SQL_TRANSACTION='25001';i.BRANCH_TRANSACTION_ALREADY_ACTIVE='25002';i.HELD_CURSOR_REQUIRES_SAME_ISOLATION_LEVEL='25008';i.INAPPROPRIATE_ACCESS_MODE_FOR_BRANCH_TRANSACTION='25003';i.INAPPROPRIATE_ISOLATION_LEVEL_FOR_BRANCH_TRANSACTION='25004';i.NO_ACTIVE_SQL_TRANSACTION_FOR_BRANCH_TRANSACTION='25005';i.READ_ONLY_SQL_TRANSACTION='25006';i.SCHEMA_AND_DATA_STATEMENT_MIXING_NOT_SUPPORTED='25007';i.NO_ACTIVE_SQL_TRANSACTION='25P01';i.IN_FAILED_SQL_TRANSACTION='25P02';i.IDLE_IN_TRANSACTION_SESSION_TIMEOUT='25P03';i.INVALID_SQL_STATEMENT_NAME='26000';i.TRIGGERED_DATA_CHANGE_VIOLATION='27000';i.DEPENDENT_PRIVILEGE_DESCRIPTORS_STILL_EXIST='2B000';i.DEPENDENT_OBJECTS_STILL_EXIST='2BP01';i.INVALID_TRANSACTION_TERMINATION='2D000';i.SQL_ROUTINE_EXCEPTION='2F000';i.FUNCTION_EXECUTED_NO_RETURN_STATEMENT='2F005';i.MODIFYING_SQL_DATA_NOT_PERMITTED='2F002';i.PROHIBITED_SQL_STATEMENT_ATTEMPTED='2F003';i.READING_SQL_DATA_NOT_PERMITTED='2F004';i.TRANSACTION_ROLLBACK='40000';i.TRANSACTION_INTEGRITY_CONSTRAINT_VIOLATION='40002';i.SERIALIZATION_FAILURE='40001';i.STATEMENT_COMPLETION_UNKNOWN='40003';i.DEADLOCK_DETECTED='40P01';i.SYNTAX_ERROR_OR_ACCESS_RULE_VIOLATION='42000';i.SYNTAX_ERROR='42601';i.INSUFFICIENT_PRIVILEGE='42501';i.CANNOT_COERCE='42846';i.GROUPING_ERROR='42803';i.WINDOWING_ERROR='42P20';i.INVALID_RECURSION='42P19';i.INVALID_FOREIGN_KEY='42830';i.INVALID_NAME='42602';i.NAME_TOO_LONG='42622';i.RESERVED_NAME='42939';i.DATATYPE_MISMATCH='42804';i.INDETERMINATE_DATATYPE='42P18';i.COLLATION_MISMATCH='42P21';i.INDETERMINATE_COLLATION='42P22';i.WRONG_OBJECT_TYPE='42809';i.GENERATED_ALWAYS='428C9';i.UNDEFINED_COLUMN='42703';i.UNDEFINED_FUNCTION='42883';i.UNDEFINED_TABLE='42P01';i.UNDEFINED_PARAMETER='42P02';i.UNDEFINED_OBJECT='42704';i.DUPLICATE_COLUMN='42701';i.DUPLICATE_CURSOR='42P03';i.DUPLICATE_DATABASE='42P04';i.DUPLICATE_FUNCTION='42723';i.DUPLICATE_PREPARED_STATEMENT='42P05';i.DUPLICATE_SCHEMA='42P06';i.DUPLICATE_TABLE='42P07';i.DUPLICATE_ALIAS='42712';i.DUPLICATE_OBJECT='42710';i.AMBIGUOUS_COLUMN='42702';i.AMBIGUOUS_FUNCTION='42725';i.AMBIGUOUS_PARAMETER='42P08';i.AMBIGUOUS_ALIAS='42P09';i.INVALID_COLUMN_REFERENCE='42P10';i.INVALID_COLUMN_DEFINITION='42611';i.INVALID_CURSOR_DEFINITION='42P11';i.INVALID_DATABASE_DEFINITION='42P12';i.INVALID_FUNCTION_DEFINITION='42P13';i.INVALID_PREPARED_STATEMENT_DEFINITION='42P14';i.INVALID_SCHEMA_DEFINITION='42P15';i.INVALID_TABLE_DEFINITION='42P16';i.INVALID_OBJECT_DEFINITION='42P17';i.WITH_CHECK_OPTION_VIOLATION='44000';const p=process.env.POSTGRES_HOST||'localhost',l=o(~~(process.env.POSTGRES_PORT||''),0)||5432,d=process.env.POSTGRES_DB||'postgres',c=process.env.POSTGRES_USER||'postgres',u=process.env.POSTGRES_PASSWORD||'',m=o(~~(process.env.POSTGRES_IDLE_TIMEOUT||'')||0,0)||10,y=o(~~(process.env.POSTGRES_POOL_SIZE||'')||0,0)||10,f={host:p,port:l,user:c,password:u,database:d,idleTimeoutMillis:1e3*m,max:y},_=(e={})=>{const t=Object.assign({},f,e);console.log('=== Init PG Pool with config ===\n',Object.assign({},f,{password:'*****'}));return new s.Pool(t)};var h=r(7);const g=new h.a('DB');class b{constructor(e){this.name=e}valueOf(){return{text:this.text,values:this.values}}async exec(e){if(!(e instanceof s.Client))throw new TypeError('client is not an instanceof PG Client');g(`=== SQL Query ===\n%O`,this);let t;try{t=await e.query(this.valueOf())}catch(e){g(`=== SQL Query Error ===\n%O`,e);throw new i(e)}g(`=== SQL Query Successful ===\n%O`,t.rows);return t.rows}}class E{constructor(e=null,t=0,r=[]){this.text='';this.values=[];if(null===e||!e.trim()){this.values=[];this.text='';return this}if('string'===typeof e){let n=t;this.values=[];this.text=' WHERE '+e.replace(/\$\d+/g,(e)=>{let t=~~/\d+/.exec(e)[0]-1;if(r[t]===undefined)return'DEFAULT';this.values.push(r[t]);return`$${++n}`});return this}throw new TypeError('value is not a null, array, object or string')}}class T{constructor(e=null){if(null===e){this.text='';return this}if(Array.isArray(e)){this.text=' ORDER BY '+e.map((e)=>`"${e}" ASC`).join(', ');return this}if('object'===typeof e){let t=Object.keys(e);if(0===t.length){this.text='';return this}this.text=' ORDER BY '+t.map((t)=>`"${t}" ${e[t]}`).join(', ');return this}if('string'===typeof e){this.text=` ORDER BY "${e}" ASC`;return this}throw new TypeError('value is not a null, array, object or string')}}class I{constructor(e=Infinity){if(n(e))throw new TypeError('limit is not a number');if(0>=e)throw new TypeError('limit is less than or equal to zero');if(e<Infinity)this.text=` LIMIT ${e}`;else this.text=''}}class S{constructor(e=0){if(n(e))throw new TypeError('offset is not a number');if(0>e)throw new TypeError('offset is less than zero');if(e===Infinity)throw new TypeError('offset is Infinity');if(0<e)this.text=' OFFSET ${offset}';else this.text=''}}class O extends b{constructor(e,t=[]){super('SELECT');this._where=new E;this._order=new T;this._limit=new I;this._offset=new S;let r=Array.isArray(t)?t:Object.keys(t);r=r.map((e)=>`"${e}"`);this._command=`SELECT ${r.join(', ')||'*'} FROM "${e.scheme}"."${e.table}"`}where(e,...t){this._where=new E(e,0,t);return this}order(e){this._order=new T(e);return this}limit(e){this._limit=new I(e);return this}offset(e){this._offset=new S(e);return this}get text(){return this._command+this._where.text+this._order.text+this._limit.text+this._offset.text}get values(){return this._where.values}}class R{constructor(e=[]){let t=Array.isArray(e)?e:'string'===typeof e?[e]:Object.keys(e);t=t.map((e)=>`"${e}"`);this.text=` RETURNING ${t.join(', ')||'*'}`}}class A extends b{constructor(e,t={}){super('INSERT');this._returning=new R;const r=t.valueOf instanceof Function?t.valueOf():t;let n=Object.keys(r);if(0===n.length)throw new TypeError('filtred value is an empty object');this.values=[];let o=[];n.forEach((e)=>{if(r[e]===undefined){o.push('DEFAULT');return}let t=this.values.push(r[e]);o.push(`$${t}`)});n=n.map((e)=>`"${e}"`);this._command=`INSERT INTO "${e.scheme}"."${e.table}" (${n.join(', ')}) VALUES (${o.join(', ')})`}returning(e){this._returning=new R(e);return this}get text(){return this._command+this._returning.text}}class N extends b{constructor(e,t={},r=[]){super('UPDATE');this._values=[];this._returning=new R;this._where=new E;this._command=`UPDATE "${e.scheme}"."${e.table}" SET `;if('string'===typeof t){this._command+=t.replace(/\$\d+/g,(e)=>{let t=~~/\d+/.exec(e)[0]-1;if(r[t]===undefined)return'DEFAULT';let n=this._values.push(r[t]);return`$${n}`});return this}const n=t.valueOf instanceof Function?t.valueOf():t;let o=Object.keys(n);if(0===o.length)throw new TypeError('updated value is an empty object');o=o.map((e)=>{let t=`"${e}" = `;if(n[e]===undefined){return t+'DEFAULT'}let r=this._values.push(n[e]);return t+`$${r}`});this._command+=`${o.join(', ')}`}where(e,...t){this._where=new E(e,this._values.length,t);return this}returning(e){this._returning=new R(e);return this}get text(){return this._command+this._where.text+this._returning.text}get values(){return[...this._values,...this._where.values]}}class v extends b{constructor(e){super('DELETE');this._where=new E;this._returning=new R;this._command=`DELETE FROM "${e.scheme}"."${e.table}"`}where(e,...t){this._where=new E(e,0,t);return this}returning(e){this._returning=new R(e);return this}get text(){return this._command+this._where.text+this._returning.text}get values(){return this._where.values}}class C{constructor(e,{scheme:t}={}){this.table=e;this.scheme=t||'public'}select(e){return new O(this,e)}insert(e){return new A(this,e)}update(e,...t){return new N(this,e,t)}delete(){return new v(this)}}class x extends b{constructor(e,...t){super('CUSTOM');this.values=[];this.text=String(e).replace(/\$\d+/g,(e)=>{let r=~~/\d+/.exec(e)[0]-1;if(t[r]===undefined)return'DEFAULT';let n=this.values.push(t[r]);return`$${n}`})}}var P=r(1);class L extends P.f{constructor(){super(...arguments);this._pool=_()}async main(e,t){e.db=await this._pool.connect();await t();e.db.release()}}r.d(t,false,function(){return s.Pool});r.d(t,false,function(){return s.Client});r.d(t,'b',function(){return i});r.d(t,'e',function(){return _});r.d(t,'d',function(){return C});r.d(t,'a',function(){return x});r.d(t,'c',function(){return L})},function(e){e.exports=require('events')},function(e,t,r){'use strict';e.exports={host:'localhost',user:'win32'===process.platform?process.env.USERNAME:process.env.USER,database:'win32'===process.platform?process.env.USERNAME:process.env.USER,password:null,connectionString:undefined,port:5432,rows:0,binary:false,max:10,idleTimeoutMillis:3e4,client_encoding:'',ssl:false,application_name:undefined,fallback_application_name:undefined,parseInputDatesAsUTC:false,statement_timeout:false};var n=r(5),o=n.getTypeParser(20,'text'),s=n.getTypeParser(1016,'text');e.exports.__defineSetter__('parseInt8',function(e){n.setTypeParser(20,'text',e?n.getTypeParser(23,'text'):o);n.setTypeParser(1016,'text',e?n.getTypeParser(1007,'text'):s)})},function(e,t,r){var o=r(28),s=r(33),a=r(16);t.getTypeParser=function(e,t){t=t||'text';if(!i[t]){return n}return i[t][e]||n};t.setTypeParser=function(e,t,r){if('function'==typeof t){r=t;t='text'}i[t][e]=r};t.arrayParser=a;var i={text:{},binary:{}};function n(e){return String(e)}o.init(function(e,t){i.text[e]=t});s.init(function(e,t){i.binary[e]=t})},,function(e,t,r){'use strict';var n=r(12);const o=(process.env.NODE_DEBUG||'').split(/\s*,\s*/).map((e)=>e.toLowerCase().trim()).filter((e)=>!!e),s=(e)=>o.includes(e)||o.includes('*'),a=(e,t)=>console.log(e,...t);class i extends n.a{constructor(e){const t=s(e.toLowerCase());super((r,...n)=>{if(!t)return;a(`${e}: ${r}`,n.map((e)=>e&&e.valueOf instanceof Function?e.valueOf():e))});this.enable=t}}r.d(t,'a',function(){return i})},function(e){e.exports=require('http')},function(e){e.exports=require('path')},function(e,t,r){'use strict';var n=r(0),o=r(27),s=r(4),a=r(19),i=r(48);const p=(e)=>{var t=function(t){var r=Object.assign({Client:e},t);return new i(r)};n.inherits(t,i);return t};var l=function(e){this.defaults=s;this.Client=e;this.Query=this.Client.Query;this.Pool=p(this.Client);this._pools=[];this.Connection=a;this.types=r(5)};if('undefined'!==typeof process.env.NODE_PG_FORCE_NATIVE){e.exports=new l(r(21))}else{e.exports=new l(o);e.exports.__defineGetter__('native',function(){delete e.exports.native;var t=null;try{t=new l(r(21))}catch(e){if('MODULE_NOT_FOUND'!==e.code){throw e}console.error(e.message)}e.exports.native=t;return t})}},function(e,t,r){'use strict';const l=r(22),d=r(4);function n(e){var t=e.replace(/\\/g,'\\\\').replace(/"/g,'\\"');return'"'+t+'"'}function o(e){for(var t='{',r=0;r<e.length;r++){if(0<r){t=t+','}if(null===e[r]||'undefined'===typeof e[r]){t=t+'NULL'}else if(Array.isArray(e[r])){t=t+o(e[r])}else if(e[r]instanceof Buffer){t+='\\\\x'+e[r].toString('hex')}else{t+=n(c(e[r]))}}t=t+'}';return t}var c=function(e,t){if(e instanceof Buffer){return e}if(ArrayBuffer.isView(e)){var r=Buffer.from(e.buffer,e.byteOffset,e.byteLength);if(r.length===e.byteLength){return r}return r.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(e instanceof Date){if(d.parseInputDatesAsUTC){return p(e)}else{return i(e)}}if(Array.isArray(e)){return o(e)}if(null===e||'undefined'===typeof e){return null}if('object'===typeof e){return s(e,t)}return e.toString()};function s(e,t){if(e&&'function'===typeof e.toPostgres){t=t||[];if(-1!==t.indexOf(e)){throw new Error('circular reference detected while preparing "'+e+'" for query')}t.push(e);return c(e.toPostgres(c),t)}return JSON.stringify(e)}function a(e,t){e=''+e;while(e.length<t){e='0'+e}return e}function i(e){var t=-e.getTimezoneOffset(),r=a(e.getFullYear(),4)+'-'+a(e.getMonth()+1,2)+'-'+a(e.getDate(),2)+'T'+a(e.getHours(),2)+':'+a(e.getMinutes(),2)+':'+a(e.getSeconds(),2)+'.'+a(e.getMilliseconds(),3);if(0>t){r+='-';t*=-1}else{r+='+'}return r+a(Math.floor(t/60),2)+':'+a(t%60,2)}function p(e){var t=a(e.getUTCFullYear(),4)+'-'+a(e.getUTCMonth()+1,2)+'-'+a(e.getUTCDate(),2)+'T'+a(e.getUTCHours(),2)+':'+a(e.getUTCMinutes(),2)+':'+a(e.getUTCSeconds(),2)+'.'+a(e.getUTCMilliseconds(),3);return t+'+00:00'}const u=function(e){return l.createHash('md5').update(e,'utf-8').digest('hex')};e.exports={prepareValue:function(e){return c(e)},normalizeQueryConfig:function(e,t,r){e='string'===typeof e?{text:e}:e;if(t){if('function'===typeof t){e.callback=t}else{e.values=t}}if(r){e.callback=r}return e},postgresMd5PasswordHash:function(e,t,r){var n=u(t+e),o=u(Buffer.concat([Buffer.from(n),r]));return'md5'+o},md5:u}},function(e,t,r){'use strict';class n extends Function{constructor(e){super('throw new TypeError("CallableClass was called")');return Object.setPrototypeOf(e,new.target.prototype)}}r.d(t,'a',function(){return n})},function(e){e.exports=require('stream')},function(e){e.exports=require('string_decoder')},function(e,t){'use strict';t.parse=function(e,t){return new r(e,t).parse()};function r(e,t){this.source=e;this.transform=t||n;this.position=0;this.entries=[];this.recorded=[];this.dimension=0}r.prototype.isEof=function(){return this.position>=this.source.length};r.prototype.nextCharacter=function(){var e=this.source[this.position++];if('\\'===e){return{value:this.source[this.position++],escaped:true}}return{value:e,escaped:false}};r.prototype.record=function(e){this.recorded.push(e)};r.prototype.newEntry=function(e){var t;if(0<this.recorded.length||e){t=this.recorded.join('');if('NULL'===t&&!e){t=null}if(null!==t)t=this.transform(t);this.entries.push(t);this.recorded=[]}};r.prototype.parse=function(e){var t,n,o;while(!this.isEof()){t=this.nextCharacter();if('{'===t.value&&!o){this.dimension++;if(1<this.dimension){n=new r(this.source.substr(this.position-1),this.transform);this.entries.push(n.parse(true));this.position+=n.position-2}}else if('}'===t.value&&!o){this.dimension--;if(!this.dimension){this.newEntry();if(e)return this.entries}}else if('"'===t.value&&!t.escaped){if(o)this.newEntry(true);o=!o}else if(','===t.value&&!o){this.newEntry()}else{this.record(t.value)}}if(0!==this.dimension){throw new Error('array dimension not balanced')}return this.entries};function n(e){return e}},function(e,t,r){var n=r(15);e.exports={create:function(e,t){return{parse:function(){return n.parse(e,t)}}}}},function(e,t,r){'use strict';var o=r(5);function n(e){this._types=e||o;this.text={};this.binary={}}n.prototype.getOverrides=function(e){switch(e){case'text':return this.text;case'binary':return this.binary;default:return{};}};n.prototype.setTypeParser=function(e,t,r){if('function'===typeof t){r=t;t='text'}this.getOverrides(t)[e]=r};n.prototype.getTypeParser=function(e,t){t=t||'text';return this.getOverrides(t)[e]||this._types.getTypeParser(e,t)};e.exports=n},function(e,t,r){'use strict';var n=r(39),o=r(4),s=r(40).parse,a=function(e,t,r){if(r===undefined){r=process.env['PG'+e.toUpperCase()]}else if(!(false===r)){r=process.env[r]}return t[e]||r||o[e]},i=function(){switch(process.env.PGSSLMODE){case'disable':return false;case'prefer':case'require':case'verify-ca':case'verify-full':return true;}return o.ssl},p=function(e){e='string'===typeof e?s(e):e||{};if(e.connectionString){e=Object.assign({},e,s(e.connectionString))}this.user=a('user',e);this.database=a('database',e);this.port=parseInt(a('port',e),10);this.host=a('host',e);this.password=a('password',e);this.binary=a('binary',e);this.ssl='undefined'===typeof e.ssl?i():e.ssl;this.client_encoding=a('client_encoding',e);this.replication=a('replication',e);this.isDomainSocket=!(this.host||'').indexOf('/');this.application_name=a('application_name',e,'PGAPPNAME');this.fallback_application_name=a('fallback_application_name',e,false);this.statement_timeout=a('statement_timeout',e,false)},l=function(e){return'\''+(''+e).replace(/\\/g,'\\\\').replace(/'/g,'\\\'')+'\''},d=function(e,t,r){var n=t[r];if(n){e.push(r+'='+l(n))}};p.prototype.getLibpqConnectionString=function(e){var t=[];d(t,this,'user');d(t,this,'password');d(t,this,'port');d(t,this,'application_name');d(t,this,'fallback_application_name');var r='object'===typeof this.ssl?this.ssl:{sslmode:this.ssl};d(t,r,'sslmode');d(t,r,'sslca');d(t,r,'sslkey');d(t,r,'sslcert');d(t,r,'sslrootcert');if(this.database){t.push('dbname='+l(this.database))}if(this.replication){t.push('replication='+l(this.replication))}if(this.host){t.push('host='+l(this.host))}if(this.isDomainSocket){return e(null,t.join(' '))}if(this.client_encoding){t.push('client_encoding='+l(this.client_encoding))}n.lookup(this.host,function(r,n){if(r)return e(r,null);t.push('hostaddr='+l(n));return e(null,t.join(' '))})};e.exports=p},function(e,t,r){'use strict';var n=r(44),o=r(3).EventEmitter,s=r(0),a=r(45),i=r(46),p=0,l=function(e){o.call(this);e=e||{};this.stream=e.stream||new n.Stream;this._keepAlive=e.keepAlive;this.lastBuffer=false;this.lastOffset=0;this.buffer=null;this.offset=null;this.encoding=e.encoding||'utf8';this.parsedStatements={};this.writer=new a;this.ssl=e.ssl||false;this._ending=false;this._mode=p;this._emitMessage=false;this._reader=new i({headerSize:1,lengthPadding:-4});var t=this;this.on('newListener',function(e){if('message'===e){t._emitMessage=true}})};s.inherits(l,o);l.prototype.connect=function(e,t){if('closed'===this.stream.readyState){this.stream.connect(e,t)}else if('open'===this.stream.readyState){this.emit('connect')}var n=this;this.stream.on('connect',function(){if(n._keepAlive){n.stream.setKeepAlive(true)}n.emit('connect')});this.stream.on('error',function(e){if(n._ending&&'ECONNRESET'===e.code){return}n.emit('error',e)});this.stream.on('close',function(){n.emit('end')});if(!this.ssl){return this.attachListeners(this.stream)}this.stream.once('data',function(e){var o=e.toString('utf8');if('S'!==o){return n.emit('error',new Error('The server does not support SSL connections'))}var s=r(47);n.stream=s.connect({socket:n.stream,servername:t,rejectUnauthorized:n.ssl.rejectUnauthorized,ca:n.ssl.ca,pfx:n.ssl.pfx,key:n.ssl.key,passphrase:n.ssl.passphrase,cert:n.ssl.cert,NPNProtocols:n.ssl.NPNProtocols});n.attachListeners(n.stream);n.emit('sslconnect');n.stream.on('error',function(e){n.emit('error',e)})})};l.prototype.attachListeners=function(e){var t=this;e.on('data',function(e){t._reader.addChunk(e);var r=t._reader.read();while(r){var n=t.parseMessage(r);if(t._emitMessage){t.emit('message',n)}t.emit(n.name,n);r=t._reader.read()}});e.on('end',function(){t.emit('end')})};l.prototype.requestSsl=function(){var e=this.writer.addInt16(1234).addInt16(5679).flush(),t=e.length+4,r=new a().addInt32(t).add(e).join();this.stream.write(r)};l.prototype.startup=function(e){var t=this.writer.addInt16(3).addInt16(0);Object.keys(e).forEach(function(r){var n=e[r];t.addCString(r).addCString(n)});t.addCString('client_encoding').addCString('\'utf-8\'');var r=t.addCString('').flush(),n=r.length+4,o=new a().addInt32(n).add(r).join();this.stream.write(o)};l.prototype.cancel=function(e,t){var r=this.writer.addInt16(1234).addInt16(5678).addInt32(e).addInt32(t).flush(),n=r.length+4,o=new a().addInt32(n).add(r).join();this.stream.write(o)};l.prototype.password=function(e){this._send(112,this.writer.addCString(e))};l.prototype._send=function(e,t){if(!this.stream.writable){return false}if(true===t){this.writer.addHeader(e)}else{return this.stream.write(this.writer.flush(e))}};l.prototype.query=function(e){this.stream.write(this.writer.addCString(e).flush(81))};l.prototype.parse=function(e,t){e.name=e.name||'';if(63<e.name.length){console.error('Warning! Postgres only supports 63 characters for query names.');console.error('You supplied',e.name,'(',e.name.length,')');console.error('This can cause conflicts and silent errors executing queries')}e.types=e.types||[];for(var r=e.types.length,n=this.writer.addCString(e.name).addCString(e.text).addInt16(r),o=0;o<r;o++){n.addInt32(e.types[o])}this._send(80,t)};l.prototype.bind=function(e,t){e=e||{};e.portal=e.portal||'';e.statement=e.statement||'';e.binary=e.binary||false;for(var r=e.values||[],n=r.length,o=false,s=0;s<n;s++){o|=r[s]instanceof Buffer}var a=this.writer.addCString(e.portal).addCString(e.statement);if(!o){a.addInt16(0)}else{a.addInt16(n);for(s=0;s<n;s++){a.addInt16(r[s]instanceof Buffer)}}a.addInt16(n);for(var p=0,i;p<n;p++){i=r[p];if(null===i||'undefined'===typeof i){a.addInt32(-1)}else if(i instanceof Buffer){a.addInt32(i.length);a.add(i)}else{a.addInt32(Buffer.byteLength(i));a.addString(i)}}if(e.binary){a.addInt16(1);a.addInt16(1)}else{a.addInt16(0)}this._send(66,t)};l.prototype.execute=function(e,t){e=e||{};e.portal=e.portal||'';e.rows=e.rows||'';this.writer.addCString(e.portal).addInt32(e.rows);this._send(69,t)};var d=Buffer.alloc(0);l.prototype.flush=function(){this.writer.add(d);this._send(72)};l.prototype.sync=function(){this.writer.flush(0);this.writer.add(d);this._ending=true;this._send(83)};const c=Buffer.from([88,0,0,0,4]);l.prototype.end=function(){this.writer.add(d);this._ending=true;return this.stream.write(c)};l.prototype.close=function(e,t){this.writer.addCString(e.type+(e.name||''));this._send(67,t)};l.prototype.describe=function(e,t){this.writer.addCString(e.type+(e.name||''));this._send(68,t)};l.prototype.sendCopyFromChunk=function(e){this.stream.write(this.writer.add(e).flush(100))};l.prototype.endCopyFrom=function(){this.stream.write(this.writer.add(d).flush(99))};l.prototype.sendCopyFail=function(e){this.writer.addCString(e);this._send(102)};var u=function(e,t){this.name=e;this.length=t};l.prototype.parseMessage=function(e){this.offset=0;var t=e.length+4;switch(this._reader.header){case 82:return this.parseR(e,t);case 83:return this.parseS(e,t);case 75:return this.parseK(e,t);case 67:return this.parseC(e,t);case 90:return this.parseZ(e,t);case 84:return this.parseT(e,t);case 68:return this.parseD(e,t);case 69:return this.parseE(e,t);case 78:return this.parseN(e,t);case 49:return new u('parseComplete',t);case 50:return new u('bindComplete',t);case 51:return new u('closeComplete',t);case 65:return this.parseA(e,t);case 110:return new u('noData',t);case 73:return new u('emptyQuery',t);case 115:return new u('portalSuspended',t);case 71:return this.parseG(e,t);case 72:return this.parseH(e,t);case 87:return new u('replicationStart',t);case 99:return new u('copyDone',t);case 100:return this.parsed(e,t);}};l.prototype.parseR=function(e,t){var r=0,n=new u('authenticationOk',t);if(8===n.length){r=this.parseInt32(e);if(3===r){n.name='authenticationCleartextPassword'}return n}if(12===n.length){r=this.parseInt32(e);if(5===r){n.name='authenticationMD5Password';n.salt=Buffer.alloc(4);e.copy(n.salt,0,this.offset,this.offset+4);this.offset+=4;return n}}throw new Error('Unknown authenticationOk message type'+s.inspect(n))};l.prototype.parseS=function(e,t){var r=new u('parameterStatus',t);r.parameterName=this.parseCString(e);r.parameterValue=this.parseCString(e);return r};l.prototype.parseK=function(e,t){var r=new u('backendKeyData',t);r.processID=this.parseInt32(e);r.secretKey=this.parseInt32(e);return r};l.prototype.parseC=function(e,t){var r=new u('commandComplete',t);r.text=this.parseCString(e);return r};l.prototype.parseZ=function(e,t){var r=new u('readyForQuery',t);r.name='readyForQuery';r.status=this.readString(e,1);return r};l.prototype.parseT=function(e,t){var r=new u('rowDescription',t);r.fieldCount=this.parseInt16(e);for(var n=[],o=0;o<r.fieldCount;o++){n.push(this.parseField(e))}r.fields=n;return r};var m=function(){this.name=null;this.tableID=null;this.columnID=null;this.dataTypeID=null;this.dataTypeSize=null;this.dataTypeModifier=null;this.format=null};l.prototype.parseField=function(e){var t=new m;t.name=this.parseCString(e);t.tableID=this.parseInt32(e);t.columnID=this.parseInt16(e);t.dataTypeID=this.parseInt32(e);t.dataTypeSize=this.parseInt16(e);t.dataTypeModifier=this.parseInt32(e);if(this.parseInt16(e)===p){this._mode=p;t.format='text'}else{this._mode=1;t.format='binary'}return t};var y=function(e,t){this.name='dataRow';this.length=e;this.fieldCount=t;this.fields=[]};l.prototype.parseD=function(e,t){for(var r=this.parseInt16(e),n=new y(t,r),o=0;o<r;o++){n.fields.push(this._readValue(e))}return n};l.prototype._readValue=function(e){var t=this.parseInt32(e);if(-1===t)return null;if(this._mode===p){return this.readString(e,t)}return this.readBytes(e,t)};l.prototype.parseE=function(e,t){var r={},n,o,s=new u('error',t),a=this.readString(e,1);while('\0'!==a){r[a]=this.parseCString(e);a=this.readString(e,1)}if('error'===s.name){n=new Error(r.M);for(o in s){if(s.hasOwnProperty(o)){n[o]=s[o]}}}else{n=s;n.message=r.M}n.severity=r.S;n.code=r.C;n.detail=r.D;n.hint=r.H;n.position=r.P;n.internalPosition=r.p;n.internalQuery=r.q;n.where=r.W;n.schema=r.s;n.table=r.t;n.column=r.c;n.dataType=r.d;n.constraint=r.n;n.file=r.F;n.line=r.L;n.routine=r.R;return n};l.prototype.parseN=function(e,t){var r=this.parseE(e,t);r.name='notice';return r};l.prototype.parseA=function(e,t){var r=new u('notification',t);r.processId=this.parseInt32(e);r.channel=this.parseCString(e);r.payload=this.parseCString(e);return r};l.prototype.parseG=function(e,t){var r=new u('copyInResponse',t);return this.parseGH(e,r)};l.prototype.parseH=function(e,t){var r=new u('copyOutResponse',t);return this.parseGH(e,r)};l.prototype.parseGH=function(e,t){var r=0!==e[this.offset];this.offset++;t.binary=r;var n=this.parseInt16(e);t.columnTypes=[];for(var o=0;o<n;o++){t.columnTypes.push(this.parseInt16(e))}return t};l.prototype.parsed=function(e,t){var r=new u('copyData',t);r.chunk=this.readBytes(e,r.length-4);return r};l.prototype.parseInt32=function(e){var t=e.readInt32BE(this.offset,true);this.offset+=4;return t};l.prototype.parseInt16=function(e){var t=e.readInt16BE(this.offset,true);this.offset+=2;return t};l.prototype.readString=function(e,t){return e.toString(this.encoding,this.offset,this.offset+=t)};l.prototype.readBytes=function(e,t){return e.slice(this.offset,this.offset+=t)};l.prototype.parseCString=function(e){var t=this.offset,r=e.indexOf(0,t);this.offset=r+1;return e.toString(this.encoding,t,r)};e.exports=l},function(e){e.exports=require('assert')},function(e,t,r){'use strict';e.exports=r(49)},function(e){e.exports=require('crypto')},,function(e,t,r){'use strict';var n=r(56),o=r(91),s=r(69),a=r(94),i=function(){function e(e){this._isScalar=false;if(e){this._subscribe=e}}e.prototype.lift=function(t){var r=new e;r.source=this;r.operator=t;return r};e.prototype.subscribe=function(e,t,r){var n=this.operator,s=o.toSubscriber(e,t,r);if(n){n.call(s,this.source)}else{s.add(this.source||!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s))}if(s.syncErrorThrowable){s.syncErrorThrowable=false;if(s.syncErrorThrown){throw s.syncErrorValue}}return s};e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=true;e.syncErrorValue=t;e.error(t)}};e.prototype.forEach=function(e,t){var r=this;if(!t){if(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise){t=n.root.Rx.config.Promise}else if(n.root.Promise){t=n.root.Promise}}if(!t){throw new Error('no Promise impl found')}return new t(function(t,n){var o=r.subscribe(function(t){if(o){try{e(t)}catch(e){n(e);o.unsubscribe()}}else{e(t)}},n,t)})};e.prototype._subscribe=function(e){return this.source.subscribe(e)};e.prototype[s.observable]=function(){return this};e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++){e[t-0]=arguments[t]}if(0===e.length){return this}return a.pipeFromArray(e)(this)};e.prototype.toPromise=function(e){var t=this;if(!e){if(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise){e=n.root.Rx.config.Promise}else if(n.root.Promise){e=n.root.Promise}}if(!e){throw new Error('no Promise impl found')}return new e(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})};e.create=function(t){return new e(t)};return e}();t.Observable=i},function(e){e.exports=require('url')},function(e){e.exports=require('querystring')},function(e,t,r){'use strict';var n=r(3).EventEmitter,o=r(0),s=r(11),a=r(34),i=r(17),p=r(18),l=r(41),d=r(4),u=r(19),c=function(e){n.call(this);this.connectionParameters=new p(e);this.user=this.connectionParameters.user;this.database=this.connectionParameters.database;this.port=this.connectionParameters.port;this.host=this.connectionParameters.host;this.password=this.connectionParameters.password;this.replication=this.connectionParameters.replication;var t=e||{};this._types=new i(t.types);this._ending=false;this._connecting=false;this._connected=false;this._connectionError=false;this.connection=t.connection||new u({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||false,encoding:this.connectionParameters.client_encoding||'utf8'});this.queryQueue=[];this.binary=t.binary||d.binary;this.processID=null;this.secretKey=null;this.ssl=this.connectionParameters.ssl||false};o.inherits(c,n);c.prototype.connect=function(e){var r=this,n=this.connection;if(this._connecting||this._connected){const t=new Error('Client has already been connected. You cannot reuse a client.');if(e){e(t);return}return Promise.reject(t)}this._connecting=true;if(this.host&&0===this.host.indexOf('/')){n.connect(this.host+'/.s.PGSQL.'+this.port)}else{n.connect(this.port,this.host)}n.on('connect',function(){if(r.ssl){n.requestSsl()}else{n.startup(r.getStartupConf())}});n.on('sslconnect',function(){n.startup(r.getStartupConf())});function t(e){return function(t){if(null!==r.password){e(t)}else{a(r.connectionParameters,function(n){if(undefined!==n){r.connectionParameters.password=r.password=n}e(t)})}}}n.on('authenticationCleartextPassword',t(function(){n.password(r.password)}));n.on('authenticationMD5Password',t(function(e){n.password(s.postgresMd5PasswordHash(r.user,r.password,e.salt))}));n.once('backendKeyData',function(e){r.processID=e.processID;r.secretKey=e.secretKey});const o=(t)=>{if(this._connectionError){return}this._connectionError=true;if(e){return e(t)}this.emit('error',t)},i=(e)=>{if(this.activeQuery){var t=r.activeQuery;this.activeQuery=null;return t.handleError(e,n)}this.emit('error',e)};n.on('error',o);n.once('readyForQuery',function(){r._connecting=false;r._connected=true;r._attachListeners(n);n.removeListener('error',o);n.on('error',i);if(e){e(null,r);e=null}r.emit('connect')});n.on('readyForQuery',function(){var e=r.activeQuery;r.activeQuery=null;r.readyForQuery=true;if(e){e.handleReadyForQuery(n)}r._pulseQueryQueue()});n.once('end',()=>{if(this.activeQuery){var t=new Error('Connection terminated');this.activeQuery.handleError(t,n);this.activeQuery=null}if(!this._ending){const t=new Error('Connection terminated unexpectedly');if(this._connecting&&!this._connectionError){if(e){e(t)}else{this.emit('error',t)}}else if(!this._connectionError){this.emit('error',t)}}this.emit('end')});n.on('notice',function(e){r.emit('notice',e)});if(!e){return new global.Promise((e,t)=>{this.once('error',t);this.once('connect',()=>{this.removeListener('error',t);e()})})}};c.prototype._attachListeners=function(e){const t=this;e.on('rowDescription',function(e){t.activeQuery.handleRowDescription(e)});e.on('dataRow',function(e){t.activeQuery.handleDataRow(e)});e.on('portalSuspended',function(){t.activeQuery.handlePortalSuspended(e)});e.on('emptyQuery',function(){t.activeQuery.handleEmptyQuery(e)});e.on('commandComplete',function(r){t.activeQuery.handleCommandComplete(r,e)});e.on('parseComplete',function(){if(t.activeQuery.name){e.parsedStatements[t.activeQuery.name]=true}});e.on('copyInResponse',function(){t.activeQuery.handleCopyInResponse(t.connection)});e.on('copyData',function(e){t.activeQuery.handleCopyData(e,t.connection)});e.on('notification',function(e){t.emit('notification',e)})};c.prototype.getStartupConf=function(){var e=this.connectionParameters,t={user:e.user,database:e.database},r=e.application_name||e.fallback_application_name;if(r){t.application_name=r}if(e.replication){t.replication=''+e.replication}if(e.statement_timeout){t.statement_timeout=String(parseInt(e.statement_timeout,10))}return t};c.prototype.cancel=function(e,t){if(e.activeQuery===t){var r=this.connection;if(this.host&&0===this.host.indexOf('/')){r.connect(this.host+'/.s.PGSQL.'+this.port)}else{r.connect(this.port,this.host)}r.on('connect',function(){r.cancel(e.processID,e.secretKey)})}else if(-1!==e.queryQueue.indexOf(t)){e.queryQueue.splice(e.queryQueue.indexOf(t),1)}};c.prototype.setTypeParser=function(e,t,r){return this._types.setTypeParser(e,t,r)};c.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)};c.prototype.escapeIdentifier=function(e){for(var t='"',r=0,n;r<e.length;r++){n=e[r];if('"'===n){t+=n+n}else{t+=n}}t+='"';return t};c.prototype.escapeLiteral=function(e){for(var t=false,r='\'',n=0,o;n<e.length;n++){o=e[n];if('\''===o){r+=o+o}else if('\\'===o){r+=o+o;t=true}else{r+=o}}r+='\'';if(true===t){r=' E'+r}return r};c.prototype._pulseQueryQueue=function(){if(true===this.readyForQuery){this.activeQuery=this.queryQueue.shift();if(this.activeQuery){this.readyForQuery=false;this.hasExecuted=true;this.activeQuery.submit(this.connection)}else if(this.hasExecuted){this.activeQuery=null;this.emit('drain')}}};c.prototype.query=function(e,t,r){var n,o;if('function'===typeof e.submit){o=n=e;if('function'===typeof t){n.callback=n.callback||t}}else{n=new l(e,t,r);if(!n.callback){let e,t;o=new Promise((r,n)=>{e=r;t=n});n.callback=(r,n)=>r?t(r):e(n)}}if(this.binary&&!n.binary){n.binary=true}if(n._result){n._result._getTypeParser=this._types.getTypeParser.bind(this._types)}this.queryQueue.push(n);this._pulseQueryQueue();return o};c.prototype.end=function(e){this._ending=true;if(this.activeQuery){this.connection.stream.destroy(new Error('Connection terminated by user'));return e?e():Promise.resolve()}if(e){this.connection.end();this.connection.once('end',e)}else{return new global.Promise((e)=>{this.connection.end();this.connection.once('end',e)})}};c.Query=l;e.exports=c},function(e,t,r){var l=r(15),d=r(16),c=r(29),u=r(30),m=r(32);function n(e){return function(t){if(null===t)return t;return e(t)}}function o(e){if(null===e)return e;return'TRUE'===e||'t'===e||'true'===e||'y'===e||'yes'===e||'on'===e||'1'===e}function s(e){if(!e)return null;return l.parse(e,o)}function a(e){return parseInt(e,10)}function i(e){if(!e)return null;return l.parse(e,n(a))}function p(e){if(!e)return null;return l.parse(e,n(function(e){return E(e).trim()}))}var y=function(e){if(!e){return null}var t=d.create(e,function(e){if(null!==e){e=I(e)}return e});return t.parse()},f=function(e){if(!e){return null}var t=d.create(e,function(e){if(null!==e){e=parseFloat(e)}return e});return t.parse()},_=function(e){if(!e){return null}var t=d.create(e);return t.parse()},h=function(e){if(!e){return null}var t=d.create(e,function(e){if(null!==e){e=c(e)}return e});return t.parse()},g=function(e){if(!e){return null}return l.parse(e,n(m))},b=function(e){return parseInt(e,10)},E=function(e){var t=String(e);if(/^\d+$/.test(t)){return t}return e},T=function(e){var t=_(e);if(!t){return t}return t.map(function(e){return JSON.parse(e)})},I=function(e){if('('!==e[0]){return null}e=e.substring(1,e.length-1).split(',');return{x:parseFloat(e[0]),y:parseFloat(e[1])}},S=function(e){if('<'!==e[0]&&'('!==e[1]){return null}for(var t='(',r='',n=false,o=2;o<e.length-1;o++){if(!n){t+=e[o]}if(')'===e[o]){n=true;continue}else if(!n){continue}if(','===e[o]){continue}r+=e[o]}var s=I(t);s.radius=parseFloat(r);return s};e.exports={init:function(e){e(20,E);e(21,b);e(23,b);e(26,b);e(700,parseFloat);e(701,parseFloat);e(16,o);e(1082,c);e(1114,c);e(1184,c);e(600,I);e(651,_);e(718,S);e(1e3,s);e(1001,g);e(1005,i);e(1007,i);e(1028,i);e(1016,p);e(1017,y);e(1021,f);e(1022,f);e(1231,f);e(1014,_);e(1015,_);e(1008,_);e(1009,_);e(1040,_);e(1041,_);e(1115,h);e(1182,h);e(1185,h);e(1186,u);e(17,m);e(114,JSON.parse.bind(JSON));e(3802,JSON.parse.bind(JSON));e(199,T);e(3807,T);e(3907,_);e(2951,_);e(791,_);e(1183,_);e(1270,_)}}},function(e){'use strict';var n=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?/,o=/^(\d{1,})-(\d{2})-(\d{2})$/,s=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,a=/BC$/,i=/^-?infinity$/;e.exports=function(e){if(i.test(e)){return Number(e.replace('i','I'))}var s=n.exec(e);if(!s){return o.test(e)?t(e):null}var p=a.test(e),l=parseInt(s[1],10),d=0<l&&100>l;l=(p?'-':'')+l;var c=parseInt(s[2],10)-1,u=s[3],m=parseInt(s[4],10),y=parseInt(s[5],10),f=parseInt(s[6],10),_=s[7];_=_?1e3*parseFloat(_):0;var h,g=r(e);if(null!=g){var b=Date.UTC(l,c,u,m,y,f,_);h=new Date(b-g)}else{h=new Date(l,c,u,m,y,f,_)}if(d){h.setUTCFullYear(l)}return h};function t(e){var t=o.exec(e),r=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=t[3],a=new Date(r,n,s);a.setFullYear(r);return a}function r(e){var t=s.exec(e.split(' ')[1]);if(!t)return;var r=t[1];if('Z'===r){return 0}var n='-'===r?-1:1,o=3600*parseInt(t[2],10)+60*parseInt(t[3]||0,10)+parseInt(t[4]||0,10);return 1e3*(o*n)}},function(e,t,r){'use strict';var a=r(31);e.exports=n;function n(e){if(!(this instanceof n)){return new n(e)}a(this,s(e))}var i=['seconds','minutes','hours','days','months','years'];n.prototype.toPostgres=function(){var e=i.filter(this.hasOwnProperty,this);if(this.milliseconds&&0>e.indexOf('seconds')){e.push('seconds')}if(0===e.length)return'0';return e.map(function(e){var t=this[e]||0;if('seconds'===e&&this.milliseconds){t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,'')}return t+' '+e},this).join(' ')};var p={years:'Y',months:'M',days:'D',hours:'H',minutes:'M',seconds:'S'},l=['years','months','days'],d=['hours','minutes','seconds'];n.prototype.toISO=function(){var t=l.map(e,this).join(''),r=d.map(e,this).join('');return'P'+t+'T'+r;function e(e){var t=this[e]||0;if('seconds'===e&&this.milliseconds){t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,'')}return t+p[e]}};var c='([+-]?\\d+)',u=new RegExp([c+'\\s+years?',c+'\\s+mons?',c+'\\s+days?','([+-])?([\\d]*):(\\d\\d):(\\d\\d).?(\\d{1,6})?'].map(function(e){return'('+e+')?'}).join('\\s*')),m={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},y=['hours','minutes','seconds','milliseconds'];function o(e){var t=e+'000000'.slice(e.length);return parseInt(t,10)/1e3}function s(e){if(!e)return{};var t=u.exec(e),r='-'===t[8];return Object.keys(m).reduce(function(e,n){var s=m[n],a=t[s];if(!a)return e;a='milliseconds'===n?o(a):parseInt(a,10);if(!a)return e;if(r&&~y.indexOf(n)){a*=-1}e[n]=a;return e},{})}},function(e){e.exports=function(e){for(var r=1,n;r<arguments.length;r++){n=arguments[r];for(var o in n){if(t.call(n,o)){e[o]=n[o]}}}return e};var t=Object.prototype.hasOwnProperty},function(e){'use strict';var t=Math.floor;e.exports=function(e){if(/^\\x/.test(e)){return new Buffer(e.substr(2),'hex')}var r='',n=0;while(n<e.length){if('\\'!==e[n]){r+=e[n];++n}else{if(/[0-7]{3}/.test(e.substr(n+1,3))){r+=String.fromCharCode(parseInt(e.substr(n+1,3),8));n+=4}else{var o=1;while(n+o<e.length&&'\\'===e[n+o]){o++}for(var s=0;s<t(o/2);++s){r+='\\'}n+=2*t(o/2)}}}return new Buffer(r,'binary')}},function(e){var t=Math.pow,r=function(e,r,n,o,s){n=n||0;o=o||false;s=s||function(e,r,n){return e*t(2,n)+r};var a=n>>3,p=function(e){if(o){return 255&~e}return e},l=255,d=8-n%8;if(r<d){l=255&255<<8-r;d=r}if(n){l=l>>n%8}var c=0;if(8<=n%8+r){c=s(0,p(e[a])&l,d)}for(var u=r+n>>3,m=a+1;m<u;m++){c=s(c,p(e[m]),8)}var i=(r+n)%8;if(0<i){c=s(c,p(e[u])>>8-i,i)}return c},n=function(e,n,o){var s=t(2,o-1)-1,a=r(e,1),i=r(e,o,1);if(0===i){return 0}var p=1,l=r(e,n,o+1,false,function(e,t,r){if(0===e){e=1}for(var n=1;n<=r;n++){p/=2;if(0<(t&1<<r-n)){e+=p}}return e});if(i==t(2,o+1)-1){if(0===l){return 0===a?Infinity:-Infinity}return NaN}return(0===a?1:-1)*t(2,i-s)*l},o=function(e){if(1==r(e,1)){return-1*(r(e,15,1,true)+1)}return r(e,15,1)},s=function(e){if(1==r(e,1)){return-1*(r(e,31,1,true)+1)}return r(e,31,1)},a=function(e){return n(e,23,8)},i=function(e){return n(e,52,11)},p=function(e){var n=r(e,16,32);if(49152==n){return NaN}for(var o=t(1e4,r(e,16,16)),s=0,a=r(e,16),p=0;p<a;p++){s+=r(e,16,64+16*p)*o;o/=1e4}var i=t(10,r(e,16,48));return(0===n?1:-1)*Math.round(s*i)/i},l=function(e,t){var n=r(t,1),o=r(t,63,1),s=new Date((0===n?1:-1)*o/1e3+9.466848e11);if(!e){s.setTime(s.getTime()+6e4*s.getTimezoneOffset())}s.usec=o%1e3;s.getMicroSeconds=function(){return this.usec};s.setMicroSeconds=function(e){this.usec=e};s.getUTCMicroSeconds=function(){return this.usec};return s},d=function(e){for(var t=r(e,32),n=r(e,32,32),o=r(e,32,64),s=96,a=[],p=0;p<t;p++){a[p]=r(e,32,s);s+=32;s+=32}var l=function(t){var n=r(e,32,s);s+=32;if(4294967295==n){return null}var o;if(23==t||20==t){o=r(e,8*n,s);s+=8*n;return o}else if(25==t){o=e.toString(this.encoding,s>>3,(s+=n<<3)>>3);return o}else{console.log('ERROR: ElementType not implemented: '+t)}},d=function(e,t){var r=[],n;if(1<e.length){var o=e.shift();for(n=0;n<o;n++){r[n]=d(e,t)}e.unshift(o)}else{for(n=0;n<e[0];n++){r[n]=l(t)}}return r};return d(a,o)},c=function(e){return e.toString('utf8')},u=function(e){if(null===e)return null;return 0<r(e,8)};e.exports={init:function(e){e(21,o);e(23,s);e(26,s);e(1700,p);e(700,a);e(701,i);e(16,u);e(1114,l.bind(null,false));e(1184,l.bind(null,true));e(1e3,d);e(1007,d);e(1016,d);e(1008,d);e(1009,d);e(25,c)}}},function(e,t,r){'use strict';var n=r(9),o=r(35),s=r(36);e.exports=function(e,t){var r=s.getFileName();o.stat(r,function(n,a){if(n||!s.usePgPass(a,r)){return t(undefined)}var i=o.createReadStream(r);s.getPassword(e,i,t)})};e.exports.warnTo=s.warnTo},function(e){e.exports=require('fs')},function(e,t,r){'use strict';var s=r(9),a=r(13).Stream,i=r(37),p=r(0),l='win32'===process.platform,d=process.stderr;function n(e){return(e&61440)==32768}var c=['host','port','database','user','password'],u=c.length,m=c[u-1];function o(){var e=d instanceof a&&true===d.writable;if(e){var t=Array.prototype.slice.call(arguments).concat('\n');d.write(p.format.apply(p,t))}}Object.defineProperty(e.exports,'isWin',{get:function(){return l},set:function(e){l=e}});e.exports.warnTo=function(e){var t=d;d=e;return t};e.exports.getFileName=function(e){e=e||process.env;var t=e.PGPASSFILE||(l?s.join(e.APPDATA,'postgresql','pgpass.conf'):s.join(e.HOME,'.pgpass'));return t};e.exports.usePgPass=function(e,t){if(Object.prototype.hasOwnProperty.call(process.env,'PGPASSWORD')){return false}if(l){return true}t=t||'<unkn>';if(!n(e.mode)){o('WARNING: password file "%s" is not a plain file',t);return false}if(e.mode&(56|7)){o('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',t);return false}return true};var y=e.exports.match=function(e,t){return c.slice(0,-1).reduce(function(r,n,o){if(1==o){if(Number(e[n]||5432)===Number(t[n])){return r&&true}}return r&&('*'===t[n]||t[n]===e[n])},true)};e.exports.getPassword=function(e,t,r){var n,s=t.pipe(new i);var a=function(e){t.destroy();o('WARNING: error on reading file: %s',e);r(undefined)};t.on('error',a);s.on('data',function(t){var r=f(t);if(r&&_(r)&&y(e,r)){n=r[m];s.end()}}).on('end',function(){t.destroy();r(n)}).on('error',a)};var f=e.exports.parseLine=function(e){if(11>e.length||e.match(/^\s+#/)){return null}for(var t='',r='',n=0,o=0,s={},a=false,p=function(t,r,n){var o=e.substring(r,n);if(!Object.hasOwnProperty.call(process.env,'PGPASS_NO_DEESCAPE')){o=o.replace(/\\([:\\])/g,'$1')}s[c[t]]=o},l=0;l<e.length-1;l+=1){t=e.charAt(l+1);r=e.charAt(l);a=n==u-1;if(a){p(n,o);break}if(0<=l&&':'==t&&'\\'!==r){p(n,o,l+1);o=l+2;n+=1}}s=Object.keys(s).length===u?s:null;return s},_=e.exports.isValidEntry=function(e){for(var t={0:function(e){return 0<e.length},1:function(e){if('*'===e){return true}e=Number(e);return isFinite(e)&&0<e&&9007199254740992>e&&Math.floor(e)===e},2:function(e){return 0<e.length},3:function(e){return 0<e.length},4:function(e){return 0<e.length}},r=0;r<c.length;r+=1){var n=t[r],o=e[c[r]]||'',s=n(o);if(!s){return false}}return true}},function(e,t,r){var n=r(38),o=r(14).StringDecoder;e.exports=function(e,t,r){var i=new o,p='',l=r&&r.maxLength,d=r&&false===r.trailing?false:true;if('function'===typeof e)t=e,e=null;if(!e)e=/\r?\n/;function s(e,r){if(t){try{r=t(r)}catch(t){return e.emit('error',t)}if('undefined'!==typeof r)e.queue(r)}else e.queue(r)}function a(t,r){var n=((null!=p?p:'')+r).split(e);p=n.pop();if(l&&p.length>l)return t.emit('error',new Error('maximum buffer reached'));for(var o=0,a;o<n.length;o++){a=n[o];s(t,a)}}return n(function(e){a(this,i.write(e))},function(){if(i.end)a(this,i.end());if(d&&null!=p)s(this,p);this.queue(null)})}},function(e,t,r){var o=r(13);t=e.exports=n;n.through=n;function n(e,t,r){e=e||function(e){this.queue(e)};t=t||function(){this.queue(null)};var a=false,i=false,p=[],l=false,d=new o;d.readable=d.writable=true;d.paused=false;d.autoDestroy=!(r&&false===r.autoDestroy);d.write=function(t){e.call(this,t);return!d.paused};function n(){while(p.length&&!d.paused){var e=p.shift();if(null===e)return d.emit('end');else d.emit('data',e)}}d.queue=d.push=function(e){if(l)return d;if(null===e)l=true;p.push(e);n();return d};d.on('end',function(){d.readable=false;if(!d.writable&&d.autoDestroy)process.nextTick(function(){d.destroy()})});function s(){d.writable=false;t.call(d);if(!d.readable&&d.autoDestroy)d.destroy()}d.end=function(e){if(a)return;a=true;if(arguments.length)d.write(e);s();return d};d.destroy=function(){if(i)return;i=true;a=true;p.length=0;d.writable=d.readable=false;d.emit('close');return d};d.pause=function(){if(d.paused)return;d.paused=true;return d};d.resume=function(){if(d.paused){d.paused=false;d.emit('resume')}n();if(!d.paused)d.emit('drain');return d};return d}},function(e){e.exports=require('dns')},function(e,t,r){'use strict';var n=r(25);e.exports={parse:function(e){var t;if('/'===e.charAt(0)){t=e.split(' ');return{host:t[0],database:t[1]}}if(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(e)){e=encodeURI(e).replace(/\%25(\d\d)/g,'%$1')}var r=n.parse(e,true);t={};if(r.query.application_name){t.application_name=r.query.application_name}if(r.query.fallback_application_name){t.fallback_application_name=r.query.fallback_application_name}t.port=r.port;if('socket:'==r.protocol){t.host=decodeURI(r.pathname);t.database=r.query.db;t.client_encoding=r.query.encoding;return t}t.host=r.hostname;var o=r.pathname;if(o&&'/'===o.charAt(0)){o=r.pathname.slice(1)||null}t.database=o&&decodeURI(o);var s=(r.auth||':').split(':');t.user=s[0];t.password=s.splice(1).join(':');var a=r.query.ssl;if('true'===a||'1'===a){t.ssl=true}return t}}},function(e,t,r){'use strict';var n=r(3).EventEmitter,o=r(0),s=r(42),a=r(11),i=function(e,t,r){if(!(this instanceof i)){return new i(e,t,r)}e=a.normalizeQueryConfig(e,t,r);this.text=e.text;this.values=e.values;this.rows=e.rows;this.types=e.types;this.name=e.name;this.binary=e.binary;this.stream=e.stream;this.portal=e.portal||'';this.callback=e.callback;this._rowMode=e.rowMode;if(process.domain&&e.callback){this.callback=process.domain.bind(e.callback)}this._result=new s(this._rowMode,this.types);this._results=this._result;this.isPreparedStatement=false;this._canceledDueToError=false;this._promise=null;n.call(this)};o.inherits(i,n);i.prototype.requiresPreparation=function(){if(this.name){return true}if(this.rows){return true}if(!this.text){return false}if(!this.values){return false}return 0<this.values.length};i.prototype._checkForMultirow=function(){if(this._result.command){if(!Array.isArray(this._results)){this._results=[this._result]}this._result=new s(this._rowMode,this.types);this._results.push(this._result)}};i.prototype.handleRowDescription=function(e){this._checkForMultirow();this._result.addFields(e.fields);this._accumulateRows=this.callback||!this.listeners('row').length};i.prototype.handleDataRow=function(e){var t;if(this._canceledDueToError){return}try{t=this._result.parseRow(e.fields)}catch(e){this._canceledDueToError=e;return}this.emit('row',t,this._result);if(this._accumulateRows){this._result.addRow(t)}};i.prototype.handleCommandComplete=function(e,t){this._checkForMultirow();this._result.addCommandComplete(e);if(this.isPreparedStatement){t.sync()}};i.prototype.handleEmptyQuery=function(e){if(this.isPreparedStatement){e.sync()}};i.prototype.handleReadyForQuery=function(e){if(this._canceledDueToError){return this.handleError(this._canceledDueToError,e)}if(this.callback){this.callback(null,this._results)}this.emit('end',this._results)};i.prototype.handleError=function(e,t){if(this.isPreparedStatement){t.sync()}if(this._canceledDueToError){e=this._canceledDueToError;this._canceledDueToError=false}if(this.callback){return this.callback(e)}this.emit('error',e)};i.prototype.submit=function(e){if('string'!==typeof this.text&&'string'!==typeof this.name){const t=new Error('A query must have either text or a name. Supplying neither is unsupported.');e.emit('error',t);e.emit('readyForQuery');return}if(this.values&&!Array.isArray(this.values)){const t=new Error('Query values must be an array');e.emit('error',t);e.emit('readyForQuery');return}if(this.requiresPreparation()){this.prepare(e)}else{e.query(this.text)}};i.prototype.hasBeenParsed=function(e){return this.name&&e.parsedStatements[this.name]};i.prototype.handlePortalSuspended=function(e){this._getRows(e,this.rows)};i.prototype._getRows=function(e,t){e.execute({portal:this.portalName,rows:t},true);e.flush()};i.prototype.prepare=function(e){var t=this;this.isPreparedStatement=true;if(!this.hasBeenParsed(e)){e.parse({text:t.text,name:t.name,types:t.types},true)}if(t.values){t.values=t.values.map(a.prepareValue)}e.bind({portal:t.portalName,statement:t.name,values:t.values,binary:t.binary},true);e.describe({type:'P',name:t.portalName||''},true);this._getRows(e,this.rows)};i.prototype.handleCopyInResponse=function(e){if(this.stream)this.stream.startStreamingToConnection(e);else e.sendCopyFail('No source stream defined')};i.prototype.handleCopyData=function(e){var t=e.chunk;if(this.stream){this.stream.handleChunk(t)}};e.exports=i},function(e,t,r){'use strict';var n=r(5),o=r(43),s=function(e){this.command=null;this.rowCount=null;this.oid=null;this.rows=[];this.fields=[];this._parsers=[];this.RowCtor=null;this.rowAsArray='array'===e;if(this.rowAsArray){this.parseRow=this._parseRowAsArray}},a=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/;s.prototype.addCommandComplete=function(e){var t;if(e.text){t=a.exec(e.text)}else{t=a.exec(e.command)}if(t){this.command=t[1];if(t[3]){this.oid=parseInt(t[2],10);this.rowCount=parseInt(t[3],10)}else if(t[2]){this.rowCount=parseInt(t[2],10)}}};s.prototype._parseRowAsArray=function(e){for(var t=[],r=0,n=e.length,o;r<n;r++){o=e[r];if(null!==o){t.push(this._parsers[r](o))}else{t.push(null)}}return t};s.prototype.parseRow=function(e){return new this.RowCtor(this._parsers,e)};s.prototype.addRow=function(e){this.rows.push(e)};var p=function(e,t){return'\nthis[\''+o(e)+'\'] = rowData['+t+'] == null ? null : parsers['+t+'](rowData['+t+']);'};s.prototype.addFields=function(e){if(this.fields.length){this.fields=[];this._parsers=[]}for(var t='',r=0,n;r<e.length;r++){n=e[r];this.fields.push(n);var o=this._getTypeParser(n.dataTypeID,n.format||'text');this._parsers.push(o);t+=p(n.name,r)}if(!this.rowAsArray){this.RowCtor=Function('parsers','rowData',t)}};s.prototype._getTypeParser=n.getTypeParser;e.exports=s},function(e){e.exports=function(e){return(''+e).replace(/["'\\\n\r\u2028\u2029]/g,function(e){switch(e){case'"':case'\'':case'\\':return'\\'+e;case'\n':return'\\n';case'\r':return'\\r';case'\u2028':return'\\u2028';case'\u2029':return'\\u2029';}})}},function(e){e.exports=require('net')},function(e){var t=e.exports=function(e){this.size=e||1024;this.buffer=Buffer(this.size+5);this.offset=5;this.headerPosition=0};t.prototype._ensure=function(e){var t=this.buffer.length-this.offset;if(t<e){var r=this.buffer,n=r.length+(r.length>>1)+e;this.buffer=new Buffer(n);r.copy(this.buffer)}};t.prototype.addInt32=function(e){this._ensure(4);this.buffer[this.offset++]=255&e>>>24;this.buffer[this.offset++]=255&e>>>16;this.buffer[this.offset++]=255&e>>>8;this.buffer[this.offset++]=255&e>>>0;return this};t.prototype.addInt16=function(e){this._ensure(2);this.buffer[this.offset++]=255&e>>>8;this.buffer[this.offset++]=255&e>>>0;return this};var r=function(e,t,r,n){e.write(t,r,n)};if(3===Buffer.prototype.write.length){r=function(e,t,r){e.write(t,r)}}t.prototype.addCString=function(e){if(!e){this._ensure(1)}else{var t=Buffer.byteLength(e);this._ensure(t+1);r(this.buffer,e,this.offset,t);this.offset+=t}this.buffer[this.offset++]=0;return this};t.prototype.addChar=function(e){this._ensure(1);r(this.buffer,e,this.offset,1);this.offset++;return this};t.prototype.addString=function(e){e=e||'';var t=Buffer.byteLength(e);this._ensure(t);this.buffer.write(e,this.offset);this.offset+=t;return this};t.prototype.getByteLength=function(){return this.offset-5};t.prototype.add=function(e){this._ensure(e.length);e.copy(this.buffer,this.offset);this.offset+=e.length;return this};t.prototype.clear=function(){this.offset=5;this.headerPosition=0;this.lastEnd=0};t.prototype.addHeader=function(e,t){var r=this.offset;this.offset=this.headerPosition;this.buffer[this.offset++]=e;this.addInt32(r-(this.headerPosition+1));this.headerPosition=r;this.offset=r;if(!t){this._ensure(5);this.offset+=5}};t.prototype.join=function(e){if(e){this.addHeader(e,true)}return this.buffer.slice(e?0:5,this.offset)};t.prototype.flush=function(e){var t=this.join(e);this.clear();return t}},function(e,t,r){var n=r(20),o=e.exports=function(e){if('number'==typeof e){e={headerSize:e}}e=e||{};this.offset=0;this.lastChunk=false;this.chunk=null;this.chunkLength=0;this.headerSize=e.headerSize||0;this.lengthPadding=e.lengthPadding||0;this.header=null;n(2>this.headerSize,'pre-length header of more than 1 byte length not currently supported')};o.prototype.addChunk=function(e){if(!this.chunk||this.offset===this.chunkLength){this.chunk=e;this.chunkLength=e.length;this.offset=0;return}var t=e.length,r=this.chunkLength+t;if(r>this.chunk.length){var n=2*this.chunk.length;while(r>=n){n*=2}var o=new Buffer(n);this.chunk.copy(o);this.chunk=o}e.copy(this.chunk,this.chunkLength);this.chunkLength=r};o.prototype.read=function(){if(this.chunkLength<this.headerSize+4+this.offset){return false}if(this.headerSize){this.header=this.chunk[this.offset]}var e=this.chunk.readUInt32BE(this.offset+this.headerSize)+this.lengthPadding,t=this.chunkLength-(this.offset+4+this.headerSize);if(e>t){return false}this.offset+=this.headerSize+4;var r=this.chunk.slice(this.offset,this.offset+e);this.offset+=e;return r}},function(e){e.exports=require('tls')},function(e,t,r){'use strict';const a=r(3).EventEmitter,i=function(){},p=(e,t)=>{const r=e.findIndex(t);return-1===r?undefined:e.splice(r,1)[0]};class l{constructor(e,t){this.client=e;this.timeoutId=t}}function n(){throw new Error('Release called on client which has already been released to the pool.')}function o(e,t){e.release=n;if(t||this.ending){this._remove(e);this._pulseQueue();return}let r;if(this.options.idleTimeoutMillis){r=setTimeout(()=>{this.log('remove idle client');this._remove(e)},this.options.idleTimeoutMillis)}this._idle.push(new l(e,r));this._pulseQueue()}function s(e,t){if(t){return{callback:t,result:undefined}}let r,n;const o=new e(function(e,t){n=e;r=t});return{callback:function(e,t){e?r(e):n(t)},result:o}}class d extends a{constructor(e,t){super();this.options=Object.assign({},e);this.options.max=this.options.max||this.options.poolSize||10;this.log=this.options.log||function(){};this.Client=this.options.Client||t||r(10).Client;this.Promise=this.options.Promise||global.Promise;if('undefined'===typeof this.options.idleTimeoutMillis){this.options.idleTimeoutMillis=1e4}this._clients=[];this._idle=[];this._pendingQueue=[];this._endCallback=undefined;this.ending=false}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){this.log('pulse queue');if(this.ending){this.log('pulse queue on ending');if(this._idle.length){this._idle.slice().map((e)=>{this._remove(e.client)})}if(!this._clients.length){this._endCallback()}return}if(!this._pendingQueue.length){this.log('no queued requests');return}if(!this._idle.length&&this._isFull()){return}const e=this._pendingQueue.shift();if(this._idle.length){const t=this._idle.pop();clearTimeout(t.timeoutId);const r=t.client;r.release=o.bind(this,r);this.emit('acquire',r);return e(undefined,r,r.release)}if(!this._isFull()){return this.connect(e)}throw new Error('unexpected condition')}_remove(e){const t=p(this._idle,(t)=>t.client===e);if(t!==undefined){clearTimeout(t.timeoutId)}this._clients=this._clients.filter((t)=>t!==e);e.end();this.emit('remove',e)}connect(e){if(this.ending){const t=new Error('Cannot use a pool after calling end on the pool');return e?e(t):this.Promise.reject(t)}if(this._clients.length>=this.options.max||this._idle.length){const t=s(this.Promise,e),r=t.result;if(this._idle.length){process.nextTick(()=>this._pulseQueue())}if(!this.options.connectionTimeoutMillis){this._pendingQueue.push(t.callback);return r}const n=setTimeout(()=>{this._pendingQueue=this._pendingQueue.filter((e)=>e===t.callback);t.callback(new Error('timeout exceeded when trying to connect'))},this.options.connectionTimeoutMillis);this._pendingQueue.push(function(e,r,o){clearTimeout(n);t.callback(e,r,o)});return r}const t=new this.Client(this.options);this._clients.push(t);const r=(e)=>{e.client=t;t.removeListener('error',r);t.on('error',()=>{this.log('additional client error after disconnection due to error',e)});this._remove(t);this.emit('error',e,t)};this.log('connecting new client');let n,a=false;if(this.options.connectionTimeoutMillis){n=setTimeout(()=>{this.log('ending client due to timeout');a=true;t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)}const p=s(this.Promise,e);e=p.callback;this.log('connecting new client');t.connect((s)=>{this.log('new client connected');if(n){clearTimeout(n)}t.on('error',r);if(s){this._clients=this._clients.filter((e)=>e!==t);if(a){s.message='Connection terminiated due to connection timeout'}e(s,undefined,i)}else{t.release=o.bind(this,t);this.emit('connect',t);this.emit('acquire',t);if(this.options.verify){this.options.verify(t,e)}else{e(undefined,t,t.release)}}});return p.result}query(e,t,r){if('function'===typeof e){const t=s(this.Promise,e);setImmediate(function(){return t.callback(new Error('Passing a function as the first parameter to pool.query is not supported'))});return t.result}if('function'===typeof t){r=t;t=undefined}const n=s(this.Promise,r);r=n.callback;this.connect((n,o)=>{if(n){return r(n)}this.log('dispatching query');o.query(e,t,(e,t)=>{this.log('query dispatched');o.release(e);if(e){return r(e)}else{return r(undefined,t)}})});return n.result}end(e){this.log('ending');if(this.ending){const t=new Error('Called end on pool more than once');return e?e(t):this.Promise.reject(t)}this.ending=true;const t=s(this.Promise,e);this._endCallback=t.callback;this._pulseQueue();return t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get totalCount(){return this._clients.length}}e.exports=d},function(e,t,r){'use strict';var n=r(!function(){var t=new Error('Cannot find module "pg-native"');t.code='MODULE_NOT_FOUND';throw t}()),o=r(17),s=r(50),a=r(51),i=r(20),p=r(3).EventEmitter,l=r(0),d=r(18),c='Version >= '+a.minNativeVersion+' of pg-native required.';i(s.gte(n.version,a.minNativeVersion),c);var u=r(52),m=e.exports=function(e){p.call(this);e=e||{};this._types=new o(e.types);this.native=new n({types:this._types});this._queryQueue=[];this._connected=false;this._connecting=false;var t=this.connectionParameters=new d(e);this.user=t.user;this.password=t.password;this.database=t.database;this.host=t.host;this.port=t.port;this.namedQueries={}};m.Query=u;l.inherits(m,p);m.prototype.connect=function(e){var t=this,r=function(r){if(e)return e(r);return t.emit('error',r)},n;if(!e){var o,s;e=(e)=>e?s(e):o();n=new global.Promise(function(e,t){o=e;s=t})}if(this._connecting){process.nextTick(()=>e(new Error('Client has already been connected. You cannot reuse a client.')));return n}this._connecting=true;this.connectionParameters.getLibpqConnectionString(function(n,o){if(n)return r(n);t.native.connect(o,function(n){if(n)return r(n);t._connected=true;t.native.on('error',function(e){if(t._activeQuery&&'end'!==t._activeQuery.state){return}t.emit('error',e)});t.native.on('notification',function(e){t.emit('notification',{channel:e.relname,payload:e.extra})});t.emit('connect');t._pulseQueryQueue(true);if(e)e()})});return n};m.prototype.query=function(e,t,r){if('function'===typeof e.submit){if('function'===typeof t){e.callback=t}this._queryQueue.push(e);this._pulseQueryQueue();return e}var n=new u(e,t,r),o;if(!n.callback){let e,t;o=new Promise((r,n)=>{e=r;t=n});n.callback=(r,n)=>r?t(r):e(n)}this._queryQueue.push(n);this._pulseQueryQueue();return o};m.prototype.end=function(e){var t=this;if(!this._connected){this.once('connect',this.end.bind(this,e))}var r;if(!e){var n,o;e=(e)=>e?o(e):n();r=new global.Promise(function(e,t){n=e;o=t})}this.native.end(function(){if(t._hasActiveQuery()){t._queryQueue.length=0;t._activeQuery.handleError(new Error('Connection terminated'))}t.emit('end');if(e)e()});return r};m.prototype._hasActiveQuery=function(){return this._activeQuery&&'error'!==this._activeQuery.state&&'end'!==this._activeQuery.state};m.prototype._pulseQueryQueue=function(e){if(!this._connected){return}if(this._hasActiveQuery()){return}var t=this._queryQueue.shift();if(!t){if(!e){this.emit('drain')}return}this._activeQuery=t;t.submit(this);var r=this;t.once('_done',function(){r._pulseQueryQueue()})};m.prototype.cancel=function(e){if(this._activeQuery===e){this.native.cancel(function(){})}else if(-1!==this._queryQueue.indexOf(e)){this._queryQueue.splice(this._queryQueue.indexOf(e),1)}};m.prototype.setTypeParser=function(e,t,r){return this._types.setTypeParser(e,t,r)};m.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)}},function(e,t,r){var L,D;if('object'===typeof e&&e.exports===t)t=e.exports=o;var w;if('object'===typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG))w=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift('SEMVER');console.log.apply(console,e)};else w=function(){};t.SEMVER_SPEC_VERSION='2.0.0';var U=256,M=Number.MAX_SAFE_INTEGER||9007199254740991,k=t.re=[],F=t.src=[],j=0,R=j++;F[R]='0|[1-9]\\d*';var V=j++;F[V]='[0-9]+';var Q=j++;F[Q]='\\d*[a-zA-Z-][a-zA-Z0-9-]*';var q=j++;F[q]='('+F[R]+')\\.('+F[R]+')\\.('+F[R]+')';var G=j++;F[G]='('+F[V]+')\\.('+F[V]+')\\.('+F[V]+')';var H=j++;F[H]='(?:'+F[R]+'|'+F[Q]+')';var B=j++;F[B]='(?:'+F[V]+'|'+F[Q]+')';var X=j++;F[X]='(?:-('+F[H]+'(?:\\.'+F[H]+')*))';var Y=j++;F[Y]='(?:-?('+F[B]+'(?:\\.'+F[B]+')*))';var z=j++;F[z]='[0-9A-Za-z-]+';var $=j++;F[$]='(?:\\+('+F[z]+'(?:\\.'+F[z]+')*))';var W=j++,K='v?'+F[q]+F[X]+'?'+F[$]+'?';F[W]='^'+K+'$';var Z='[v=\\s]*'+F[G]+F[Y]+'?'+F[$]+'?',J=j++;F[J]='^'+Z+'$';var ee=j++;F[ee]='((?:<|>)?=?)';var te=j++;F[te]=F[V]+'|x|X|\\*';var re=j++;F[re]=F[R]+'|x|X|\\*';var ne=j++;F[ne]='[v=\\s]*('+F[re]+')(?:\\.('+F[re]+')(?:\\.('+F[re]+')(?:'+F[X]+')?'+F[$]+'?)?)?';var oe=j++;F[oe]='[v=\\s]*('+F[te]+')(?:\\.('+F[te]+')(?:\\.('+F[te]+')(?:'+F[Y]+')?'+F[$]+'?)?)?';var se=j++;F[se]='^'+F[ee]+'\\s*'+F[ne]+'$';var ae=j++;F[ae]='^'+F[ee]+'\\s*'+F[oe]+'$';var ie=j++;F[ie]='(?:~>?)';var pe=j++;F[pe]='(\\s*)'+F[ie]+'\\s+';k[pe]=new RegExp(F[pe],'g');var le=j++;F[le]='^'+F[ie]+F[ne]+'$';var de=j++;F[de]='^'+F[ie]+F[oe]+'$';var ce=j++;F[ce]='(?:\\^)';var ue=j++;F[ue]='(\\s*)'+F[ce]+'\\s+';k[ue]=new RegExp(F[ue],'g');var me=j++;F[me]='^'+F[ce]+F[ne]+'$';var ye=j++;F[ye]='^'+F[ce]+F[oe]+'$';var fe=j++;F[fe]='^'+F[ee]+'\\s*('+Z+')$|^$';var _e=j++;F[_e]='^'+F[ee]+'\\s*('+K+')$|^$';var he=j++;F[he]='(\\s*)'+F[ee]+'\\s*('+Z+'|'+F[ne]+')';k[he]=new RegExp(F[he],'g');var ge=j++;F[ge]='^\\s*('+F[ne]+')\\s+-\\s+('+F[ne]+')\\s*$';var be=j++;F[be]='^\\s*('+F[oe]+')\\s+-\\s+('+F[oe]+')\\s*$';var Ee=j++;F[Ee]='(<|>)?=?\\s*\\*';for(var Te=0;Te<j;Te++){w(Te,F[Te]);if(!k[Te])k[Te]=new RegExp(F[Te])}t.parse=n;function n(e,t){if(e.length>U)return null;var n=t?k[J]:k[W];if(!n.test(e))return null;try{return new o(e,t)}catch(e){return null}}t.valid=function(e,t){var r=n(e,t);return r?r.version:null};t.clean=function(e,t){var r=n(e.trim().replace(/^[=v]+/,''),t);return r?r.version:null};t.SemVer=o;function o(e,t){if(e instanceof o){if(e.loose===t)return e;else e=e.version}else if('string'!==typeof e){throw new TypeError('Invalid Version: '+e)}if(e.length>U)throw new TypeError('version is longer than '+U+' characters');if(!(this instanceof o))return new o(e,t);w('SemVer',e,t);this.loose=t;var r=e.trim().match(t?k[J]:k[W]);if(!r)throw new TypeError('Invalid Version: '+e);this.raw=e;this.major=+r[1];this.minor=+r[2];this.patch=+r[3];if(this.major>M||0>this.major)throw new TypeError('Invalid major version');if(this.minor>M||0>this.minor)throw new TypeError('Invalid minor version');if(this.patch>M||0>this.patch)throw new TypeError('Invalid patch version');if(!r[4])this.prerelease=[];else this.prerelease=r[4].split('.').map(function(e){return /^[0-9]+$/.test(e)?+e:e});this.build=r[5]?r[5].split('.'):[];this.format()}o.prototype.format=function(){this.version=this.major+'.'+this.minor+'.'+this.patch;if(this.prerelease.length)this.version+='-'+this.prerelease.join('.');return this.version};o.prototype.inspect=function(){return'<SemVer "'+this+'">'};o.prototype.toString=function(){return this.version};o.prototype.compare=function(e){w('SemVer.compare',this.version,this.loose,e);if(!(e instanceof o))e=new o(e,this.loose);return this.compareMain(e)||this.comparePre(e)};o.prototype.compareMain=function(e){if(!(e instanceof o))e=new o(e,this.loose);return s(this.major,e.major)||s(this.minor,e.minor)||s(this.patch,e.patch)};o.prototype.comparePre=function(e){if(!(e instanceof o))e=new o(e,this.loose);if(this.prerelease.length&&!e.prerelease.length)return-1;else if(!this.prerelease.length&&e.prerelease.length)return 1;else if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];w('prerelease compare',t,r,n);if(r===undefined&&n===undefined)return 0;else if(n===undefined)return 1;else if(r===undefined)return-1;else if(r===n)continue;else return s(r,n)}while(++t)};o.prototype.inc=function(e,t){switch(e){case'premajor':this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc('pre',t);break;case'preminor':this.prerelease.length=0;this.patch=0;this.minor++;this.inc('pre',t);break;case'prepatch':this.prerelease.length=0;this.inc('patch',t);this.inc('pre',t);break;case'prerelease':if(0===this.prerelease.length)this.inc('patch',t);this.inc('pre',t);break;case'major':if(0!==this.minor||0!==this.patch||0===this.prerelease.length)this.major++;this.minor=0;this.patch=0;this.prerelease=[];break;case'minor':if(0!==this.patch||0===this.prerelease.length)this.minor++;this.patch=0;this.prerelease=[];break;case'patch':if(0===this.prerelease.length)this.patch++;this.prerelease=[];break;case'pre':if(0===this.prerelease.length)this.prerelease=[0];else{var r=this.prerelease.length;while(0<=--r){if('number'===typeof this.prerelease[r]){this.prerelease[r]++;r=-2}}if(-1===r)this.prerelease.push(0)}if(t){if(this.prerelease[0]===t){if(isNaN(this.prerelease[1]))this.prerelease=[t,0]}else this.prerelease=[t,0]}break;default:throw new Error('invalid increment argument: '+e);}this.format();return this};t.inc=function(e,t,r,n){if('string'===typeof r){n=r;r=undefined}try{return new o(e,r).inc(t,n).version}catch(e){return null}};t.diff=function(e,t){if(u(e,t)){return null}else{var r=n(e),o=n(t);if(r.prerelease.length||o.prerelease.length){for(var s in r){if('major'===s||'minor'===s||'patch'===s){if(r[s]!==o[s]){return'pre'+s}}}return'prerelease'}for(var s in r){if('major'===s||'minor'===s||'patch'===s){if(r[s]!==o[s]){return s}}}}};t.compareIdentifiers=s;var i=/^[0-9]+$/;function s(e,t){var r=i.test(e),n=i.test(t);if(r&&n){e=+e;t=+t}return r&&!n?-1:n&&!r?1:e<t?-1:e>t?1:0}t.rcompareIdentifiers=function(e,t){return s(t,e)};t.major=function(e,t){return new o(e,t).major};t.minor=function(e,t){return new o(e,t).minor};t.patch=function(e,t){return new o(e,t).patch};t.compare=p;function p(e,t,r){return new o(e,r).compare(t)}t.compareLoose=function(e,t){return p(e,t,true)};t.rcompare=l;function l(e,t,r){return p(t,e,r)}t.sort=function(e,r){return e.sort(function(e,n){return t.compare(e,n,r)})};t.rsort=function(e,r){return e.sort(function(e,n){return t.rcompare(e,n,r)})};t.gt=d;function d(e,t,r){return 0<p(e,t,r)}t.lt=c;function c(e,t,r){return 0>p(e,t,r)}t.eq=u;function u(e,t,r){return 0===p(e,t,r)}t.neq=m;function m(e,t,r){return 0!==p(e,t,r)}t.gte=y;function y(e,t,r){return 0<=p(e,t,r)}t.lte=f;function f(e,t,r){return 0>=p(e,t,r)}t.cmp=a;function a(e,t,r,n){var o;switch(t){case'===':if('object'===typeof e)e=e.version;if('object'===typeof r)r=r.version;o=e===r;break;case'!==':if('object'===typeof e)e=e.version;if('object'===typeof r)r=r.version;o=e!==r;break;case'':case'=':case'==':o=u(e,r,n);break;case'!=':o=m(e,r,n);break;case'>':o=d(e,r,n);break;case'>=':o=y(e,r,n);break;case'<':o=c(e,r,n);break;case'<=':o=f(e,r,n);break;default:throw new TypeError('Invalid operator: '+t);}return o}t.Comparator=_;function _(e,t){if(e instanceof _){if(e.loose===t)return e;else e=e.value}if(!(this instanceof _))return new _(e,t);w('comparator',e,t);this.loose=t;this.parse(e);if(this.semver===Ie)this.value='';else this.value=this.operator+this.semver.version;w('comp',this)}var Ie={};_.prototype.parse=function(e){var t=this.loose?k[fe]:k[_e],r=e.match(t);if(!r)throw new TypeError('Invalid comparator: '+e);this.operator=r[1];if('='===this.operator)this.operator='';if(!r[2])this.semver=Ie;else this.semver=new o(r[2],this.loose)};_.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'};_.prototype.toString=function(){return this.value};_.prototype.test=function(e){w('Comparator.test',e,this.loose);if(this.semver===Ie)return true;if('string'===typeof e)e=new o(e,this.loose);return a(e,this.operator,this.semver,this.loose)};t.Range=h;function h(e,t){if(e instanceof h&&e.loose===t)return e;if(!(this instanceof h))return new h(e,t);this.loose=t;this.raw=e;this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length});if(!this.set.length){throw new TypeError('Invalid SemVer Range: '+e)}this.format()}h.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'};h.prototype.format=function(){this.range=this.set.map(function(e){return e.join(' ').trim()}).join('||').trim();return this.range};h.prototype.toString=function(){return this.range};h.prototype.parseRange=function(e){var t=this.loose;e=e.trim();w('range',e,t);var r=t?k[be]:k[ge];e=e.replace(r,v);w('hyphen replace',e);e=e.replace(k[he],'$1$2$3');w('comparator trim',e,k[he]);e=e.replace(k[pe],'$1~');e=e.replace(k[ue],'$1^');e=e.split(/\s+/).join(' ');var n=t?k[fe]:k[_e],o=e.split(' ').map(function(e){return g(e,t)}).join(' ').split(/\s+/);if(this.loose){o=o.filter(function(e){return!!e.match(n)})}o=o.map(function(e){return new _(e,t)});return o};t.toComparators=function(e,t){return new h(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(' ').trim().split(' ')})};function g(e,t){w('comp',e);e=I(e,t);w('caret',e);e=E(e,t);w('tildes',e);e=O(e,t);w('xrange',e);e=N(e,t);w('stars',e);return e}function b(e){return!e||'x'===e.toLowerCase()||'*'===e}function E(e,t){return e.trim().split(/\s+/).map(function(e){return T(e,t)}).join(' ')}function T(e,t){var n=t?k[de]:k[le];return e.replace(n,function(t,r,n,o,s){w('tilde',e,t,r,n,o,s);var a;if(b(r))a='';else if(b(n))a='>='+r+'.0.0 <'+(+r+1)+'.0.0';else if(b(o))a='>='+r+'.'+n+'.0 <'+r+'.'+(+n+1)+'.0';else if(s){w('replaceTilde pr',s);if('-'!==s.charAt(0))s='-'+s;a='>='+r+'.'+n+'.'+o+s+' <'+r+'.'+(+n+1)+'.0'}else a='>='+r+'.'+n+'.'+o+' <'+r+'.'+(+n+1)+'.0';w('tilde return',a);return a})}function I(e,t){return e.trim().split(/\s+/).map(function(e){return S(e,t)}).join(' ')}function S(e,t){w('caret',e,t);var n=t?k[ye]:k[me];return e.replace(n,function(t,r,n,o,s){w('caret',e,t,r,n,o,s);var a;if(b(r))a='';else if(b(n))a='>='+r+'.0.0 <'+(+r+1)+'.0.0';else if(b(o)){if('0'===r)a='>='+r+'.'+n+'.0 <'+r+'.'+(+n+1)+'.0';else a='>='+r+'.'+n+'.0 <'+(+r+1)+'.0.0'}else if(s){w('replaceCaret pr',s);if('-'!==s.charAt(0))s='-'+s;if('0'===r){if('0'===n)a='>='+r+'.'+n+'.'+o+s+' <'+r+'.'+n+'.'+(+o+1);else a='>='+r+'.'+n+'.'+o+s+' <'+r+'.'+(+n+1)+'.0'}else a='>='+r+'.'+n+'.'+o+s+' <'+(+r+1)+'.0.0'}else{w('no pr');if('0'===r){if('0'===n)a='>='+r+'.'+n+'.'+o+' <'+r+'.'+n+'.'+(+o+1);else a='>='+r+'.'+n+'.'+o+' <'+r+'.'+(+n+1)+'.0'}else a='>='+r+'.'+n+'.'+o+' <'+(+r+1)+'.0.0'}w('caret return',a);return a})}function O(e,t){w('replaceXRanges',e,t);return e.split(/\s+/).map(function(e){return A(e,t)}).join(' ')}function A(e,t){e=e.trim();var n=t?k[ae]:k[se];return e.replace(n,function(t,r,n,o,s,a){w('xRange',e,t,r,n,o,s,a);var i=b(n),p=i||b(o),l=p||b(s),d=l;if('='===r&&d)r='';if(i){if('>'===r||'<'===r){t='<0.0.0'}else{t='*'}}else if(r&&d){if(p)o=0;if(l)s=0;if('>'===r){r='>=';if(p){n=+n+1;o=0;s=0}else if(l){o=+o+1;s=0}}else if('<='===r){r='<';if(p)n=+n+1;else o=+o+1}t=r+n+'.'+o+'.'+s}else if(p){t='>='+n+'.0.0 <'+(+n+1)+'.0.0'}else if(l){t='>='+n+'.'+o+'.0 <'+n+'.'+(+o+1)+'.0'}w('xRange return',t);return t})}function N(e,t){w('replaceStars',e,t);return e.trim().replace(k[Ee],'')}function v(e,t,r,n,o,s,a,i,p,l,d,c){if(b(r))t='';else if(b(n))t='>='+r+'.0.0';else if(b(o))t='>='+r+'.'+n+'.0';else t='>='+t;if(b(p))i='';else if(b(l))i='<'+(+p+1)+'.0.0';else if(b(d))i='<'+p+'.'+(+l+1)+'.0';else if(c)i='<='+p+'.'+l+'.'+d+'-'+c;else i='<='+i;return(t+' '+i).trim()}h.prototype.test=function(e){if(!e)return false;if('string'===typeof e)e=new o(e,this.loose);for(var t=0;t<this.set.length;t++){if(C(this.set[t],e))return true}return false};function C(e,t){for(var r=0;r<e.length;r++){if(!e[r].test(t))return false}if(t.prerelease.length){for(var r=0;r<e.length;r++){w(e[r].semver);if(e[r].semver===Ie)return true;if(0<e[r].semver.prerelease.length){var n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return true}}return false}return true}t.satisfies=x;function x(e,t,r){try{t=new h(t,r)}catch(e){return false}return t.test(e)}t.maxSatisfying=function(e,t,r){return e.filter(function(e){return x(e,t,r)}).sort(function(e,t){return l(e,t,r)})[0]||null};t.validRange=function(e,t){try{return new h(e,t).range||'*'}catch(e){return null}};t.ltr=function(e,t,r){return P(e,t,'<',r)};t.gtr=function(e,t,r){return P(e,t,'>',r)};t.outside=P;function P(e,t,r,n){e=new o(e,n);t=new h(t,n);var s,a,p,l,u;switch(r){case'>':s=d;a=f;p=c;l='>';u='>=';break;case'<':s=c;a=y;p=d;l='<';u='<=';break;default:throw new TypeError('Must provide a hilo val of "<" or ">"');}if(x(e,t,n)){return false}for(var m=0;m<t.set.length;++m){var i=t.set[m],_=null,g=null;i.forEach(function(e){_=_||e;g=g||e;if(s(e.semver,_.semver,n)){_=e}else if(p(e.semver,g.semver,n)){g=e}});if(_.operator===l||_.operator===u){return false}if((!g.operator||g.operator===l)&&a(e,g.semver)){return false}else if(g.operator===u&&p(e,g.semver)){return false}}return true}!(L=t,D='function'===typeof L?L.call(t,r,t,e):L,D!==undefined&&(e.exports=D))},function(e){e.exports={_from:'pg@^7.4.0',_id:'pg@7.4.0',_inBundle:false,_integrity:'sha1-4lYGHSxScjw8hY3vuX8RWcpmD4M=',_location:'/pg',_phantomChildren:{},_requested:{type:'range',registry:true,raw:'pg@^7.4.0',name:'pg',escapedName:'pg',rawSpec:'^7.4.0',saveSpec:null,fetchSpec:'^7.4.0'},_requiredBy:['/'],_resolved:'https://registry.npmjs.org/pg/-/pg-7.4.0.tgz',_shasum:'e256061d2c52723c3c858defb97f1159ca660f83',_spec:'pg@^7.4.0',_where:'/Users/wisdman/Projects/bitjournal',author:{name:'Brian Carlson',email:'brian.m.carlson@gmail.com'},bugs:{url:'https://github.com/brianc/node-postgres/issues'},bundleDependencies:false,dependencies:{"buffer-writer":'1.0.1',"js-string-escape":'1.0.1',"packet-reader":'0.3.1',"pg-connection-string":'0.1.3',"pg-pool":'~2.0.3',"pg-types":'~1.12.1',pgpass:'1.x',semver:'4.3.2'},deprecated:false,description:'PostgreSQL client - pure javascript & libpq with the same API',devDependencies:{async:'0.9.0',co:'4.6.0',eslint:'4.2.0',"eslint-config-standard":'10.2.1',"eslint-plugin-import":'2.7.0',"eslint-plugin-node":'5.1.0',"eslint-plugin-promise":'3.5.0',"eslint-plugin-standard":'3.0.1',"pg-copy-streams":'0.3.0'},engines:{node:'>= 4.5.0'},homepage:'http://github.com/brianc/node-postgres',keywords:['database','libpq','pg','postgre','postgres','postgresql','rdbms'],license:'MIT',main:'./lib',minNativeVersion:'2.0.0',name:'pg',repository:{type:'git',url:'git://github.com/brianc/node-postgres.git'},scripts:{test:'make test-all'},version:'7.4.0'}},function(e,t,r){'use strict';var n=r(3).EventEmitter,o=r(0),s=r(11),a=e.exports=function(e,t,r){n.call(this);e=s.normalizeQueryConfig(e,t,r);this.text=e.text;this.values=e.values;this.name=e.name;this.callback=e.callback;this.state='new';this._arrayMode='array'===e.rowMode;this._emitRowEvents=false;this.on('newListener',function(e){if('row'===e)this._emitRowEvents=true}.bind(this))};o.inherits(a,n);var i={sqlState:'code',statementPosition:'position',messagePrimary:'message',context:'where',schemaName:'schema',tableName:'table',columnName:'column',dataTypeName:'dataType',constraintName:'constraint',sourceFile:'file',sourceLine:'line',sourceFunction:'routine'};a.prototype.handleError=function(e){var t=this.native.pq.resultErrorFields();if(t){for(var r in t){var n=i[r]||r;e[n]=t[r]}}if(this.callback){this.callback(e)}else{this.emit('error',e)}this.state='error'};a.prototype.then=function(e,t){return this._getPromise().then(e,t)};a.prototype.catch=function(e){return this._getPromise().catch(e)};a.prototype._getPromise=function(){if(this._promise)return this._promise;this._promise=new Promise(function(e,t){this._once('end',e);this._once('error',t)}.bind(this));return this._promise};a.prototype.submit=function(e){this.state='running';var t=this;this.native=e.native;e.native.arrayMode=this._arrayMode;var r=function(r,n,o){e.native.arrayMode=false;setImmediate(function(){t.emit('_done')});if(r){return t.handleError(r)}if(t._emitRowEvents){if(1<o.length){n.forEach((e,r)=>{e.forEach((e)=>{t.emit('row',e,o[r])})})}else{n.forEach(function(e){t.emit('row',e,o)})}}t.state='end';t.emit('end',o);if(t.callback){t.callback(null,o)}};if(process.domain){r=process.domain.bind(r)}if(this.name){if(63<this.name.length){console.error('Warning! Postgres only supports 63 characters for query names.');console.error('You supplied',this.name,'(',this.name.length,')');console.error('This can cause conflicts and silent errors executing queries')}var n=(this.values||[]).map(s.prepareValue);if(e.namedQueries[this.name]){return e.native.execute(this.name,n,r)}return e.native.prepare(this.name,this.text,n.length,function(o){if(o)return r(o);e.namedQueries[t.name]=true;return t.native.execute(t.name,n,r)})}else if(this.values){if(!Array.isArray(this.values)){const e=new Error('Query values must be an array');return r(e)}var o=this.values.map(s.prepareValue);e.native.query(this.text,o,r)}else{e.native.query(this.text,r)}}},,function(e,t,r){'use strict';var n=r(12);class o extends n.a{constructor(e){const t=Object.keys(e).map((t)=>{const r=e[t];return(e)=>t in e?r.call(e,e[t]):undefined});super((e)=>t.reduce((t,r)=>{let n;try{n=r(e)}catch(e){const r=String(e&&e.message||e);t.errors.push(r);n=undefined}if(n!==undefined)t.value=Object.assign(t.value,n);return t},{value:{},errors:[]}))}}r.d(t,'a',function(){return o})},function(e,t,r){'use strict';var n=Number.isNaN;class o{constructor(e){this._this=e}get fullYear(){return this._this.getUTCFullYear()}set fullYear(e){this._this.setUTCFullYear(e)}get month(){return this._this.getUTCMonth()}set month(e){this._this.setUTCMonth(e)}get date(){return this._this.getUTCDate()}set date(e){this._this.setUTCDate(e)}get day(){return this._this.getUTCDay()}get hours(){return this._this.getUTCHours()}set hours(e){this._this.setUTCHours(e)}get minutes(){return this._this.getUTCMinutes()}set minutes(e){this._this.setUTCMinutes(e)}get seconds(){return this._this.getUTCSeconds()}set seconds(e){this._this.setUTCSeconds(e)}get milliseconds(){return this._this.getUTCMilliseconds()}set milliseconds(e){this._this.setUTCMilliseconds(e)}get monthString(){return this._this.locale.getMonthString(this.month)}get genitiveMonthString(){return this._this.locale.getMonthString(this.month,true)}get dayString(){return this._this.locale.getDayString(this.day)}get dateString(){const e=String(this.fullYear),t=('00'+String(this.month+1)).slice(-2),r=('00'+String(this.date).padStart(2,'0')).slice(-2);return`${e}-${t}-${r}`}get timeString(){const e=('00'+String(this.hours)).slice(-2),t=('00'+String(this.minutes)).slice(-2),r=('00'+String(this.seconds)).slice(-2);return`${e}:${t}:${r}`}setMidnight(){this.hours=0;this.minutes=0;this.seconds=0;this.milliseconds=0}toNumber(){return this._this.time}toString(){return this._this.toUTCString()}toJSON(){return this._this.iso}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Timestamp.UTC value to unknown value');}}}class s{constructor(){}[Symbol.toStringTag](){return'EN'}static getMonthString(e){return this.MONTHS[e].title}static getDayString(e){return this.DAYS[e].title}}s.MONTHS=[{id:0,title:'January'},{id:1,title:'February'},{id:2,title:'March'},{id:3,title:'April'},{id:4,title:'May'},{id:5,title:'June'},{id:6,title:'July'},{id:7,title:'August'},{id:8,title:'September'},{id:9,title:'October'},{id:10,title:'November'},{id:11,title:'December'}];s.DAYS=[{id:0,title:'Sunday'},{id:1,title:'Monday'},{id:2,title:'Tuesday'},{id:3,title:'Wednesday'},{id:4,title:'Thursday'},{id:5,title:'Friday'},{id:6,title:'Saturday'}];class a{constructor(){}[Symbol.toStringTag](){return'RU'}static getMonthString(e,t=false){return this.MONTHS[e][t?'genitive':'title']}static getDayString(e){return this.DAYS[e].title}}a.MONTHS=[{id:0,title:'\u042F\u043D\u0432\u0430\u0440\u044C',genitive:'\u042F\u043D\u0432\u0430\u0440\u044F'},{id:1,title:'\u0424\u0435\u0432\u0440\u0430\u043B\u044C',genitive:'\u0424\u0435\u0432\u0440\u0430\u043B\u044F'},{id:2,title:'\u041C\u0430\u0440\u0442',genitive:'\u041C\u0430\u0440\u0442\u0430'},{id:3,title:'\u0410\u043F\u0440\u0435\u043B\u044C',genitive:'\u0410\u043F\u0440\u0435\u043B\u044F'},{id:4,title:'\u041C\u0430\u0439',genitive:'\u041C\u0430\u044F'},{id:5,title:'\u0418\u044E\u043D\u044C',genitive:'\u0418\u044E\u043D\u044F'},{id:6,title:'\u0418\u044E\u043B\u044C',genitive:'\u0418\u044E\u043B\u044F'},{id:7,title:'\u0410\u0432\u0433\u0443\u0441\u0442',genitive:'\u0410\u0432\u0433\u0443\u0441\u0442\u0430'},{id:8,title:'\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C',genitive:'\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044F'},{id:9,title:'\u041E\u043A\u0442\u044F\u0431\u0440\u044C',genitive:'\u041E\u043A\u0442\u044F\u0431\u0440\u044F'},{id:10,title:'\u041D\u043E\u044F\u0431\u0440\u044C',genitive:'\u041D\u043E\u044F\u0431\u0440\u044F'},{id:11,title:'\u0414\u0435\u043A\u0430\u0431\u0440\u044C',genitive:'\u0414\u0435\u043A\u0430\u0431\u0440\u044F'}];a.DAYS=[{id:0,title:'\u0412\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u0438\u0435'},{id:1,title:'\u041F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A'},{id:2,title:'\u0412\u0442\u043E\u0440\u043D\u0438\u043A'},{id:3,title:'\u0421\u0440\u0435\u0434\u0430'},{id:4,title:'\u0427\u0435\u0442\u0432\u0435\u0440\u0433'},{id:5,title:'\u041F\u044F\u0442\u043D\u0438\u0446\u0430'},{id:6,title:'\u0421\u0443\u0431\u0431\u043E\u0442\u0430'}];class i extends Date{constructor(e=Date.now(),t=i.Locale.RU){super(e);this.locale=t;if(n(this.getTime()))throw new TypeError('Date is invalid')}get fullYear(){return this.getFullYear()}set fullYear(e){this.setFullYear(e)}get month(){return this.getMonth()}set month(e){this.setMonth(e)}get date(){return this.getDate()}set date(e){this.setDate(e)}get day(){return this.getDay()}get hours(){return this.getHours()}set hours(e){this.setHours(e)}get minutes(){return this.getMinutes()}set minutes(e){this.setMinutes(e)}get seconds(){return this.getSeconds()}set seconds(e){this.setSeconds(e)}get milliseconds(){return this.getMilliseconds()}set milliseconds(e){this.setMilliseconds(e)}get UTC(){return new o(this)}get monthString(){return this.locale.getMonthString(this.month)}get genitiveMonthString(){return this.locale.getMonthString(this.month,true)}get dayString(){return this.locale.getDayString(this.day)}get dateString(){const e=String(this.fullYear),t=('00'+String(this.month+1)).slice(-2),r=('00'+String(this.date)).slice(-2);return`${e}-${t}-${r}`}get timeString(){const e=('00'+String(this.hours)).slice(-2),t=('00'+String(this.minutes)).slice(-2),r=('00'+String(this.seconds)).slice(-2);return`${e}:${t}:${r}`}get time(){return this.getTime()}set time(e){this.setTime(e)}get unux(){return 0|this.getTime()/1e3}set unix(e){this.setTime(1e3*e)}get timezoneOffset(){return this.getTimezoneOffset()}get timezone(){let e=this.timezoneOffset,t='-';if(0>e){e=-1*e;t='+'}t+=('00'+String(Math.floor(e/60))).slice(-2);t+=':';t+=('00'+String(Math.round(100*(e%60)))).slice(-2);return t}get iso(){return this.toISOString()}setMidnight(){this.hours=0;this.minutes=0;this.seconds=0;this.milliseconds=0}compare(e,{ignoreTime:t=false,ignoreMilliseconds:r=true}={}){const o=new Date(e);if(n(o.getTime()))throw new TypeError('Comparable date is invalid');let s=this.getUTCFullYear(),a=o.getUTCFullYear();if(s>a)return 1;if(s<a)return-1;s=this.getUTCMonth();a=o.getUTCMonth();if(s>a)return 1;if(s<a)return-1;s=this.getUTCDate();a=o.getUTCDate();if(s>a)return 1;if(s<a)return-1;if(t)return 0;s=this.getUTCHours();a=o.getUTCHours();if(s>a)return 1;if(s<a)return-1;s=this.getUTCMinutes();a=o.getUTCMinutes();if(s>a)return 1;if(s<a)return-1;s=this.getUTCSeconds();a=o.getUTCSeconds();if(s>a)return 1;if(s<a)return-1;if(r)return 0;s=this.getUTCMilliseconds();a=o.getUTCMilliseconds();if(s>a)return 1;if(s<a)return-1;return 0}toHRString(e=new Date){const t=new Date(e);let r='';if(0===this.compare(t,{ignoreTime:true}))r+='\u0421\u0435\u0433\u043E\u0434\u043D\u044F';else{t.setDate(t.getDate()-1);if(0===this.compare(t,{ignoreTime:true}))r+='\u0412\u0447\u0435\u0440\u0430';else{r+=String(this.getDate());r+=' '+this.genitiveMonthString;const e=this.getFullYear();if(e!==t.getFullYear())r+=' '+String(e)}}r+=' '+String(this.getHours());r+=':'+('00'+String(this.getMinutes())).slice(-2);return r}get HRString(){return this.toHRString()}valueOf(){return new Date(this.time)}toNumber(){return this.time}toString(){return this.iso}toJSON(){return this.iso}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Timestamp value to unknown value');}}[Symbol.toStringTag](){return'Timestamp'}}i.Locale={EN:s,RU:a};r.d(t,'a',function(){return i})},function(e,t){'use strict';var r='undefined'!==typeof window&&window,n='undefined'!==typeof self&&'undefined'!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,o='undefined'!==typeof global&&global,s=r||o||n;t.root=s;(function(){if(!s){throw new Error('RxJS could not find any global context (window, self, global)')}})()},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(64),s=r(59),a=r(68),i=r(60),p=function(e){n(t,e);function t(r,n,o){e.call(this);this.syncErrorValue=null;this.syncErrorThrown=false;this.syncErrorThrowable=false;this.isStopped=false;switch(arguments.length){case 0:this.destination=a.empty;break;case 1:if(!r){this.destination=a.empty;break}if('object'===typeof r){if(r instanceof t){this.syncErrorThrowable=r.syncErrorThrowable;this.destination=r;this.destination.add(this)}else{this.syncErrorThrowable=true;this.destination=new l(this,r)}break}default:this.syncErrorThrowable=true;this.destination=new l(this,r,n,o);break;}}t.prototype[i.rxSubscriber]=function(){return this};t.create=function(e,r,n){var o=new t(e,r,n);o.syncErrorThrowable=false;return o};t.prototype.next=function(e){if(!this.isStopped){this._next(e)}};t.prototype.error=function(e){if(!this.isStopped){this.isStopped=true;this._error(e)}};t.prototype.complete=function(){if(!this.isStopped){this.isStopped=true;this._complete()}};t.prototype.unsubscribe=function(){if(this.closed){return}this.isStopped=true;e.prototype.unsubscribe.call(this)};t.prototype._next=function(e){this.destination.next(e)};t.prototype._error=function(e){this.destination.error(e);this.unsubscribe()};t.prototype._complete=function(){this.destination.complete();this.unsubscribe()};t.prototype._unsubscribeAndRecycle=function(){var e=this,t=e._parent,r=e._parents;this._parent=null;this._parents=null;this.unsubscribe();this.closed=false;this.isStopped=false;this._parent=t;this._parents=r;return this};return t}(s.Subscription);t.Subscriber=p;var l=function(e){n(t,e);function t(t,r,n,s){e.call(this);this._parentSubscriber=t;var i,p=this;if(o.isFunction(r)){i=r}else if(r){i=r.next;n=r.error;s=r.complete;if(r!==a.empty){p=Object.create(r);if(o.isFunction(p.unsubscribe)){this.add(p.unsubscribe.bind(p))}p.unsubscribe=this.unsubscribe.bind(this)}}this._context=p;this._next=i;this._error=n;this._complete=s}t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;if(!t.syncErrorThrowable){this.__tryOrUnsub(this._next,e)}else if(this.__tryOrSetError(t,this._next,e)){this.unsubscribe()}}};t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error){if(!t.syncErrorThrowable){this.__tryOrUnsub(this._error,e);this.unsubscribe()}else{this.__tryOrSetError(t,this._error,e);this.unsubscribe()}}else if(!t.syncErrorThrowable){this.unsubscribe();throw e}else{t.syncErrorValue=e;t.syncErrorThrown=true;this.unsubscribe()}}};t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};if(!t.syncErrorThrowable){this.__tryOrUnsub(r);this.unsubscribe()}else{this.__tryOrSetError(t,r);this.unsubscribe()}}else{this.unsubscribe()}}};t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){this.unsubscribe();throw e}};t.prototype.__tryOrSetError=function(e,t,r){try{t.call(this._context,r)}catch(t){e.syncErrorValue=t;e.syncErrorThrown=true;return true}return false};t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null;this._parentSubscriber=null;e.unsubscribe()};return t}(p)},,function(e,t,r){'use strict';var o=r(65),s=r(66),a=r(64),i=r(92),p=r(67),l=r(93),d=function(){function e(e){this.closed=false;this._parent=null;this._parents=null;this._subscriptions=null;if(e){this._unsubscribe=e}}e.prototype.unsubscribe=function(){var e=false,t;if(this.closed){return}var r=this,d=r._parent,c=r._parents,u=r._unsubscribe,m=r._subscriptions;this.closed=true;this._parent=null;this._parents=null;this._subscriptions=null;var y=-1,f=c?c.length:0;while(d){d.remove(this);d=++y<f&&c[y]||null}if(a.isFunction(u)){var _=i.tryCatch(u).call(this);if(_===p.errorObject){e=true;t=t||(p.errorObject.e instanceof l.UnsubscriptionError?n(p.errorObject.e.errors):[p.errorObject.e])}}if(o.isArray(m)){y=-1;f=m.length;while(++y<f){var h=m[y];if(s.isObject(h)){var _=i.tryCatch(h.unsubscribe).call(h);if(_===p.errorObject){e=true;t=t||[];var g=p.errorObject.e;if(g instanceof l.UnsubscriptionError){t=t.concat(n(g.errors))}else{t.push(g)}}}}}if(e){throw new l.UnsubscriptionError(t)}};e.prototype.add=function(t){if(!t||t===e.EMPTY){return e.EMPTY}if(t===this){return this}var r=t;switch(typeof t){case'function':r=new e(t);case'object':if(r.closed||'function'!==typeof r.unsubscribe){return r}else if(this.closed){r.unsubscribe();return r}else if('function'!==typeof r._addParent){var n=r;r=new e;r._subscriptions=[n]}break;default:throw new Error('unrecognized teardown '+t+' added to Subscription.');}var o=this._subscriptions||(this._subscriptions=[]);o.push(r);r._addParent(this);return r};e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);if(-1!==r){t.splice(r,1)}}};e.prototype._addParent=function(e){var t=this,r=t._parent,n=t._parents;if(!r||r===e){this._parent=e}else if(!n){this._parents=[e]}else if(-1===n.indexOf(e)){n.push(e)}};e.EMPTY=function(e){e.closed=true;return e}(new e);return e}();t.Subscription=d;function n(e){return e.reduce(function(e,t){return e.concat(t instanceof l.UnsubscriptionError?t.errors:t)},[])}},function(e,t,r){'use strict';var n=r(56),o=n.root.Symbol;t.rxSubscriber='function'===typeof o&&'function'===typeof o.for?o.for('rxSubscriber'):'@@rxSubscriber';t.$$rxSubscriber=t.rxSubscriber},function(e,t,r){'use strict';var n=r(24),o=r(96);n.Observable.merge=o.merge},function(e,t,r){'use strict';var n=r(24),o=r(107);n.Observable.prototype.map=o.map},function(e,t,r){'use strict';var n=r(24),o=r(111);n.Observable.interval=o.interval},function(e,t){'use strict';t.isFunction=function(e){return'function'===typeof e}},function(e,t){'use strict';t.isArray=Array.isArray||function(e){return e&&'number'===typeof e.length}},function(e,t){'use strict';t.isObject=function(e){return null!=e&&'object'===typeof e}},function(e,t){'use strict';t.errorObject={e:{}}},function(e,t){'use strict';t.empty={closed:true,next:function(){},error:function(e){throw e},complete:function(){}}},function(e,t,r){'use strict';var o=r(56);function n(e){var t,r=e.Symbol;if('function'===typeof r){if(r.observable){t=r.observable}else{t=r('observable');r.observable=t}}else{t='@@observable'}return t}t.getSymbolObservable=n;t.observable=n(o.root);t.$$observable=t.observable},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(24),s=function(e){n(t,e);function t(t){e.call(this);this.scheduler=t}t.create=function(e){return new t(e)};t.dispatch=function(e){var t=e.subscriber;t.complete()};t.prototype._subscribe=function(e){var r=this.scheduler;if(r){return r.schedule(t.dispatch,0,{subscriber:e})}else{e.complete()}};return t}(o.Observable);t.EmptyObservable=s},function(e,t){'use strict';t.isScheduler=function(e){return e&&'function'===typeof e.schedule}},function(e,t,r){'use strict';var n=r(99),o=r(106);t.mergeAll=function(e){if(void 0===e){e=Number.POSITIVE_INFINITY}return n.mergeMap(o.identity,null,e)}},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(24),s=r(57),a=r(59),i=r(109),p=r(110),l=r(60),d=function(e){n(t,e);function t(t){e.call(this,t);this.destination=t}return t}(s.Subscriber);t.SubjectSubscriber=d;var c=function(e){n(t,e);function t(){e.call(this);this.observers=[];this.closed=false;this.isStopped=false;this.hasError=false;this.thrownError=null}t.prototype[l.rxSubscriber]=function(){return new d(this)};t.prototype.lift=function(e){var t=new u(this,this);t.operator=e;return t};t.prototype.next=function(e){if(this.closed){throw new i.ObjectUnsubscribedError}if(!this.isStopped){for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++){n[o].next(e)}}};t.prototype.error=function(e){if(this.closed){throw new i.ObjectUnsubscribedError}this.hasError=true;this.thrownError=e;this.isStopped=true;for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++){n[o].error(e)}this.observers.length=0};t.prototype.complete=function(){if(this.closed){throw new i.ObjectUnsubscribedError}this.isStopped=true;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++){r[n].complete()}this.observers.length=0};t.prototype.unsubscribe=function(){this.isStopped=true;this.closed=true;this.observers=null};t.prototype._trySubscribe=function(t){if(this.closed){throw new i.ObjectUnsubscribedError}else{return e.prototype._trySubscribe.call(this,t)}};t.prototype._subscribe=function(e){if(this.closed){throw new i.ObjectUnsubscribedError}else if(this.hasError){e.error(this.thrownError);return a.Subscription.EMPTY}else if(this.isStopped){e.complete();return a.Subscription.EMPTY}else{this.observers.push(e);return new p.SubjectSubscription(this,e)}};t.prototype.asObservable=function(){var e=new o.Observable;e.source=this;return e};t.create=function(e,t){return new u(e,t)};return t}(o.Observable);t.Subject=c;var u=function(e){n(t,e);function t(t,r){e.call(this);this.destination=t;this.source=r}t.prototype.next=function(e){var t=this.destination;if(t&&t.next){t.next(e)}};t.prototype.error=function(e){var t=this.destination;if(t&&t.error){this.destination.error(e)}};t.prototype.complete=function(){var e=this.destination;if(e&&e.complete){this.destination.complete()}};t.prototype._subscribe=function(e){var t=this.source;if(t){return this.source.subscribe(e)}else{return a.Subscription.EMPTY}};return t}(c);t.AnonymousSubject=u},function(e,t,r){'use strict';var n=r(24),o=r(119);n.Observable.fromPromise=o.fromPromise},function(e,t,r){'use strict';var n=r(24),o=r(121);n.Observable.prototype.take=o.take},function(e,t,r){'use strict';var n=r(24),o=r(124);n.Observable.prototype.filter=o.filter},function(e,t,r){'use strict';var n=r(24),o=r(126);n.Observable.prototype.mergeAll=o.mergeAll},,,,,,,,,,,,function(e,t,r){e.exports=r(90)},function(e,t,r){'use strict';var n=Number.isNaN,o=Math.max;Object.defineProperty(t,'__esModule',{value:true});var s=r(24),a=r.n(s),i=r(61),p=r.n(i),l=r(62),d=r.n(l),c=r(73),u=r.n(c),m=r(63),y=r.n(m),f=r(74),_=r.n(f),h=r(75),g=r.n(h),b=r(76),E=r.n(b),T=r(77),I=r.n(T),S=r(25),O=r.n(S),R=r(8),A=r.n(R),N=r(14),v=r.n(N);class C{constructor(e){this.res=e}getHeader(e){let t=this.res.headers[e.toLowerCase()];return Array.isArray(t)?t.join(';'):t}get socket(){return this.res.socket}get ip(){return this.res.connection.remoteAddress||''}get status(){return this.res.statusCode}get type(){let e=this.getHeader('Content-Type');if('string'!==typeof e)return;return e.split(';')[0].trim()}get length(){return~~(this.getHeader('content-length')||'')}async raw(){const e=this.length;return new Promise((t,r)=>{let n=Buffer.alloc(0);const o=()=>{l();r(new Error('Request aborted'))},s=()=>{l();r(new Error('Receive data error'))},a=(e)=>{n=Buffer.concat([n,e])},i=()=>{l();if(0<e&&n.length!==e){r(new Error('Request size did not match content length'))}t(n)},p=()=>{l()};var l=()=>{this.res.removeListener('aborted',o);this.res.removeListener('end',s);this.res.removeListener('data',a);this.res.removeListener('error',i);this.res.removeListener('close',p);this.res.unpipe()};this.res.on('aborted',o);this.res.on('error',s);this.res.on('data',a);this.res.on('end',i);this.res.on('close',p)})}async text(){let e=await this.raw();try{let t=new N.StringDecoder('utf8');return t.end(e)}catch(e){throw new Error('Receive data is not a UTF8 string')}}async json(){if('application/json'!==this.type)throw new Error(`Only application/json data are allowed! Response: ${JSON.stringify(this)}`);let e=await this.text();try{return JSON.parse(e)}catch(e){throw new Error('Invalid json received')}}valueOf(){return{ip:this.ip,status:this.status,type:this.type,length:this.length}}toJSON(){return this.valueOf()}}class x{request(e,t){return new Promise((r,n)=>{const o=(t.pathname||'/')+(t.search&&t.search||''),s=A.a.request({hostname:t.hostname,port:t.port||80,path:o,method:e},(e)=>r(new C(e)));s.on('error',(e)=>n(e));s.end()})}}var P=r(127),L=r.n(P);class D{request(e,t){return new Promise((r,n)=>{const o=(t.pathname||'/')+(t.search&&t.search||''),s=L.a.request({hostname:t.hostname,port:t.port||443,path:o,method:e},(e)=>r(new C(e)));s.on('error',(e)=>n(e));s.end()})}}var w=r(7);const U=new w.a('HTTP');class M{async request(e,t){const r=new S.URL(t),n=r.protocol.toLowerCase(),o=/^https/.test(n)?new D:new x;U(`=== HTTP(S) Request [%s] ===`,t);let s;try{s=await o.request(e,r)}catch(e){U(`=== HTTP(S) Request [%s] Error ===\n%O`,t,e);throw e}U(`=== HTTP(S) Request [%s] Successful ===\n%O`,t,s);return s}async get(e){return await this.request('GET',e)}async json(e){const t=await this.get(e),r=await t.json();return r}}const k={bitgem:'BTG*'};class F{constructor(){this._http=new M;this._coinSubject=new c.Subject;this.coin=this._coinSubject.asObservable();this.update()}static coinTickerToCoin(e){if(!e)return;let t=String(e.symbol||'').trim().toUpperCase();if(!t)return;t=k[e.id]||t;const r={symbol:t},s=String(e.name||'').trim();if(s)r.title=s;const a=o(parseFloat(e.price_usd),0);if(!n(a)&&0<a)r.priceUSD=a;const i=o(parseFloat(e.price_btc),0);if(!n(i)&&0<i)r.priceBTC=i;const p=o(parseFloat(e.price_rub),0);if(!n(p)&&0<p)r.priceRUB=p;const l=o(parseFloat(e['24h_volume_usd']),0);if(!n(l)&&0<l)r.volume24h=l;const d=o(parseFloat(e.available_supply),0);if(!n(d))r.availableSupply=d;const c=o(parseFloat(e.max_supply),0);if(!n(c))r.maxSupply=c;const u=parseFloat(e.percent_change_1h);if(!n(u))r.change1h=u;const m=parseFloat(e.percent_change_24h);if(!n(m))r.change24h=m;const y=parseFloat(e.percent_change_7d);if(!n(y))r.change7d=y;r.coinmarketcapRank=~~e.rank;return r}async _getCoinsTicker(){let e;try{e=await this._http.json('https://api.coinmarketcap.com/v1/ticker/?convert=RUB&limit=0')}catch(e){console.error('Coinmarketcape ERREOR [ getCoinsTicker http ]',e);return[]}if(0===e.length){console.error('Coinmarketcap ERREOR [ getCoinsTicker data ]',e);return[]}return e.map((e)=>F.coinTickerToCoin(e)).filter((e)=>'object'===typeof e&&null!==e).sort((e,t)=>(e.coinmarketcapRank||0)-(t.coinmarketcapRank||0))}async update(){const e=await this._getCoinsTicker();e.forEach((e)=>this._coinSubject.next(e));setTimeout(()=>this.update(),3e5)}}var j=r(55);const V=(e)=>`https://www.cryptocompare.com/api/data/coinsnapshotfullbyid/?id=${e}`,Q=(e,t='USD')=>`https://min-api.cryptocompare.com/data/histoday?fsym=${e}&tsym=${t}&allData=true`;class q{constructor(){this._http=new M;this._coinSubject=new c.Subject;this.coin=this._coinSubject.asObservable();this.update()}static coinListToCoin(e){if(!e)return;const t=String(e.Symbol||'').trim().toUpperCase(),r=~~e.Id;if(!t||!r)return;const s={cryptocompareId:r,symbol:t},a=String(e.CoinName||'').trim();if(a)s.title=a;const i=String(e.Algorithm||'').trim();if(i)s.algorithm=i;const p=String(e.ProofType||'').trim();if(p)s.proofType=p;const l=o(parseFloat(e.TotalCoinSupply),0);if(!n(l))s.maxSupply=l;s.cryptocompareSort=~~e.SortOrder;return s}static coinSnapshotToCoin(e){if(!e)return;const t=String(e.Symbol||'').trim().toUpperCase(),r=~~e.Id;if(!t||!r)return;const s={cryptocompareId:r,symbol:t},a=String(e.Name||'').trim();if(a)s.title=a;try{const t=new j.a(e.StartDate).UTC.dateString;if(t)s.startDate=t}catch(e){}const i=String(e.Algorithm||'').trim();if(i)s.algorithm=i;const p=String(e.ProofType||'').trim();if(p)s.proofType=p;const l=String(e.AffiliateUrl||'').trim();if(l)s.url=l;const d=o(parseFloat(e.TotalCoinSupply),0);if(!n(d))s.maxSupply=d;const c=o(e.TotalCoinsMined,0);if(c)s.availableSupply=c;const u=o(e.BlockReward,0);if(u)s.blockReward=u;const m=new Date(e.LastBlockExplorerUpdateTS).getTime();if(m)s.lastBlockTS=m;const y=o(e.BlockNumber,0);if(y)s.lastBlockNumber=y;const f=o(e.NetHashesPerSecond,0);if(f)s.hashRate=f;return s}static coinHistodayToHistoday(e){const t=(Array.isArray(e)?e:[]).filter((e)=>'object'===typeof e&&null!==e).map((e)=>{let t;try{t=e.time&&new j.a(1e3*e.time)||undefined}catch(e){t=undefined}if(t)t.UTC.setMidnight();const r=e.high&&0<e.high&&e.low&&0<e.low?(e.high+e.low)/2:0;return{ts:t&&t.time||0,value:r}}).filter((e)=>e.ts&&e.value);if(0===t.length)return;return t.reduce((e,t)=>Object.assign(e,{[t.ts]:t.value}),{})}async _getCoinsList(){let e;try{e=await this._http.json('https://www.cryptocompare.com/api/data/coinlist/')}catch(e){console.error('Cryptocompare ERREOR [ getCoinsList http ]',e);return[]}if('Success'!==e.Response){console.error('Cryptocompare ERREOR [ getCoinsList data ]',e.Message);return[]}return Object.keys(e.Data).map((t)=>{const r=e.Data[t];if(r.Symbol!==t){console.error('Cryptocompare ERREOR [ getCoinsList symbol ]',r);return}return r}).map((e)=>q.coinListToCoin(e)).filter((e)=>'object'===typeof e&&null!==e).sort((e,t)=>(e.cryptocompareSort||0)-(t.cryptocompareSort||0))}async _getCoinSnapshot(e){if(!e||0>=e)return;const t=V(e);let r;try{r=await this._http.json(t)}catch(t){console.error(`Cryptocompare ERREOR [ getCoinSnapshot http ${e} ]`,t);return}if('Success'!==r.Response){console.error(`Cryptocompare ERREOR [ getCoinsList data ${e} ]`,r.Message);return}const n=r.Data&&r.Data.General;if(!n){console.error(`Cryptocompare ERREOR [ getCoinsList data.Data.General ${e} ]`,r.Message);return}return q.coinSnapshotToCoin(n)}async _getCoinHistoday(e){if(!e)return;const t=Q(e);let r;try{r=await this._http.json(t)}catch(t){console.error(`Cryptocompare ERREOR [ getCoinHistoday http ${e} ]`,t);return}if('Success'!==r.Response){console.error(`Cryptocompare ERREOR [ getCoinHistoday data ${e} ]`,r.Message);return}const n=r.Data&&r.Data;if(!n||0===n.length){console.error(`Cryptocompare ERREOR [ getCoinHistoday data.Data ${e} ]`,r.Message);return}const o=q.coinHistodayToHistoday(n);return o&&{cryptocompareId:0,symbol:e,histoday:o}}async update(){const e=await this._getCoinsList();e.forEach((e)=>this._coinSubject.next(e));s.Observable.interval(15000).take(e.length).map((t)=>e[t]).map((e)=>{const t=e.cryptocompareId,r=e.symbol;return s.Observable.merge(s.Observable.fromPromise(this._getCoinSnapshot(t)))}).mergeAll().filter((e)=>e!==undefined).subscribe((e)=>this._coinSubject.next(e),(e)=>console.error('Cryptocompare ERREOR [ update Observable error ]',e),()=>setTimeout(()=>this.update(),6e5))}}var G=r(2),H=r(54);const B=new H.a({symbol:(e)=>{const t=String(e||'').trim().toUpperCase().replace(/[\.]/g,'');return t&&{symbol:t}||undefined},title:(e)=>{const t=String(e||'').trim();return t&&{title:t}||undefined},founder:(e)=>{const t=String(e||'').trim();return t&&{founder:t}||undefined},startDate:(e)=>{let t;try{t=new j.a(e);t.UTC.setMidnight();t=t.UTC.dateString}catch(e){t=undefined}return t&&{startDate:t}||undefined},algorithm:(e)=>{const t=String(e||'').trim();return t&&{algorithm:t}||undefined},proofType:(e)=>{const t=String(e||'').trim();return t&&{proofType:t}||undefined},url:(e)=>{const t=String(e||'').trim();return t&&{url:t}||undefined},maxSupply:(e)=>{const t=o(parseFloat(e)||0,0);return t&&{maxSupply:t}||undefined},availableSupply:(e)=>{const t=o(parseFloat(e)||0,0);return t&&{availableSupply:t}||undefined},blockReward:(e)=>{const t=o(parseFloat(e)||0,0);return t&&{blockReward:t}||undefined},lastBlockTS:(e)=>{let t;try{t=new j.a(e);t.UTC.setMidnight();t=t.iso}catch(e){t=undefined}return t&&{startDate:t}||undefined},lastBlockNumber:(e)=>{const t=o(parseFloat(e)||0,0);return t&&{lastBlockNumber:t}||undefined},hashRate:(e)=>{const t=o(parseFloat(e)||0,0);return t&&t<Infinity&&{hashRate:t}||undefined},priceUSD:(e)=>{const t=o(parseFloat(e)||0,0);return t&&{priceUSD:t}||undefined},priceBTC:(e)=>{const t=o(parseFloat(e)||0,0);return t&&{priceBTC:t}||undefined},priceRUB:(e)=>{const t=o(parseFloat(e)||0,0);return t&&{priceRUB:t}||undefined},volume24h:(e)=>{const t=o(parseFloat(e)||0,0);return t&&{volume24h:t}||undefined},change1h:(e)=>{const t=parseFloat(e)||0;return t&&{change1h:t}||undefined},change24h:(e)=>{const t=parseFloat(e)||0;return t&&{change24h:t}||undefined},change7d:(e)=>{const t=parseFloat(e)||0;return t&&{change7d:t}||undefined},histoday:(e)=>{if('object'!==typeof e||null===e)return;const t=Object.keys(e).map((t)=>{let r;try{r=new j.a(t);r.UTC.setMidnight();r=r.UTC.dateString}catch(e){r=undefined}if(!r)return;const n=o(parseFloat(e[t])||0,0);if(!n)return;return{[r]:n}}).filter((e)=>!!e).reduce((e,t)=>Object.assign(e,t),{});if(0===Object.keys(t).length)return;return t}}),X='coins',Y=['title','founder','startDate','algorithm','proofType','maxSupply','url'],z=['availableSupply','blockReward','lastBlockTS','lastBlockNumber','hashRate','priceUSD','priceBTC','priceRUB','volume24h','change1h','change24h','change7d'];const $=s.Observable.merge(new F().coin,new q().coin);new class{constructor(e){this._pool=Object(G.e)({max:10});this._queue=[];e.subscribe((e)=>this._queue.push(e));this._updateLoop()}async _updateLoop(){const e=this._queue.shift();if(!e){setTimeout(()=>this._updateLoop(),1e4);return}await this._update(e);setTimeout(()=>this._updateLoop(),0)}async _update(e){const t=B(e);if(0<t.errors.length){console.error(`DBUpdater ERREOR [ make coin by model ]`,e);return}const r=t.value,n=r.symbol;if(!n){console.error(`DBUpdater ERREOR [ symbol not found ]`,e,r);return}const o={symbol:n},s={symbol:n},a={symbol:n};Object.keys(r).map((e)=>{if(Y.includes(e)){o[e]=r[e];return}if(z.includes(e)){s[e]=r[e];return}if('histoday'===e){a[e]=r[e]}});try{if(1<Object.keys(o).length)await this._staticFieldsUpdate(o);if(1<Object.keys(s).length)await this._dynamicFieldsUpdate(s)}catch(t){console.error(`DBUpdater ERREOR [ ${n} ]`,e,t)}}async _staticFieldsUpdate(e){const t=await this._pool.connect(),r=e.symbol,n=new G.d(X).select(Y).where('symbol = $1',r),o=await n.exec(t);if(1<o.length){t.release();throw new Error('More then one symbol in datatable')}if(0===o.length){t.release();await this._createNewFeeld(e);return}delete e.symbol;const s=B(o[0]).value,a={};Object.keys(e).map((t)=>{let r=e[t],n=s[t];if(!n)a[t]=r});if(0===Object.keys(a).length){t.release();return}const i=new G.d(X).update(a).where('symbol = $1',r).returning('symbol'),p=await i.exec(t);console.log('=== DBUpdater UPDATE STATIC RECORD [%s] ===\n',p[0].symbol,a);t.release()}async _createNewFeeld(e){const t=await this._pool.connect(),r=new G.d(X).insert(e).returning('symbol'),n=await r.exec(t);console.log('=== DBUpdater NEW RECORD [%s] ===\n',n[0].symbol,e);t.release()}async _dynamicFieldsUpdate(e){const t=await this._pool.connect(),r=e.symbol,n=new G.d(X).select(z).where('symbol = $1',r),o=await n.exec(t);if(1<o.length){t.release();throw new Error('More then one symbol in datatable')}if(0===o.length){t.release();console.log('=== DBUpdater ERREOR [%s] Dynamic update unknown record ===\n',r);return}delete e.symbol;const s=B(o[0]).value,a={};Object.keys(e).map((t)=>{let r=e[t],n=s[t];if(n!==r)a[t]=r});if(0===Object.keys(a).length){t.release();return}const i=new G.d(X).update(a).where('symbol = $1',r).returning('symbol'),p=await i.exec(t);t.release()}}($)},function(e,t,r){'use strict';var n=r(57),o=r(60),s=r(68);t.toSubscriber=function(e,t,r){if(e){if(e instanceof n.Subscriber){return e}if(e[o.rxSubscriber]){return e[o.rxSubscriber]()}}if(!e&&!t&&!r){return new n.Subscriber(s.empty)}return new n.Subscriber(e,t,r)}},function(e,t,r){'use strict';var o=r(67),s;function n(){try{return s.apply(this,arguments)}catch(t){o.errorObject.e=t;return o.errorObject}}t.tryCatch=function(e){s=e;return n}},function(e,t){'use strict';var r=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},n=function(e){r(t,e);function t(t){e.call(this);this.errors=t;var r=Error.call(this,t?t.length+' errors occurred during unsubscription:\n  '+t.map(function(e,t){return t+1+') '+e.toString()}).join('\n  '):'');this.name=r.name='UnsubscriptionError';this.stack=r.stack;this.message=r.message}return t}(Error);t.UnsubscriptionError=n},function(e,t,r){'use strict';var o=r(95);t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++){e[t-0]=arguments[t]}return n(e)};function n(e){if(!e){return o.noop}if(1===e.length){return e[0]}return function(t){return e.reduce(function(e,t){return t(e)},t)}}t.pipeFromArray=n},function(e,t){'use strict';t.noop=function(){}},function(e,t,r){'use strict';var n=r(24),o=r(97),s=r(71),a=r(72);t.merge=function(){for(var e=[],t=0;t<arguments.length;t++){e[t-0]=arguments[t]}var r=Number.POSITIVE_INFINITY,i=null,p=e[e.length-1];if(s.isScheduler(p)){i=e.pop();if(1<e.length&&'number'===typeof e[e.length-1]){r=e.pop()}}else if('number'===typeof p){r=e.pop()}if(null===i&&1===e.length&&e[0]instanceof n.Observable){return e[0]}return a.mergeAll(r)(new o.ArrayObservable(e,i))}},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(24),s=r(98),a=r(70),i=r(71),p=function(e){n(t,e);function t(t,r){e.call(this);this.array=t;this.scheduler=r;if(!r&&1===t.length){this._isScalar=true;this.value=t[0]}}t.create=function(e,r){return new t(e,r)};t.of=function(){for(var e=[],r=0;r<arguments.length;r++){e[r-0]=arguments[r]}var n=e[e.length-1];if(i.isScheduler(n)){e.pop()}else{n=null}var o=e.length;if(1<o){return new t(e,n)}else if(1===o){return new s.ScalarObservable(e[0],n)}else{return new a.EmptyObservable(n)}};t.dispatch=function(e){var t=e.array,r=e.index,n=e.count,o=e.subscriber;if(r>=n){o.complete();return}o.next(t[r]);if(o.closed){return}e.index=r+1;this.schedule(e)};t.prototype._subscribe=function(e){var r=this.array,n=r.length,o=this.scheduler;if(o){return o.schedule(t.dispatch,0,{array:r,index:0,count:n,subscriber:e})}else{for(var s=0;s<n&&!e.closed;s++){e.next(r[s])}e.complete()}};return t}(o.Observable);t.ArrayObservable=p},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(24),s=function(e){n(t,e);function t(t,r){e.call(this);this.value=t;this.scheduler=r;this._isScalar=true;if(r){this._isScalar=false}}t.create=function(e,r){return new t(e,r)};t.dispatch=function(e){var t=e.done,r=e.value,n=e.subscriber;if(t){n.complete();return}n.next(r);if(n.closed){return}e.done=true;this.schedule(e)};t.prototype._subscribe=function(e){var r=this.value,n=this.scheduler;if(n){return n.schedule(t.dispatch,0,{done:false,value:r,subscriber:e})}else{e.next(r);if(!e.closed){e.complete()}}};return t}(o.Observable);t.ScalarObservable=s},function(e,t,r){'use strict';var n=Number.POSITIVE_INFINITY,o=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},s=r(100),a=r(105);t.mergeMap=function(e,t,r){if(void 0===r){r=n}return function(n){if('number'===typeof t){r=t;t=null}return n.lift(new i(e,t,r))}};var i=function(){function e(e,t,r){if(void 0===r){r=n}this.project=e;this.resultSelector=t;this.concurrent=r}e.prototype.call=function(e,t){return t.subscribe(new p(e,this.project,this.resultSelector,this.concurrent))};return e}();t.MergeMapOperator=i;var p=function(e){o(t,e);function t(t,r,o,s){if(void 0===s){s=n}e.call(this,t);this.project=r;this.resultSelector=o;this.concurrent=s;this.hasCompleted=false;this.buffer=[];this.active=0;this.index=0}t.prototype._next=function(e){if(this.active<this.concurrent){this._tryNext(e)}else{this.buffer.push(e)}};t.prototype._tryNext=function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(e){this.destination.error(e);return}this.active++;this._innerSub(t,e,r)};t.prototype._innerSub=function(e,t,r){this.add(s.subscribeToResult(this,e,t,r))};t.prototype._complete=function(){this.hasCompleted=true;if(0===this.active&&0===this.buffer.length){this.destination.complete()}};t.prototype.notifyNext=function(e,t,r,n){if(this.resultSelector){this._notifyResultSelector(e,t,r,n)}else{this.destination.next(t)}};t.prototype._notifyResultSelector=function(e,t,r,n){var o;try{o=this.resultSelector(e,t,r,n)}catch(e){this.destination.error(e);return}this.destination.next(o)};t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e);this.active--;if(0<t.length){this._next(t.shift())}else if(0===this.active&&this.hasCompleted){this.destination.complete()}};return t}(a.OuterSubscriber);t.MergeMapSubscriber=p},function(e,t,r){'use strict';var n=r(56),o=r(101),s=r(102),a=r(66),p=r(24),l=r(103),d=r(104),c=r(69);t.subscribeToResult=function(e,t,r,u){var m=new d.InnerSubscriber(e,r,u);if(m.closed){return null}if(t instanceof p.Observable){if(t._isScalar){m.next(t.value);m.complete();return null}else{m.syncErrorThrowable=true;return t.subscribe(m)}}else if(o.isArrayLike(t)){for(var y=0,i=t.length;y<i&&!m.closed;y++){m.next(t[y])}if(!m.closed){m.complete()}}else if(s.isPromise(t)){t.then(function(e){if(!m.closed){m.next(e);m.complete()}},function(e){return m.error(e)}).then(null,function(e){n.root.setTimeout(function(){throw e})});return m}else if(t&&'function'===typeof t[l.iterator]){var f=t[l.iterator]();do{var _=f.next();if(_.done){m.complete();break}m.next(_.value);if(m.closed){break}}while(true)}else if(t&&'function'===typeof t[c.observable]){var h=t[c.observable]();if('function'!==typeof h.subscribe){m.error(new TypeError('Provided object does not correctly implement Symbol.observable'))}else{return h.subscribe(new d.InnerSubscriber(e,r,u))}}else{var g=a.isObject(t)?'an invalid object':'\''+t+'\'';m.error(new TypeError('You provided '+g+' where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.'))}return null}},function(e,t){'use strict';t.isArrayLike=function(e){return e&&'number'===typeof e.length}},function(e,t){'use strict';t.isPromise=function(e){return e&&'function'!==typeof e.subscribe&&'function'===typeof e.then}},function(e,t,r){'use strict';var o=r(56);function n(e){var t=e.Symbol;if('function'===typeof t){if(!t.iterator){t.iterator=t('iterator polyfill')}return t.iterator}else{var r=e.Set;if(r&&'function'===typeof new r()['@@iterator']){return'@@iterator'}var n=e.Map;if(n){for(var o=Object.getOwnPropertyNames(n.prototype),s=0,a;s<o.length;++s){a=o[s];if('entries'!==a&&'size'!==a&&n.prototype[a]===n.prototype.entries){return a}}}return'@@iterator'}}t.symbolIteratorPonyfill=n;t.iterator=n(o.root);t.$$iterator=t.iterator},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(57),s=function(e){n(t,e);function t(t,r,n){e.call(this);this.parent=t;this.outerValue=r;this.outerIndex=n;this.index=0}t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)};t.prototype._error=function(e){this.parent.notifyError(e,this);this.unsubscribe()};t.prototype._complete=function(){this.parent.notifyComplete(this);this.unsubscribe()};return t}(o.Subscriber);t.InnerSubscriber=s},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(57),s=function(e){n(t,e);function t(){e.apply(this,arguments)}t.prototype.notifyNext=function(e,t){this.destination.next(t)};t.prototype.notifyError=function(e){this.destination.error(e)};t.prototype.notifyComplete=function(){this.destination.complete()};return t}(o.Subscriber);t.OuterSubscriber=s},function(e,t){'use strict';t.identity=function(e){return e}},function(e,t,r){'use strict';var n=r(108);t.map=function(e,t){return n.map(e,t)(this)}},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(57);t.map=function(e,t){return function(r){if('function'!==typeof e){throw new TypeError('argument is not a function. Are you looking for `mapTo()`?')}return r.lift(new s(e,t))}};var s=function(){function e(e,t){this.project=e;this.thisArg=t}e.prototype.call=function(e,t){return t.subscribe(new a(e,this.project,this.thisArg))};return e}();t.MapOperator=s;var a=function(e){n(t,e);function t(t,r,n){e.call(this,t);this.project=r;this.count=0;this.thisArg=n||this}t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){this.destination.error(e);return}this.destination.next(t)};return t}(o.Subscriber)},function(e,t){'use strict';var r=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},n=function(e){r(t,e);function t(){var t=e.call(this,'object unsubscribed');this.name=t.name='ObjectUnsubscribedError';this.stack=t.stack;this.message=t.message}return t}(Error);t.ObjectUnsubscribedError=n},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(59),s=function(e){n(t,e);function t(t,r){e.call(this);this.subject=t;this.subscriber=r;this.closed=false}t.prototype.unsubscribe=function(){if(this.closed){return}this.closed=true;var e=this.subject,t=e.observers;this.subject=null;if(!t||0===t.length||e.isStopped||e.closed){return}var r=t.indexOf(this.subscriber);if(-1!==r){t.splice(r,1)}};return t}(o.Subscription);t.SubjectSubscription=s},function(e,t,r){'use strict';var n=r(112);t.interval=n.IntervalObservable.create},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(113),s=r(24),a=r(114),i=function(e){n(t,e);function t(t,r){if(void 0===t){t=0}if(void 0===r){r=a.async}e.call(this);this.period=t;this.scheduler=r;if(!o.isNumeric(t)||0>t){this.period=0}if(!r||'function'!==typeof r.schedule){this.scheduler=a.async}}t.create=function(e,r){if(void 0===e){e=0}if(void 0===r){r=a.async}return new t(e,r)};t.dispatch=function(e){var t=e.index,r=e.subscriber,n=e.period;r.next(t);if(r.closed){return}e.index+=1;this.schedule(e,n)};t.prototype._subscribe=function(e){var r=this.period,n=this.scheduler;e.add(n.schedule(t.dispatch,r,{index:0,subscriber:e,period:r}))};return t}(s.Observable);t.IntervalObservable=i},function(e,t,r){'use strict';var n=r(65);t.isNumeric=function(e){return!n.isArray(e)&&0<=e-parseFloat(e)+1}},function(e,t,r){'use strict';var n=r(115),o=r(117);t.async=new o.AsyncScheduler(n.AsyncAction)},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(56),s=r(116),a=function(e){n(t,e);function t(t,r){e.call(this,t,r);this.scheduler=t;this.work=r;this.pending=false}t.prototype.schedule=function(e,t){if(void 0===t){t=0}if(this.closed){return this}this.state=e;this.pending=true;var r=this.id,n=this.scheduler;if(null!=r){this.id=this.recycleAsyncId(n,r,t)}this.delay=t;this.id=this.id||this.requestAsyncId(n,this.id,t);return this};t.prototype.requestAsyncId=function(e,t,r){if(void 0===r){r=0}return o.root.setInterval(e.flush.bind(e,this),r)};t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r){r=0}if(null!==r&&this.delay===r&&false===this.pending){return t}return o.root.clearInterval(t)&&undefined||undefined};t.prototype.execute=function(e,t){if(this.closed){return new Error('executing a cancelled action')}this.pending=false;var r=this._execute(e,t);if(r){return r}else if(false===this.pending&&null!=this.id){this.id=this.recycleAsyncId(this.scheduler,this.id,null)}};t.prototype._execute=function(e){var t=false,r;try{this.work(e)}catch(n){t=true;r=!!n&&n||new Error(n)}if(t){this.unsubscribe();return r}};t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,r=t.actions,n=r.indexOf(this);this.work=null;this.state=null;this.pending=false;this.scheduler=null;if(-1!==n){r.splice(n,1)}if(null!=e){this.id=this.recycleAsyncId(t,e,null)}this.delay=null};return t}(s.Action);t.AsyncAction=a},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(59),s=function(e){n(t,e);function t(){e.call(this)}t.prototype.schedule=function(e,t){if(void 0===t){t=0}return this};return t}(o.Subscription);t.Action=s},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(118),s=function(e){n(t,e);function t(){e.apply(this,arguments);this.actions=[];this.active=false;this.scheduled=undefined}t.prototype.flush=function(e){var t=this.actions;if(this.active){t.push(e);return}var r;this.active=true;do{if(r=e.execute(e.state,e.delay)){break}}while(e=t.shift());this.active=false;if(r){while(e=t.shift()){e.unsubscribe()}throw r}};return t}(o.Scheduler);t.AsyncScheduler=s},function(e,t){'use strict';var r=function(){function e(t,r){if(void 0===r){r=e.now}this.SchedulerAction=t;this.now=r}e.prototype.schedule=function(e,t,r){if(void 0===t){t=0}return new this.SchedulerAction(this,e).schedule(r,t)};e.now=Date.now?Date.now:function(){return+new Date};return e}();t.Scheduler=r},function(e,t,r){'use strict';var n=r(120);t.fromPromise=n.PromiseObservable.create},function(e,t,r){'use strict';var s=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},a=r(56),i=r(24),p=function(e){s(t,e);function t(t,r){e.call(this);this.promise=t;this.scheduler=r}t.create=function(e,r){return new t(e,r)};t.prototype._subscribe=function(e){var t=this,r=this.promise,s=this.scheduler;if(null==s){if(this._isScalar){if(!e.closed){e.next(this.value);e.complete()}}else{r.then(function(r){t.value=r;t._isScalar=true;if(!e.closed){e.next(r);e.complete()}},function(t){if(!e.closed){e.error(t)}}).then(null,function(e){a.root.setTimeout(function(){throw e})})}}else{if(this._isScalar){if(!e.closed){return s.schedule(n,0,{value:this.value,subscriber:e})}}else{r.then(function(r){t.value=r;t._isScalar=true;if(!e.closed){e.add(s.schedule(n,0,{value:r,subscriber:e}))}},function(t){if(!e.closed){e.add(s.schedule(o,0,{err:t,subscriber:e}))}}).then(null,function(e){a.root.setTimeout(function(){throw e})})}}};return t}(i.Observable);t.PromiseObservable=p;function n(e){var t=e.value,r=e.subscriber;if(!r.closed){r.next(t);r.complete()}}function o(e){var t=e.err,r=e.subscriber;if(!r.closed){r.error(t)}}},function(e,t,r){'use strict';var n=r(122);t.take=function(e){return n.take(e)(this)}},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(57),s=r(123),a=r(70);t.take=function(e){return function(t){if(0===e){return new a.EmptyObservable}else{return t.lift(new i(e))}}};var i=function(){function e(e){this.total=e;if(0>this.total){throw new s.ArgumentOutOfRangeError}}e.prototype.call=function(e,t){return t.subscribe(new p(e,this.total))};return e}(),p=function(e){n(t,e);function t(t,r){e.call(this,t);this.total=r;this.count=0}t.prototype._next=function(e){var t=this.total,r=++this.count;if(r<=t){this.destination.next(e);if(r===t){this.destination.complete();this.unsubscribe()}}};return t}(o.Subscriber)},function(e,t){'use strict';var r=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},n=function(e){r(t,e);function t(){var t=e.call(this,'argument out of range');this.name=t.name='ArgumentOutOfRangeError';this.stack=t.stack;this.message=t.message}return t}(Error);t.ArgumentOutOfRangeError=n},function(e,t,r){'use strict';var n=r(125);t.filter=function(e,t){return n.filter(e,t)(this)}},function(e,t,r){'use strict';var n=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(57);t.filter=function(e,t){return function(r){return r.lift(new s(e,t))}};var s=function(){function e(e,t){this.predicate=e;this.thisArg=t}e.prototype.call=function(e,t){return t.subscribe(new a(e,this.predicate,this.thisArg))};return e}(),a=function(e){n(t,e);function t(t,r,n){e.call(this,t);this.predicate=r;this.thisArg=n;this.count=0}t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){this.destination.error(e);return}if(t){this.destination.next(e)}};return t}(o.Subscriber)},function(e,t,r){'use strict';var n=r(72);t.mergeAll=function(e){if(void 0===e){e=Number.POSITIVE_INFINITY}return n.mergeAll(e)(this)}},function(e){e.exports=require('https')}]);