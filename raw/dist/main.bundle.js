(function(e){var r={};function t(n){if(r[n]){return r[n].exports}var a=r[n]={i:n,l:false,exports:{}};e[n].call(a.exports,a,a.exports,t);a.l=true;return a.exports}t.m=e;t.c=r;t.d=function(e,r,n){if(!t.o(e,r)){Object.defineProperty(e,r,{configurable:false,enumerable:true,get:n})}};t.n=function(e){var r=e&&e.__esModule?function(){return e['default']}:function(){return e};t.d(r,'a',r);return r};t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.p='';return t(t.s=22)})([function(e){e.exports=require('util')},function(e){e.exports=require('events')},function(e,t,r){'use strict';e.exports={host:'localhost',user:'win32'===process.platform?process.env.USERNAME:process.env.USER,database:'win32'===process.platform?process.env.USERNAME:process.env.USER,password:null,connectionString:undefined,port:5432,rows:0,binary:false,max:10,idleTimeoutMillis:3e4,client_encoding:'',ssl:false,application_name:undefined,fallback_application_name:undefined,parseInputDatesAsUTC:false,statement_timeout:false};var n=r(3),a=n.getTypeParser(20,'text'),i=n.getTypeParser(1016,'text');e.exports.__defineSetter__('parseInt8',function(e){n.setTypeParser(20,'text',e?n.getTypeParser(23,'text'):a);n.setTypeParser(1016,'text',e?n.getTypeParser(1007,'text'):i)})},function(e,t,r){var a=r(26),i=r(31),o=r(12);t.getTypeParser=function(e,t){t=t||'text';if(!s[t]){return n}return s[t][e]||n};t.setTypeParser=function(e,t,r){if('function'==typeof t){r=t;t='text'}s[t][e]=r};t.arrayParser=o;var s={text:{},binary:{}};function n(e){return String(e)}a.init(function(e,t){s.text[e]=t});i.init(function(e,t){s.binary[e]=t})},function(e){e.exports=require('stream')},function(e){e.exports=require('http')},function(e){e.exports=require('path')},function(e,t,r){'use strict';const d=r(10),p=r(2);function n(e){var t=e.replace(/\\/g,'\\\\').replace(/"/g,'\\"');return'"'+t+'"'}function a(e){for(var t='{',r=0;r<e.length;r++){if(0<r){t=t+','}if(null===e[r]||'undefined'===typeof e[r]){t=t+'NULL'}else if(Array.isArray(e[r])){t=t+a(e[r])}else if(e[r]instanceof Buffer){t+='\\\\x'+e[r].toString('hex')}else{t+=n(u(e[r]))}}t=t+'}';return t}var u=function(e,t){if(e instanceof Buffer){return e}if(ArrayBuffer.isView(e)){var r=Buffer.from(e.buffer,e.byteOffset,e.byteLength);if(r.length===e.byteLength){return r}return r.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(e instanceof Date){if(p.parseInputDatesAsUTC){return l(e)}else{return s(e)}}if(Array.isArray(e)){return a(e)}if(null===e||'undefined'===typeof e){return null}if('object'===typeof e){return i(e,t)}return e.toString()};function i(e,t){if(e&&'function'===typeof e.toPostgres){t=t||[];if(-1!==t.indexOf(e)){throw new Error('circular reference detected while preparing "'+e+'" for query')}t.push(e);return u(e.toPostgres(u),t)}return JSON.stringify(e)}function o(e,t){e=''+e;while(e.length<t){e='0'+e}return e}function s(e){var t=-e.getTimezoneOffset(),r=o(e.getFullYear(),4)+'-'+o(e.getMonth()+1,2)+'-'+o(e.getDate(),2)+'T'+o(e.getHours(),2)+':'+o(e.getMinutes(),2)+':'+o(e.getSeconds(),2)+'.'+o(e.getMilliseconds(),3);if(0>t){r+='-';t*=-1}else{r+='+'}return r+o(Math.floor(t/60),2)+':'+o(t%60,2)}function l(e){var t=o(e.getUTCFullYear(),4)+'-'+o(e.getUTCMonth()+1,2)+'-'+o(e.getUTCDate(),2)+'T'+o(e.getUTCHours(),2)+':'+o(e.getUTCMinutes(),2)+':'+o(e.getUTCSeconds(),2)+'.'+o(e.getUTCMilliseconds(),3);return t+'+00:00'}const c=function(e){return d.createHash('md5').update(e,'utf-8').digest('hex')};e.exports={prepareValue:function(e){return u(e)},normalizeQueryConfig:function(e,t,r){e='string'===typeof e?{text:e}:e;if(t){if('function'===typeof t){e.callback=t}else{e.values=t}}if(r){e.callback=r}return e},postgresMd5PasswordHash:function(e,t,r){var n=c(t+e),a=c(Buffer.concat([Buffer.from(n),r]));return'md5'+a},md5:c}},function(e){e.exports=require('string_decoder')},function(e,t,r){'use strict';var n=r(0),a=r(25),i=r(2),o=r(15),s=r(47);const l=(e)=>{var t=function(t){var r=Object.assign({Client:e},t);return new s(r)};n.inherits(t,s);return t};var d=function(e){this.defaults=i;this.Client=e;this.Query=this.Client.Query;this.Pool=l(this.Client);this._pools=[];this.Connection=o;this.types=r(3)};if('undefined'!==typeof process.env.NODE_PG_FORCE_NATIVE){e.exports=new d(r(17))}else{e.exports=new d(a);e.exports.__defineGetter__('native',function(){delete e.exports.native;var t=null;try{t=new d(r(17))}catch(e){if('MODULE_NOT_FOUND'!==e.code){throw e}console.error(e.message)}e.exports.native=t;return t})}},function(e){e.exports=require('crypto')},function(e,t){'use strict';t.parse=function(e,t){return new r(e,t).parse()};function r(e,t){this.source=e;this.transform=t||n;this.position=0;this.entries=[];this.recorded=[];this.dimension=0}r.prototype.isEof=function(){return this.position>=this.source.length};r.prototype.nextCharacter=function(){var e=this.source[this.position++];if('\\'===e){return{value:this.source[this.position++],escaped:true}}return{value:e,escaped:false}};r.prototype.record=function(e){this.recorded.push(e)};r.prototype.newEntry=function(e){var t;if(0<this.recorded.length||e){t=this.recorded.join('');if('NULL'===t&&!e){t=null}if(null!==t)t=this.transform(t);this.entries.push(t);this.recorded=[]}};r.prototype.parse=function(e){var t,n,a;while(!this.isEof()){t=this.nextCharacter();if('{'===t.value&&!a){this.dimension++;if(1<this.dimension){n=new r(this.source.substr(this.position-1),this.transform);this.entries.push(n.parse(true));this.position+=n.position-2}}else if('}'===t.value&&!a){this.dimension--;if(!this.dimension){this.newEntry();if(e)return this.entries}}else if('"'===t.value&&!t.escaped){if(a)this.newEntry(true);a=!a}else if(','===t.value&&!a){this.newEntry()}else{this.record(t.value)}}if(0!==this.dimension){throw new Error('array dimension not balanced')}return this.entries};function n(e){return e}},function(e,t,r){var n=r(11);e.exports={create:function(e,t){return{parse:function(){return n.parse(e,t)}}}}},function(e,t,r){'use strict';var a=r(3);function n(e){this._types=e||a;this.text={};this.binary={}}n.prototype.getOverrides=function(e){switch(e){case'text':return this.text;case'binary':return this.binary;default:return{};}};n.prototype.setTypeParser=function(e,t,r){if('function'===typeof t){r=t;t='text'}this.getOverrides(t)[e]=r};n.prototype.getTypeParser=function(e,t){t=t||'text';return this.getOverrides(t)[e]||this._types.getTypeParser(e,t)};e.exports=n},function(e,t,r){'use strict';var n=r(37),a=r(2),i=r(38).parse,o=function(e,t,r){if(r===undefined){r=process.env['PG'+e.toUpperCase()]}else if(!(false===r)){r=process.env[r]}return t[e]||r||a[e]},s=function(){switch(process.env.PGSSLMODE){case'disable':return false;case'prefer':case'require':case'verify-ca':case'verify-full':return true;}return a.ssl},l=function(e){e='string'===typeof e?i(e):e||{};if(e.connectionString){e=Object.assign({},e,i(e.connectionString))}this.user=o('user',e);this.database=o('database',e);this.port=parseInt(o('port',e),10);this.host=o('host',e);this.password=o('password',e);this.binary=o('binary',e);this.ssl='undefined'===typeof e.ssl?s():e.ssl;this.client_encoding=o('client_encoding',e);this.replication=o('replication',e);this.isDomainSocket=!(this.host||'').indexOf('/');this.application_name=o('application_name',e,'PGAPPNAME');this.fallback_application_name=o('fallback_application_name',e,false);this.statement_timeout=o('statement_timeout',e,false)},d=function(e){return'\''+(''+e).replace(/\\/g,'\\\\').replace(/'/g,'\\\'')+'\''},p=function(e,t,r){var n=t[r];if(n){e.push(r+'='+d(n))}};l.prototype.getLibpqConnectionString=function(e){var t=[];p(t,this,'user');p(t,this,'password');p(t,this,'port');p(t,this,'application_name');p(t,this,'fallback_application_name');var r='object'===typeof this.ssl?this.ssl:{sslmode:this.ssl};p(t,r,'sslmode');p(t,r,'sslca');p(t,r,'sslkey');p(t,r,'sslcert');p(t,r,'sslrootcert');if(this.database){t.push('dbname='+d(this.database))}if(this.replication){t.push('replication='+d(this.replication))}if(this.host){t.push('host='+d(this.host))}if(this.isDomainSocket){return e(null,t.join(' '))}if(this.client_encoding){t.push('client_encoding='+d(this.client_encoding))}n.lookup(this.host,function(r,n){if(r)return e(r,null);t.push('hostaddr='+d(n));return e(null,t.join(' '))})};e.exports=l},function(e,t,r){'use strict';var n=r(43),a=r(1).EventEmitter,i=r(0),o=r(44),s=r(45),l=0,d=function(e){a.call(this);e=e||{};this.stream=e.stream||new n.Stream;this._keepAlive=e.keepAlive;this.lastBuffer=false;this.lastOffset=0;this.buffer=null;this.offset=null;this.encoding=e.encoding||'utf8';this.parsedStatements={};this.writer=new o;this.ssl=e.ssl||false;this._ending=false;this._mode=l;this._emitMessage=false;this._reader=new s({headerSize:1,lengthPadding:-4});var t=this;this.on('newListener',function(e){if('message'===e){t._emitMessage=true}})};i.inherits(d,a);d.prototype.connect=function(e,t){if('closed'===this.stream.readyState){this.stream.connect(e,t)}else if('open'===this.stream.readyState){this.emit('connect')}var n=this;this.stream.on('connect',function(){if(n._keepAlive){n.stream.setKeepAlive(true)}n.emit('connect')});this.stream.on('error',function(e){if(n._ending&&'ECONNRESET'===e.code){return}n.emit('error',e)});this.stream.on('close',function(){n.emit('end')});if(!this.ssl){return this.attachListeners(this.stream)}this.stream.once('data',function(e){var a=e.toString('utf8');if('S'!==a){return n.emit('error',new Error('The server does not support SSL connections'))}var i=r(46);n.stream=i.connect({socket:n.stream,servername:t,rejectUnauthorized:n.ssl.rejectUnauthorized,ca:n.ssl.ca,pfx:n.ssl.pfx,key:n.ssl.key,passphrase:n.ssl.passphrase,cert:n.ssl.cert,NPNProtocols:n.ssl.NPNProtocols});n.attachListeners(n.stream);n.emit('sslconnect');n.stream.on('error',function(e){n.emit('error',e)})})};d.prototype.attachListeners=function(e){var t=this;e.on('data',function(e){t._reader.addChunk(e);var r=t._reader.read();while(r){var n=t.parseMessage(r);if(t._emitMessage){t.emit('message',n)}t.emit(n.name,n);r=t._reader.read()}});e.on('end',function(){t.emit('end')})};d.prototype.requestSsl=function(){var e=this.writer.addInt16(1234).addInt16(5679).flush(),t=e.length+4,r=new o().addInt32(t).add(e).join();this.stream.write(r)};d.prototype.startup=function(e){var t=this.writer.addInt16(3).addInt16(0);Object.keys(e).forEach(function(r){var n=e[r];t.addCString(r).addCString(n)});t.addCString('client_encoding').addCString('\'utf-8\'');var r=t.addCString('').flush(),n=r.length+4,a=new o().addInt32(n).add(r).join();this.stream.write(a)};d.prototype.cancel=function(e,t){var r=this.writer.addInt16(1234).addInt16(5678).addInt32(e).addInt32(t).flush(),n=r.length+4,a=new o().addInt32(n).add(r).join();this.stream.write(a)};d.prototype.password=function(e){this._send(112,this.writer.addCString(e))};d.prototype._send=function(e,t){if(!this.stream.writable){return false}if(true===t){this.writer.addHeader(e)}else{return this.stream.write(this.writer.flush(e))}};d.prototype.query=function(e){this.stream.write(this.writer.addCString(e).flush(81))};d.prototype.parse=function(e,t){e.name=e.name||'';if(63<e.name.length){console.error('Warning! Postgres only supports 63 characters for query names.');console.error('You supplied',e.name,'(',e.name.length,')');console.error('This can cause conflicts and silent errors executing queries')}e.types=e.types||[];for(var r=e.types.length,n=this.writer.addCString(e.name).addCString(e.text).addInt16(r),a=0;a<r;a++){n.addInt32(e.types[a])}this._send(80,t)};d.prototype.bind=function(e,t){e=e||{};e.portal=e.portal||'';e.statement=e.statement||'';e.binary=e.binary||false;for(var r=e.values||[],n=r.length,a=false,o=0;o<n;o++){a|=r[o]instanceof Buffer}var s=this.writer.addCString(e.portal).addCString(e.statement);if(!a){s.addInt16(0)}else{s.addInt16(n);for(o=0;o<n;o++){s.addInt16(r[o]instanceof Buffer)}}s.addInt16(n);for(var l=0,i;l<n;l++){i=r[l];if(null===i||'undefined'===typeof i){s.addInt32(-1)}else if(i instanceof Buffer){s.addInt32(i.length);s.add(i)}else{s.addInt32(Buffer.byteLength(i));s.addString(i)}}if(e.binary){s.addInt16(1);s.addInt16(1)}else{s.addInt16(0)}this._send(66,t)};d.prototype.execute=function(e,t){e=e||{};e.portal=e.portal||'';e.rows=e.rows||'';this.writer.addCString(e.portal).addInt32(e.rows);this._send(69,t)};var p=Buffer.alloc(0);d.prototype.flush=function(){this.writer.add(p);this._send(72)};d.prototype.sync=function(){this.writer.flush(0);this.writer.add(p);this._ending=true;this._send(83)};const u=Buffer.from([88,0,0,0,4]);d.prototype.end=function(){this.writer.add(p);this._ending=true;return this.stream.write(u)};d.prototype.close=function(e,t){this.writer.addCString(e.type+(e.name||''));this._send(67,t)};d.prototype.describe=function(e,t){this.writer.addCString(e.type+(e.name||''));this._send(68,t)};d.prototype.sendCopyFromChunk=function(e){this.stream.write(this.writer.add(e).flush(100))};d.prototype.endCopyFrom=function(){this.stream.write(this.writer.add(p).flush(99))};d.prototype.sendCopyFail=function(e){this.writer.addCString(e);this._send(102)};var c=function(e,t){this.name=e;this.length=t};d.prototype.parseMessage=function(e){this.offset=0;var t=e.length+4;switch(this._reader.header){case 82:return this.parseR(e,t);case 83:return this.parseS(e,t);case 75:return this.parseK(e,t);case 67:return this.parseC(e,t);case 90:return this.parseZ(e,t);case 84:return this.parseT(e,t);case 68:return this.parseD(e,t);case 69:return this.parseE(e,t);case 78:return this.parseN(e,t);case 49:return new c('parseComplete',t);case 50:return new c('bindComplete',t);case 51:return new c('closeComplete',t);case 65:return this.parseA(e,t);case 110:return new c('noData',t);case 73:return new c('emptyQuery',t);case 115:return new c('portalSuspended',t);case 71:return this.parseG(e,t);case 72:return this.parseH(e,t);case 87:return new c('replicationStart',t);case 99:return new c('copyDone',t);case 100:return this.parsed(e,t);}};d.prototype.parseR=function(e,t){var r=0,n=new c('authenticationOk',t);if(8===n.length){r=this.parseInt32(e);if(3===r){n.name='authenticationCleartextPassword'}return n}if(12===n.length){r=this.parseInt32(e);if(5===r){n.name='authenticationMD5Password';n.salt=Buffer.alloc(4);e.copy(n.salt,0,this.offset,this.offset+4);this.offset+=4;return n}}throw new Error('Unknown authenticationOk message type'+i.inspect(n))};d.prototype.parseS=function(e,t){var r=new c('parameterStatus',t);r.parameterName=this.parseCString(e);r.parameterValue=this.parseCString(e);return r};d.prototype.parseK=function(e,t){var r=new c('backendKeyData',t);r.processID=this.parseInt32(e);r.secretKey=this.parseInt32(e);return r};d.prototype.parseC=function(e,t){var r=new c('commandComplete',t);r.text=this.parseCString(e);return r};d.prototype.parseZ=function(e,t){var r=new c('readyForQuery',t);r.name='readyForQuery';r.status=this.readString(e,1);return r};d.prototype.parseT=function(e,t){var r=new c('rowDescription',t);r.fieldCount=this.parseInt16(e);for(var n=[],a=0;a<r.fieldCount;a++){n.push(this.parseField(e))}r.fields=n;return r};var m=function(){this.name=null;this.tableID=null;this.columnID=null;this.dataTypeID=null;this.dataTypeSize=null;this.dataTypeModifier=null;this.format=null};d.prototype.parseField=function(e){var t=new m;t.name=this.parseCString(e);t.tableID=this.parseInt32(e);t.columnID=this.parseInt16(e);t.dataTypeID=this.parseInt32(e);t.dataTypeSize=this.parseInt16(e);t.dataTypeModifier=this.parseInt32(e);if(this.parseInt16(e)===l){this._mode=l;t.format='text'}else{this._mode=1;t.format='binary'}return t};var g=function(e,t){this.name='dataRow';this.length=e;this.fieldCount=t;this.fields=[]};d.prototype.parseD=function(e,t){for(var r=this.parseInt16(e),n=new g(t,r),a=0;a<r;a++){n.fields.push(this._readValue(e))}return n};d.prototype._readValue=function(e){var t=this.parseInt32(e);if(-1===t)return null;if(this._mode===l){return this.readString(e,t)}return this.readBytes(e,t)};d.prototype.parseE=function(e,t){var r={},n,a,i=new c('error',t),o=this.readString(e,1);while('\0'!==o){r[o]=this.parseCString(e);o=this.readString(e,1)}if('error'===i.name){n=new Error(r.M);for(a in i){if(i.hasOwnProperty(a)){n[a]=i[a]}}}else{n=i;n.message=r.M}n.severity=r.S;n.code=r.C;n.detail=r.D;n.hint=r.H;n.position=r.P;n.internalPosition=r.p;n.internalQuery=r.q;n.where=r.W;n.schema=r.s;n.table=r.t;n.column=r.c;n.dataType=r.d;n.constraint=r.n;n.file=r.F;n.line=r.L;n.routine=r.R;return n};d.prototype.parseN=function(e,t){var r=this.parseE(e,t);r.name='notice';return r};d.prototype.parseA=function(e,t){var r=new c('notification',t);r.processId=this.parseInt32(e);r.channel=this.parseCString(e);r.payload=this.parseCString(e);return r};d.prototype.parseG=function(e,t){var r=new c('copyInResponse',t);return this.parseGH(e,r)};d.prototype.parseH=function(e,t){var r=new c('copyOutResponse',t);return this.parseGH(e,r)};d.prototype.parseGH=function(e,t){var r=0!==e[this.offset];this.offset++;t.binary=r;var n=this.parseInt16(e);t.columnTypes=[];for(var a=0;a<n;a++){t.columnTypes.push(this.parseInt16(e))}return t};d.prototype.parsed=function(e,t){var r=new c('copyData',t);r.chunk=this.readBytes(e,r.length-4);return r};d.prototype.parseInt32=function(e){var t=e.readInt32BE(this.offset,true);this.offset+=4;return t};d.prototype.parseInt16=function(e){var t=e.readInt16BE(this.offset,true);this.offset+=2;return t};d.prototype.readString=function(e,t){return e.toString(this.encoding,this.offset,this.offset+=t)};d.prototype.readBytes=function(e,t){return e.slice(this.offset,this.offset+=t)};d.prototype.parseCString=function(e){var t=this.offset,r=e.indexOf(0,t);this.offset=r+1;return e.toString(this.encoding,t,r)};e.exports=d},function(e){e.exports=require('assert')},function(e,t,r){'use strict';e.exports=r(48)},function(e){'use strict';e.exports=function(e,t,r){const n=r&&r.twoArgs;return new Promise(function(r,a){e.call(t,function(e,t,i){if(e){a(e);return}if(n){r([t,i])}else{r(t)}})})}},function(e,t,r){'use strict';var a=r(18),i=r(20),o=r(21);function n(e,t,r){this._query=e;this.oid=t;this._fd=r}n.SEEK_SET=0;n.SEEK_CUR=1;n.SEEK_END=2;n.prototype.close=function(e){this._query({name:'npg_lo_close',text:'SELECT lo_close($1) as ok',values:[this._fd]},e?function(t){e(t)}:undefined)};n.prototype.closeAsync=function(){return a(function(e){this.close(e)},this)};n.prototype.read=function(e,t){this._query({name:'npg_loread',text:'SELECT loread($1, $2) as data',values:[this._fd,e]},function(e,r){if(e)return t(e);var n=r.rows[0].data;t(null,n)})};n.prototype.readAsync=function(e){return a(function(t){this.read(e,t)},this)};n.prototype.write=function(e,t){this._query({name:'npg_lowrite',text:'SELECT lowrite($1, $2)',values:[this._fd,e]},t?function(e){t(e)}:undefined)};n.prototype.writeAsync=function(e){return a(function(t){this.write(e,t)},this)};n.prototype.seek=function(e,t,r){this._query({name:'npg_lo_lseek64',text:'SELECT lo_lseek64($1, $2, $3) as location',values:[this._fd,e,t]},r?function(e,t){if(e)return r(e);var n=t.rows[0].location;r(null,n)}:undefined)};n.prototype.seekAsync=function(e,t){return a(function(r){this.seek(e,t,r)},this)};n.prototype.tell=function(e){this._query({name:'npg_lo_tell64',text:'SELECT lo_tell64($1) as location',values:[this._fd]},function(t,r){if(t)return e(t);var n=r.rows[0].location;e(null,n)})};n.prototype.tellAsync=function(){return a(function(e){this.tell(e)},this)};n.prototype.size=function(e){this._query({name:'npg_size',text:'SELECT lo_lseek64($1, location, 0), seek.size FROM (SELECT lo_lseek64($1, 0, 2) AS SIZE, tell.location FROM (SELECT lo_tell64($1) AS location) tell) seek;',values:[this._fd]},function(t,r){if(t)return e(t);var n=r.rows[0].size;e(null,n)})};n.prototype.sizeAsync=function(){return a(function(e){this.size(e)},this)};n.prototype.truncate=function(e,t){this._query({name:'npg_lo_truncate64',text:'SELECT lo_truncate64($1, $2)',values:[this._fd,e]},t?function(e){t(e)}:undefined)};n.prototype.truncateAsync=function(e){return a(function(t){this.truncate(e,t)},this)};n.prototype.getReadableStream=function(e){return new i(this,e)};n.prototype.getWritableStream=function(e){return new o(this,e)};e.exports=n},function(e,t,r){'use strict';var a=r(4);function n(e,t){a.Readable.call(this,{highWaterMark:t||16384,encoding:null,objectMode:false});this._largeObject=e}n.prototype=Object.create(a.Readable.prototype);n.prototype._read=function(e){if(0>=e){throw'Illegal Argument'}this._largeObject.read(e,function(t,r){if(t){this.emit('error',t);return}this.push(r);if(r.length<e){this.push(null)}}.bind(this))};e.exports=n},function(e,t,r){'use strict';var a=r(4);function n(e,t){a.Writable.call(this,{highWaterMark:t||16384,decodeStrings:true,objectMode:false});this._largeObject=e}n.prototype=Object.create(a.Writable.prototype);n.prototype._write=function(e,t,r){if(!Buffer.isBuffer(e)){throw'Illegal Argument'}this._largeObject.write(e,r)};e.exports=n},function(e,t,r){e.exports=r(23)},function(e,t,r){'use strict';var s=Math.min,l=Number.isNaN,d=Math.max;Object.defineProperty(t,'__esModule',{value:true});var p=r(5),u=r.n(p);class c extends Error{constructor(e,t,r){if(t instanceof Error){r=t;t=r.message}if(r===undefined){r=new Error(t||'Unknown internal server error')}if(!t||500<=e){t=p.STATUS_CODES[e]||'Undefined error'}super(t);this.status=e;this.originError=r}}var m=r(8),g=r.n(m),f=r(24),y=r.n(f);class h{constructor(e,t){this.req=e;this.ctx=t}getHeader(e){let t=this.req.headers[e.toLowerCase()];return Array.isArray(t)?t.join(';'):t}get socket(){return this.req.socket}get ip(){return this.getHeader('X-Real-IP')||this.getHeader('X-Forwarded-For')||this.req.connection.remoteAddress||''}get host(){let e=this.getHeader('X-Forwarded-Host')||this.getHeader('Host');return e&&e.split(/\s*,\s*/)[0]||''}get hostname(){if(!this.host)return'';if('['===this.host[0]){let e=/^\[[a-f0-9:]+\]/.exec(this.host);return e&&e[0]||''}return this.host.split(':')[0]||''}get port(){let e=/\:([0-9]+)$/.exec(this.host);return e&&~~e[1]||80}get method(){return(this.req.method||'').toUpperCase()}get path(){return this.req.url||''}get pathname(){return(this.req.url||'').split('?')[0].split(/\/+/).filter((e)=>!!e)}get query(){let e=(this.req.url||'').split('?').slice(1).join('?');return Object(f.parse)(e)}get type(){let e=this.getHeader('Content-Type');if('string'!==typeof e)return;return e.split(';')[0].trim()}get length(){return~~(this.getHeader('content-length')||'')}async raw(){const e=this.length;return new Promise((t,r)=>{let n=Buffer.alloc(0);const a=()=>{d();r(new c(400,'Request aborted'))},i=()=>{d();r(new c(400,'Receive data error'))},o=(e)=>{n=Buffer.concat([n,e])},s=()=>{d();if(0<e&&n.length!==e){r(new c(400,'Request size did not match content length'))}t(n)},l=()=>{d()};var d=()=>{this.req.removeListener('aborted',a);this.req.removeListener('end',i);this.req.removeListener('data',o);this.req.removeListener('error',s);this.req.removeListener('close',l);this.req.unpipe()};this.req.on('aborted',a);this.req.on('error',i);this.req.on('data',o);this.req.on('end',s);this.req.on('close',l)})}async text(){let e=await this.raw();try{let t=new m.StringDecoder('utf8');return t.end(e)}catch(e){throw new c(400,'Receive data is not a UTF8 string',e)}}async json(){if('application/json'!==this.type){throw new c(400,'Only application/json data are allowed')}let e=await this.text();try{return JSON.parse(e)}catch(e){throw new c(400,'Invalid json received')}}valueOf(){return{heders:this.req.headers,ip:this.ip,host:this.host,hostname:this.hostname,port:this.port,method:this.method,path:this.path,pathname:this.pathname,query:this.query,type:this.type,length:this.length}}toJSON(){return this.valueOf()}}var b=r(6),_=r.n(b),E=[{mime:'image/jpeg',extension:'jpg',offset:0,header:new Uint8Array([255,216,255])},{mime:'image/png',extension:'png',offset:0,header:new Uint8Array([137,80,78,71,13,10,26,10])},{mime:'image/gif',extension:'gif',offset:0,header:new Uint8Array([71,73,70])},{mime:'image/webp',extension:'webp',offset:8,header:new Uint8Array([87,69,66,80])}];const v=/<!--([\s\S]*?)-->/g,I=/^\s*(?:<\?xml[^>]*>\s*)?(?:<!doctype svg[^>]*\s*(?:<![^>]*>)*[^>]*>\s*)?<svg[^>]*>[^]*<\/svg>\s*$/i,T=(e)=>{for(let t=0;24>t;t++)if(65533===e[t]||8>=e[t])return true;return false};var S=(e)=>!T(e)&&I.test(e.toString().replace(v,''));class x{constructor(e){const t=e instanceof Uint8Array?e:new Uint8Array(e);if(1>=t.length)return this;for(let r of E)if(this.check(t,r.header,r.offset)){this.mime=r.mime;this.extension=r.extension;return this}if(S(t)){this.mime='image/svg+xml';this.extension='svg';return this}this.mime='application/octet-stream';this.extension=''}check(e,t,r=0){for(let n=0;n<t.length;n++)if(t[n]!==e[n+r])return false;return true}toJSON(){return{extension:this.extension,mime:this.mime}}toString(){return this.mime}[Symbol.toPrimitive](e){switch(e){case'number':throw new TypeError('Cannot convert a FileType value to a number value');case'string':case'default':return this.mime;default:throw new TypeError('Cannot convert a FileType value to unknown value');}}[Symbol.toStringTag](){return'FileType'}}class R{constructor(e,t){this.res=e;this.ctx=t;this.set(404)}get finished(){return this.res.finished}hasHeader(e){return this.res.hasHeader(e)}getHeader(e){let t=this.res.getHeader(e);return Array.isArray(t)?t.join(';'):t}setHeader(e,t){this.res.setHeader(e,t)}removeHeader(e){return this.res.removeHeader(e)}flushHeaders(){return this.res.flushHeaders()}get type(){let e=this.getHeader('Content-Type');if('string'!==typeof e)return;return e.split(';')[0].trim()}get length(){return~~(this.getHeader('Content-Length')||'')}get status(){return this.res.statusCode}get body(){return this._body}set(e,t){if(this.finished)return;if(this.res.headersSent)throw new Error('Headears was sended');if('number'!==typeof e){t=e;e=undefined}if(t===undefined||null===t){this.res.statusCode=e||404;this._body=p.STATUS_CODES[this.res.statusCode];this.removeHeader('Content-Type');this.removeHeader('Content-Length');this.removeHeader('Transfer-Encoding');return}if(null===t){this.res.statusCode=e||204;this._body=null;this.removeHeader('Content-Type');this.removeHeader('Content-Length');this.removeHeader('Transfer-Encoding');return}this.res.statusCode=e||200;if('string'===typeof t){this._body=t;this.setHeader('Content-Type',(/^\s*</.test(t)?'text/html':'text/plain')+'; charset=utf-8');this.setHeader('Content-Length',Buffer.byteLength(t));return}if(Buffer.isBuffer(t)){let e=new x(t);this._body=t;this.setHeader('Content-Type',e.mime||'application/octet-stream');this.setHeader('Content-Length',t.length);let r='inline';const n=Object(b.parse)(this.ctx.request.path);if(n.name){const t=e.extension||n.ext||'';if(t)r+=`; filename=${n.name}.${t}`}this.setHeader('Content-Disposition',r);return}if('object'===typeof t){let e=JSON.stringify(t);this._body=e;this.setHeader('Content-Type','application/json; charset=utf-8');this.setHeader('Content-Length',Buffer.byteLength(e));return}throw TypeError('Unknown response body type')}respond(){if(this.finished)return;if(null===this._body||this._body===undefined){this.res.end()}else{this.res.end(this._body)}}end(e,t){this.set(e,t);this.respond()}valueOf(){return{heders:this.res.getHeaders(),status:this.status,type:this.type,length:this.length,body:this.body}}toJSON(){return this.valueOf()}}var w=r(0),C=r.n(w);function n(e,t){if(!e.status||500<=e.status)console.error('\x1B[31m=== Internal context error ===\n',e,'\x1B[0m\n=== with Context ===\n',t===undefined?undefined:Object(w.inspect)(t.valueOf(),{depth:3,colors:true}))}class D{constructor(e,t){try{this.request=new h(e,this);this.response=new R(t,this)}catch(e){this.throw(e)}}get finished(){return this.response.finished}set(e,t){this.response.set(e,t)}respond(){this.response.respond()}end(e,t){this.response.end(e,t)}throw(e){if(e instanceof c)this.end(e.status,e.message);else this.end(500);n(e,this)}valueOf(){return{request:this.request.valueOf(),response:this.response.valueOf()}}toJSON(){return this.valueOf()}}function a(e){return async function(t,r=()=>Promise.resolve()){let n=-1;const a=(o)=>async()=>{if(o<=n){throw new Error('next() called multiple times')}n=o;if(o>=e.length){return await r()}await e[o].call(this,t,a(o+1))};await a(0)()}}class O extends Function{constructor(e){super('throw new TypeError("CallableClass was called")');return Object.setPrototypeOf(e,new.target.prototype)}}class P extends O{constructor(){super(async(e,t)=>await this.main(e,t))}async main(e,t){await t()}}class A extends Array{static get(e){return this.List.get(e)||new A}static set(e,t){this.List.set(e,t)}}A.List=new WeakMap;const k=/^\*+$/,L=/^\:+(.*)$/,N=/^[a-z][a-z0-9]*$/i,M=(e)=>e.replace(/([.+*?=^!:${}()[\]|/\\])/g,'\\$1');class j{constructor(e=''){this.keys=['*'];let t=e.split(/\s*\/\s*/).filter((e)=>e.length).map((e)=>{if(k.test(e))return'[^/]+';let t=L.exec(e);if(!t)return M(e);let r=t[1];if(!N.test(r))throw TypeError(`Key name "${r}" does not match "${N.source}" pattern`);this.keys.push(r);return'([^/]+)'}).join('(?:/+)');this.pattern=new RegExp('^(?:/+)?'+t+'(?:/+)?$')}exec(e=''){let t=this.pattern.exec(e);if(!t)return;return t.reduce((e,t,r)=>{e[this.keys[r]]=t;return e},{})}}function i(e,t,r,n){const a=new j(t);return async function(i,o){const s=i.route;if(!s)return await o();if(s.finished)return await o();if(s.method!==e||'HEAD'===s.method&&'GET'!==e)return await o();const l=a.exec(s.pathname);if(!l)return await o();for(let e of r)if(!(e in s.query))return await o();s.data=l;i.debug('=== Route %s [%s] ===\n%s %s => %s\nData: %s\nQuery: %s',s.method,s.path,t,r,n,s.data,s.query);await this[n](i,o)}}function o(e,t='',...r){return(n,a)=>{if('symbol'===typeof a)throw new TypeError('Property name must be a string');let o=A.get(n.constructor);o.push(i(e,t,r,a));A.set(n.constructor,o)}}const q=(e,...t)=>o('GET',e,...t);class U{constructor(e){this.finished=false;this.data={};this.method=e.request.method;this.path=e.request.path;this.pathname='/'+e.request.pathname.join('/');this.query=e.request.query}valueOf(){return{method:this.method,path:this.path,pathname:this.pathname,query:this.query,finished:this.finished,data:this.data}}toJSON(){return this.valueOf()}}const F=Symbol('Route');class Q extends P{constructor(e=U){super();this.BaseClass=e;this[F]=a(A.get(this.constructor))}async main(e,t){e.route=new this.BaseClass(e);return this[F].call(this,e,t)}}const G=process.env.SERVICE_HOSTNAME||'0.0.0.0',H=d(~~(process.env.SERVICE_PORT||'')||0,0)||80,z=d(~~(process.env.SERVICE_TIMEOUT||'')||0,0)||120,V=d(~~(process.env.SERVICE_KEEP_ALIVE||'')||0,0)||5,B=(process.env.NODE_DEBUG||'').split(/\s*,\s*/).map((e)=>e.toLowerCase().trim()).filter((e)=>!!e);class $ extends P{constructor(){super(...arguments);this.enable=B.includes('service'.toLowerCase())}log(...e){let t=e.shift();e=e.map((e)=>Object(w.inspect)(e&&e.valueOf instanceof Function?e.valueOf():e,{depth:3,colors:true}));console.log(t,...e)}async main(e,t){e.debug=this.enable?(...e)=>this.log(...e):()=>undefined;e.debug('=== Input context ===\n%s',e);await t();e.debug('=== Output context ===\n%s',e)}}class X extends p.Server{constructor(...e){super();e.unshift(new $);const t=a(e.map((e)=>e));this.on('request',(e,r)=>{const a=new D(e,r);t(a,()=>Promise.resolve()).then(()=>a.respond()).catch((e)=>{n(e,a);try{a.throw(e)}catch(e){}})});this.on('clientError',(e,t)=>{t.end('HTTP/1.1 400 Bad Request\r\n\r\n');n(e)});this.timeout=z;this.keepAliveTimeout=V;this.listen(H,G,()=>{const e=this.address();console.log(`Opened HTTP server on ${e.address}:${e.port}`)})}}var W=r(9),Y=r.n(W);const K=process.env.POSTGRES_HOST||'localhost',Z=d(~~(process.env.POSTGRES_PORT||''),0)||5432,J=process.env.POSTGRES_DB||'postgres',ee=process.env.POSTGRES_USER||'postgres',te=process.env.POSTGRES_PASSWORD||'',re=d(~~(process.env.POSTGRES_IDLE_TIMEOUT||'')||0,0)||10,ne=d(~~(process.env.POSTGRES_POOL_SIZE||'')||0,0)||10,ae=new W.Pool({host:K,port:Z,user:ee,password:te,database:J,idleTimeoutMillis:1e3*re,max:ne});var ie=r(10),oe=r.n(ie),se=ie.randomBytes;const le=['00','01','02','03','04','05','06','07','08','09','0a','0b','0c','0d','0e','0f','10','11','12','13','14','15','16','17','18','19','1a','1b','1c','1d','1e','1f','20','21','22','23','24','25','26','27','28','29','2a','2b','2c','2d','2e','2f','30','31','32','33','34','35','36','37','38','39','3a','3b','3c','3d','3e','3f','40','41','42','43','44','45','46','47','48','49','4a','4b','4c','4d','4e','4f','50','51','52','53','54','55','56','57','58','59','5a','5b','5c','5d','5e','5f','60','61','62','63','64','65','66','67','68','69','6a','6b','6c','6d','6e','6f','70','71','72','73','74','75','76','77','78','79','7a','7b','7c','7d','7e','7f','80','81','82','83','84','85','86','87','88','89','8a','8b','8c','8d','8e','8f','90','91','92','93','94','95','96','97','98','99','9a','9b','9c','9d','9e','9f','a0','a1','a2','a3','a4','a5','a6','a7','a8','a9','aa','ab','ac','ad','ae','af','b0','b1','b2','b3','b4','b5','b6','b7','b8','b9','ba','bb','bc','bd','be','bf','c0','c1','c2','c3','c4','c5','c6','c7','c8','c9','ca','cb','cc','cd','ce','cf','d0','d1','d2','d3','d4','d5','d6','d7','d8','d9','da','db','dc','dd','de','df','e0','e1','e2','e3','e4','e5','e6','e7','e8','e9','ea','eb','ec','ed','ee','ef','f0','f1','f2','f3','f4','f5','f6','f7','f8','f9','fa','fb','fc','fd','fe','ff'];var de=(e)=>le[e[0]]+le[e[1]]+le[e[2]]+le[e[3]]+'-'+le[e[4]]+le[e[5]]+'-'+le[e[6]]+le[e[7]]+'-'+le[e[8]]+le[e[9]]+'-'+le[e[10]]+le[e[11]]+le[e[12]]+le[e[13]]+le[e[14]]+le[e[15]];const pe=se(16),ue=[1|pe[0],pe[1],pe[2],pe[3],pe[4],pe[5]];let ce=16383&(pe[6]<<8|pe[7]),me=0,ge=0;var fe=()=>{let e=new Date().getTime(),t=ge+1,r=e-me+(t-ge)/1e4,n=0>r?16383&ce+1:ce;if(0>r||e>me){t=0}if(1e4<=t)throw new Error('uuid.v1(): Can\'t create more than 10M uuids/sec');me=e;ge=t;ce=n;e+=1.22192928e13;let a=0,i=new Uint8Array(16),o=(1e4*(268435455&e)+t)%4294967296;i[a++]=255&o>>>24;i[a++]=255&o>>>16;i[a++]=255&o>>>8;i[a++]=255&o;let s=268435455&1e4*(e/4294967296);i[a++]=255&s>>>8;i[a++]=255&s;i[a++]=16|15&s>>>24;i[a++]=255&s>>>16;i[a++]=128|n>>>8;i[a++]=255&n;for(let e=0;6>e;++e)i[a+e]=ue[e];return de(i)};const ye=/^[a-f0-9]{8}-[a-f0-9]{4}-1[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}$/i,he=/^[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}$/i,be=/^00000000-0000-0000-0000-000000000000$/;class _e{static getArray(e){return new Array().concat(e).map((e)=>{try{const t=new _e(e&&e.id||e);return null===t.version?null:t}catch(e){return null}}).filter((e)=>null!==e)}constructor(e=null){if(e instanceof _e){this.version=e.version;this.uuid=e.uuid;return this}if('string'===typeof e){let t=e.toLowerCase();if(be.test(t)){this.version=null;this.uuid=t;return this}if(ye.test(t)){this.version=1;this.uuid=t;return this}if(he.test(t)){this.version=4;this.uuid=t;return this}throw new Error(`UUID "${e}" does not match the UUID string`)}if(null===e){this.version=null;this.uuid='00000000-0000-0000-0000-000000000000';return this}if(1===e){this.version=1;this.uuid=fe();return this}if(4===e){this.version=4;this.uuid=fe();return this}throw new Error(`Illegal UUID version of "${e}"`)}get value(){return this.uuid}valueOf(){return this.uuid}toNumber(){return NaN}toString(){return this.uuid}toJSON(){return this.uuid}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert UUID value to unknown value');}}[Symbol.toStringTag](){return'UUID'}}const Ee=['\u042F\u043D\u0432\u0430\u0440\u044F','\u0424\u0435\u0432\u0440\u0430\u043B\u044F','\u041C\u0430\u0440\u0442\u0430','\u0410\u043F\u0440\u0435\u043B\u044F','\u041C\u0430\u044F','\u0418\u044E\u043D\u044F','\u0418\u044E\u043B\u044F','\u0410\u0432\u0433\u0443\u0441\u0442\u0430','\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044F','\u041E\u043A\u0442\u044F\u0431\u0440\u044F','\u041D\u043E\u044F\u0431\u0440\u044F','\u0414\u0435\u043A\u0430\u0431\u0440\u044F'];class ve extends Date{static fromUnux(e){return new ve(1e3*~~e)}constructor(e){super(e)}get isValid(){return!l(this.getTime())}get isInvalid(){return!this.isValid}toURLString(){const e=String(this.getUTCFullYear()),t=String(this.getUTCMonth()+1).padStart(2,'0'),r=String(this.getUTCDate()).padStart(2,'0');return`${e}-${t}-${r}`}compareDateWithOutTime(e){return this.getFullYear()===e.getFullYear()&&this.getMonth()===e.getMonth()&&this.getDate()===e.getDate()}toHRString(){const e=new Date;let t='';if(this.compareDateWithOutTime(e))t+='\u0421\u0435\u0433\u043E\u0434\u043D\u044F';else{e.setDate(e.getDate()-1);if(this.compareDateWithOutTime(e))t+='\u0412\u0447\u0435\u0440\u0430';else{t+=String(this.getDate());t+=' '+Ee[this.getMonth()];const r=this.getFullYear();if(r!==e.getFullYear())t+=' '+String(r)}}t+=' '+String(this.getHours());t+=':'+String(this.getMinutes()).padStart(2,'0');return t}valueOf(){return new Date(this)}toNumber(){return this.getTime()}toString(){return this.toISOString()}toJSON(){return this.toISOString()}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Model value to unknown value');}}[Symbol.toStringTag](){return'Timestamp'}}const Ie=/^[a-z][a-z0-9]*$/;class Te{constructor(e,t){this.id=e;this.value=t;if(!Ie.test(e))throw new TypeError(`Enum ID "${e}" does not matc the pattern "${Ie.source}"`)}static*[Symbol.iterator](){const e=Object.keys(this);for(let t of e){yield this[t]}}static get(e){let t=String(e&&e.id||e);for(let r of this)if(r.id===t)return r}static getArray(e){return new Array().concat(e).map((e)=>this.get(e)).filter((e)=>e!==undefined)}valueOf(){return this.id}toNumber(){return NaN}toString(){return this.value}toJSON(){return this.id}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Enum value to unknown value');}}[Symbol.toStringTag](){return'Enum'}}class Se extends Te{constructor(e,t,r){super(e,t);this.description=r}[Symbol.toStringTag](){return'BlockEnum'}}Se.A1=new Se('a1','A1','\u0412\u0435\u0440\u0448\u043D\u0438\u0439');Se.A2=new Se('a2','A2','\u041F\u043E\u0434 \u0432\u0438\u0434\u0435\u043E');Se.A3=new Se('a3','A3','\u041F\u043E\u0434 \u043D\u043E\u0432\u043E\u0441\u0442\u044C\u044E');Se.B1=new Se('b1','B1','\u0411\u0430\u0448\u043D\u044F');Se.B2=new Se('b2','B2','\u0411\u0430\u0448\u043D\u044F');Se.B3=new Se('b3','B3','\u0411\u0430\u0448\u043D\u044F');Se.M1=new Se('m1','M1','\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0439');Se.M2=new Se('m2','M2','\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0439');Se.M3=new Se('m3','M3','\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0439');const xe=/^\{([a-z0-9,]+)\}$/,Re=/^\d{4}-\d{2}-\d{3}$/;class we{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;if(e.blocks){const t=xe.exec(e.blocks),r=t&&t[1].split(',')||e.blocks;this.blocks=Se.getArray(r)}else this.blocks=new Array;this.title=String(e.title||'').trim();this.description=String(e.description||'').trim();this.url=String(e.url||'').trim();this.startDate=new ve(e.startDate);this.endDate=new ve(e.endDate);this.content=String(e.content||'').trim();this.files=Array.isArray(e.files)?e.files.map(()=>d(~~e.collected,0)).filter((e)=>0<e):new Array;this.limits='object'===typeof e.limits?{show:d(~~e.limits.show,0),showPerDay:d(~~e.limits.showPerDay,0),showPerUser:d(~~e.limits.showPerUser,0),click:d(~~e.limits.click,0),clickPerDay:d(~~e.limits.clickPerDay,0),clickPerUser:d(~~e.limits.clickPerUser,0)}:{show:0,showPerDay:0,showPerUser:0,click:0,clickPerDay:0,clickPerUser:0};this.stats={};if('object'===e.stats)for(let t in e.stats){t=String(t).trim();if(Re.test(t))this.stats[t]={show:d(~~e.stats[t].show,0),click:d(~~e.stats[t].click,0)}}}valueOf(){return{enable:this.enable,blocks:this.blocks.map((e)=>e.valueOf()),title:this.title,description:this.description,url:this.url,startDate:this.startDate,endDate:this.startDate,content:this.content,files:this.files,limits:this.limits}}toJSON(){return{id:this.id,enable:this.enable,blocks:this.blocks,title:this.title,description:this.description,url:this.url,startDate:this.startDate,endDate:this.startDate,content:this.content,files:this.files,limits:this.limits,stats:this.stats}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Ads value to unknown value');}}[Symbol.toStringTag](){return'Ads'}}we.MainFields=['id','enable','blocks','title','startDate','endDate'];class Ce{constructor(e){this._btc=0;this._usd=0;this.update(e)}get btc(){return this._btc}get usd(){return this._usd}update(e={}){const t=e.btc!==undefined&&d(parseFloat(e.btc),0);this._btc=t||this.btc;const r=e.usd!==undefined&&d(parseFloat(e.usd),0);this._usd=r||this.usd}valueOf(){return{btc:this.btc,usd:this.usd}}toJSON(){return{btc:this.btc,usd:this.usd}}toNumber(){return this.usd||0}toString(){return String(this.toNumber())}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Price value to unknown value');}}[Symbol.toStringTag](){return'Price'}}class De{constructor(e={}){this.price=new Ce;this.ts=new ve(e.ts);this.updatePrice(e.price)}updatePrice(e={}){this.price.update(e)}valueOf(){return{ts:this.ts,price:this.price}}toJSON(){return{ts:this.ts,price:this.price}}toNumber(){return this.price.toNumber()}toString(){return String(this.ts)}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Historical value to unknown value');}}[Symbol.toStringTag](){return'Historical'}}const Oe=/^[A-Z0-9@$]+$/;class Pe{constructor(e={}){this._max=0;this._available=0;this.price=new Ce;this._volume24=0;this._historical=new Array;const t=String(e.symbol||'').trim().toUpperCase();if(!Oe.test(t))throw new TypeError(`Symbol "${t} not match to pattern ${Oe.source}`);this.symbol=t;this.update(e)}get max(){return this._max}get available(){return this._available}get capitalization(){return{btc:this.price.btc*this.available,usd:this.price.usd*this.available}}get volume24(){return this._volume24}get ts(){return this._ts}get historical(){return this._historical.sort((e,t)=>e.ts<t.ts?-1:1)}get lastHistorical(){const e=this.historical;if(0===e.length)return;return e[e.length-1].ts}updatePrice(e={}){this.price.update(e)}updateHistorical(e=[]){if(!Array.isArray(e))return;e.map((e)=>new De(e)).forEach((e)=>{const t=this._historical.find((t)=>Number(t.ts)===Number(e.ts));if(!t){this._historical.push(e);return}t.updatePrice(e.price)})}update(e={}){if(!e)return;if(e.symbol!==this.symbol)return;this._max=e.max!==undefined?d(parseFloat(e.max),0):0;this._available=e.available!==undefined?d(parseFloat(e.available),0):0;this._volume24=e.volume24!==undefined?d(parseFloat(e.volume24),0):0;this._ts=new ve(e.ts);this.updatePrice(e.price);this.updateHistorical(e.historical)}valueOf(){return{symbol:this.symbol,max:this.max,available:this.available,price:this.price.valueOf(),capitalization:this.capitalization,volume24:this.volume24,ts:this.ts,historical:this.historical}}toJSON(){return{symbol:this.symbol,max:this.max,available:this.available,price:this.price,capitalization:this.capitalization,volume24:this.volume24,ts:this.ts}}equal(e){return JSON.stringify(e)===JSON.stringify(this)}toNumber(){return this.capitalization.usd}toString(){return this.symbol}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Coin value to unknown value');}}[Symbol.toStringTag](){return'Coin'}}class Ae{constructor(e={}){this.like=d(~~e.like,0);this.dislike=d(~~e.dislike,0)}get value(){return this.like/(this.like+this.dislike)}get stars(){return 5*this.value}valueOf(){return{like:this.like,dislike:this.dislike}}toJSON(){return{like:this.like,dislike:this.dislike}}toNumber(){return this.value}toString(){return String(this.value)}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Raiting value to unknown value');}}[Symbol.toStringTag](){return'Raiting'}}Ae.MainFields=['like','dislike'];class ke{constructor(e={}){if(!e)e={};this.symbol=String(e.symbol||'').trim();this.enable=e.enable===undefined?true:!!e.enable;this.extUrl=String(e.extUrl||'').trim();this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=d(~~e.image,0)||null;this.ogImage=d(~~e.ogImage,0)||null;this.startDate=new ve(e.startDate);this.founder=String(e.founder||'').trim();this.maxCoin=d(~~e.maxCoin,0);this.algorithm=String(e.algorithm||'').trim();this.system=String(e.system||'').trim();this.content=String(e.content||'').trim();this.rating=new Ae(e.rating);this.bjr=s(d(~~e.bjr,0),5);this.branding={}}valueOf(){return{symbol:this.symbol,enable:this.enable,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate,founder:this.founder,maxCoin:this.maxCoin,algorithm:this.algorithm,system:this.system,content:this.content,bjr:this.bjr}}toJSON(){return{symbol:this.symbol,enable:this.enable,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate.isValid?this.startDate:undefined,founder:this.founder,maxCoin:this.maxCoin,algorithm:this.algorithm,system:this.system,content:this.content,rating:this.rating,bjr:this.bjr,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Currency value to unknown value');}}[Symbol.toStringTag](){return'Currency'}}ke.MainFields=['symbol','enable','title','image','rating','bjr'];class Le{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;this.url=String(e.url||'').trim();this.extUrl=String(e.extUrl||'').trim();this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=d(~~e.image,0)||null;this.ogImage=d(~~e.ogImage,0)||null;this.startDate=new ve(e.startDate);this.referral=!!e.referral;this.content=String(e.content||'').trim();this.rating=new Ae(e.rating);this.bjr=s(d(~~e.bjr,0),5);this.branding={}}valueOf(){return{enable:this.enable,url:this.url,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate,referral:this.referral,content:this.content,bjr:this.bjr}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate.isValid?this.startDate:undefined,referral:this.referral,content:this.content,rating:this.rating,bjr:this.bjr,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Exchange value to unknown value');}}[Symbol.toStringTag](){return'Exchange'}}Le.MainFields=['id','enable','url','title','image','rating','bjr'];class Ne{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;this.url=String(e.url||'').trim();this.extUrl=String(e.extUrl||'').trim();this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=d(~~e.image,0)||null;this.ogImage=d(~~e.ogImage,0)||null;this.startDate=new ve(e.startDate);this.goal=d(~~e.goal,0);this.collected=d(~~e.collected,0);this.status=String(e.status||'').trim();this.content=String(e.content||'').trim();this.rating=new Ae(e.rating);this.bjr=s(d(~~e.bjr,0),5);this.branding={}}valueOf(){return{enable:this.enable,url:this.url,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate,goal:this.goal,collected:this.collected,status:this.status,content:this.content,bjr:this.bjr}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate.isValid?this.startDate:undefined,goal:this.goal,collected:this.collected,status:this.status,content:this.content,rating:this.rating,bjr:this.bjr,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert ICO value to unknown value');}}[Symbol.toStringTag](){return'ICO'}}Ne.MainFields=['id','enable','url','title','image','rating','bjr'];class Me{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;this.url=String(e.url||'').trim();this.extUrl=String(e.extUrl||'').trim();this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=d(~~e.image,0)||null;this.ogImage=d(~~e.ogImage,0)||null;this.startDate=new ve(e.startDate);this.referral=!!e.referral;this.content=String(e.content||'').trim();this.rating=new Ae(e.rating);this.bjr=s(d(~~e.bjr,0),5);this.branding={}}valueOf(){return{enable:this.enable,url:this.url,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate,referral:this.referral,content:this.content,bjr:this.bjr}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate.isValid?this.startDate:undefined,referral:this.referral,content:this.content,rating:this.rating,bjr:this.bjr,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Market value to unknown value');}}[Symbol.toStringTag](){return'Market'}}Me.MainFields=['id','enable','url','title','image','rating','bjr'];const je='\u0449  \u0448  \u0447  \u0446  \u044E  \u044F  \u0451 \u0436  \u044B \u044D \u0430 \u0431 \u0432 \u0433 \u0434 \u0435 \u0437 \u0438 \u0439 \u043A \u043B \u043C \u043D \u043E \u043F \u0440 \u0441 \u0442 \u0443 \u0444 \u0445'.split(/\s+/),qe='sh sh ch cz yu ya e zh y e a b v g d e z i j k l m n o p r s t u f x'.split(/\s+/);class Ue{constructor(){}}Ue.build=(e,t=128)=>{let r=e.toLowerCase().replace(/\s+/g,'_');r=r.split('').map((e)=>{let t=je.indexOf(e);return 0>t?e:qe[t]}).join('');r=r.replace(/[^0-9a-z_]/g,'').slice(0,t).replace(/(^_+|_+$)/g,'');return r};class Fe{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.ts=new ve(e.ts);this.url=String(e.url||'').trim();this.enable=!!e.enable;this.sections=_e.getArray(e.sections);this.currencies=Array.isArray(e.currencies)?e.currencies.map((e)=>String(e).trim().toLowerCase()).filter((e)=>!!e):new Array;this.exchanges=_e.getArray(e.exchanges);this.ico=_e.getArray(e.ico);this.markets=_e.getArray(e.markets);this.weight=e.weight===undefined?1:s(d(~~e.weight,0),3);this.bigTitle=String(e.bigTitle||'').trim();this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=d(~~e.image,0)||null;this.ogImage=d(~~e.ogImage,0)||null;this.authors=_e.getArray(e.authors);this.tags=Array.isArray(e.tags)?e.tags.map((e)=>String(e).trim().toLowerCase()).filter((e)=>!!e):new Array;this.sharing=e.sharing===undefined?true:!!e.sharing;this.comments=e.comments===undefined?true:!!e.comments;this.ads=e.ads===undefined?true:!!e.ads;this.rss=e.rss===undefined?true:!!e.rss;this.content=String(e.content||'').trim();this.rating=new Ae(e.rating);this.branding={};this.lastModified=new ve(e.lastModified);if(!this.url)this.url=Ue.build(this.title)}valueOf(){return{ts:this.ts,url:this.url,enable:this.enable,sections:this.sections.map((e)=>e.valueOf()),currencies:this.currencies,exchanges:this.exchanges.map((e)=>e.valueOf()),ico:this.ico.map((e)=>e.valueOf()),markets:this.markets.map((e)=>e.valueOf()),weight:this.weight,bigTitle:this.bigTitle,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,authors:this.authors.map((e)=>e.valueOf()),tags:this.tags,sharing:this.sharing,comments:this.comments,ads:this.ads,rss:this.rss,content:this.content}}toJSON(){return{id:this.id,ts:this.ts,url:this.url,enable:this.enable,sections:this.sections,currencies:this.currencies,exchanges:this.exchanges,ico:this.ico,markets:this.markets,weight:this.weight,bigTitle:this.bigTitle,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,authors:this.authors,tags:this.tags,sharing:this.sharing,comments:this.comments,ads:this.ads,rss:this.rss,content:this.content,rating:this.rating,branding:this.branding,lastModified:this.lastModified.isValid?this.lastModified:undefined}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Publication value to unknown value');}}[Symbol.toStringTag](){return'Publication'}}Fe.MainFields=['id','ts','url','enable','sections','currencies','exchanges','ico','markets','weight','bigTitle','title','description','image','authors','tags','rss','rating','branding','lastModified'];class Qe{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;this.url=String(e.url||'').trim()||null;this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=d(~~e.image,0)||null;this.ogImage=d(~~e.ogImage,0)||null;this.branding={}}valueOf(){return{enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Section value to unknown value');}}[Symbol.toStringTag](){return'Section'}}Qe.MainFields=['id','enable','url','title'];class Ge{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;this.title=String(e.title||'').trim();this.image=d(~~e.image,0)||null}valueOf(){return{enable:this.enable,title:this.title,image:this.image}}toJSON(){return{id:this.id,enable:this.enable,title:this.title,image:this.image}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Status value to unknown value');}}[Symbol.toStringTag](){return'Status'}}Ge.MainFields=['id','enable','title','image'];class He extends Te{constructor(e,t,r){super(e,t);this.icon=r}[Symbol.toStringTag](){return'UserRole'}}He.User=new He('user','\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C',null);He.Author=new He('author','\u0410\u0432\u0442\u043E\u0440',null);He.Publisher=new He('publisher','\u041F\u0443\u0431\u043B\u0438\u043A\u0430\u0442\u043E\u0440',null);He.Chief=new He('chief','\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440',null);He.Administrator=new He('administrator','\u0410\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440',null);He.Su=new He('su','Super user',null);const ze=/^\{([a-z0-9,]+)\}$/;class Ve{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.enable=!!e.enable;if(e.roles){const t=ze.exec(e.roles),r=t&&t[1].split(',')||e.roles;this.roles=He.getArray(r)}else this.roles=new Array;this.url=String(e.url||'').trim()||null;this.title=String(e.title||'').trim();this.description=String(e.description||'').trim();this.email=String(e.email||'').trim();this.phone=String(e.phone||'').trim()||null;this.oauth={};this.image=d(~~e.image,0)||null;this.statuses=_e.getArray(e.statuses);this.rating=new Ae(e.rating);this.bjr=s(d(~~e.bjr,0),5);this.card={}}checkRole(e){for(let t of e)if(this.roles.includes(t))return true;return false}get valid(){return null!==this.id&&null!==this.id.version}valueOf(){return{enable:this.enable,roles:this.roles.map((e)=>e.valueOf()),url:this.url,title:this.title,description:this.description,email:this.email,phone:this.phone,image:this.image,statuses:this.statuses.map((e)=>e.valueOf()),bjr:this.bjr,card:this.card}}toJSON(){return{id:this.id,enable:this.enable,roles:this.roles,url:this.url,title:this.title,description:this.description,email:this.email,phone:this.phone,oauth:this.oauth,image:this.image,statuses:this.statuses,rating:this.rating,bjr:this.bjr,card:this.card}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert User value to unknown value');}}[Symbol.toStringTag](){return'User'}}Ve.AnonymousFields=['id','title','url','image','statuses','rating','bjr'];Ve.MainFields=['id','enable','title','email','phone','url','roles','image','statuses','rating','bjr'];class Be{constructor(e={}){if(!e)e={};this.id=String(e.id||'').trim();this.enable=e.enable===undefined?true:!!e.enable}valueOf(){return{id:this.id,enable:this.enable}}toJSON(){return{id:this.id,enable:this.enable}}toNumber(){return NaN}toString(){return this.id}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Video value to unknown value');}}[Symbol.toStringTag](){return'Video'}}Be.MainFields=['id','enable'];class $e{constructor(e={}){if(!e)e={};this.id=new _e(e.id||null);this.enable=e.enable===undefined?true:!!e.enable;this.url=String(e.url||'').trim();this.extUrl=String(e.extUrl||'').trim();this.title=String(e.title||'').trim();this.ogTitle=String(e.ogTitle||'').trim();this.description=String(e.description||'').trim();this.ogDescription=String(e.ogDescription||'').trim();this.image=d(~~e.image,0)||null;this.ogImage=d(~~e.ogImage,0)||null;this.startDate=new ve(e.startDate);this.content=String(e.content||'').trim();this.rating=new Ae(e.rating);this.bjr=s(d(~~e.bjr,0),5);this.branding={}}valueOf(){return{enable:this.enable,url:this.url,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate,content:this.content,bjr:this.bjr}}toJSON(){return{id:this.id,enable:this.enable,url:this.url,extUrl:this.extUrl,title:this.title,ogTitle:this.ogTitle,description:this.description,ogDescription:this.ogDescription,image:this.image,ogImage:this.ogImage,startDate:this.startDate.isValid?this.startDate:undefined,content:this.content,rating:this.rating,bjr:this.bjr,branding:this.branding}}toNumber(){return NaN}toString(){return this.title}[Symbol.toPrimitive](e){switch(e){case'default':return this.valueOf();case'number':return this.toNumber();case'string':return this.toString();default:throw new TypeError('Cannot convert Event value to unknown value');}}[Symbol.toStringTag](){return'Event'}}$e.MainFields=['id','enable','url','title','image','rating','bjr'];const Xe=/^[0-9a-z]{128}$/,We=/token\s+([0-9a-f]{128})/;class Ye{constructor(e){this._ctx=e;this._id='';this._user=null;const t=We.exec(e.request.getHeader('Authorization')||'');this._id=t&&t[1]||''}get id(){return this._id}set id(e){this._id=Xe.test(e)?e:''}get user(){return this._user}set user(e){if(!e)this._user=null;else{let t=e instanceof Ve?e:new Ve(e);this._user=t.valid?t:null}}get ip(){return this._ctx.request.ip}get valid(){return 0<this.id.length&&this._user instanceof Ve&&this._user.valid}valueOf(){return{id:this._id,user:this._user}}toJSON(){return this.valueOf()}}var Ke=r(52),Ze=r.n(Ke);class Je{constructor(){}static*[Symbol.iterator](){const e=Object.keys(this);for(let t of e){yield this[t]}}static parseError(e){const t=e&&parseInt(e.code)||NaN;if(!t)return NaN;for(let r of this)if(r===t)return r;return NaN}}Je.UNIQUE_VIOLATION=23505;Je.UNDEFINED_OBJECT=42704;class et{constructor(e){this.name=e}valueOf(){return{text:this.text,values:this.values}}}class tt{constructor(e=null,t=0,r=[]){this.text='';this.values=[];if(null===e){this.values=[];this.text='';return this}if('string'===typeof e){let n=t;this.values=[];this.text=' WHERE '+e.replace(/\$\d+/g,(e)=>{let t=~~/\d+/.exec(e)[0]-1;if(r[t]===undefined)return'DEFAULT';this.values.push(r[t]);return`$${++n}`});return this}throw new TypeError('value is not a null, array, object or string')}}class rt{constructor(e=null){if(null===e){this.text='';return this}if(Array.isArray(e)){this.text=' ORDER BY '+e.map((e)=>`"${e}" ASC`).join(', ');return this}if('object'===typeof e){let t=Object.keys(e);if(0===t.length){this.text='';return this}this.text=' ORDER BY '+t.map((t)=>`"${t}" ${e[t]}`).join(', ');return this}if('string'===typeof e){this.text=` ORDER BY "${e}" ASC`;return this}throw new TypeError('value is not a null, array, object or string')}}class nt{constructor(e=Infinity){if(l(e))throw new TypeError('limit is not a number');if(0>=e)throw new TypeError('limit is less than or equal to zero');if(e<Infinity)this.text=' LIMIT ${limit}';else this.text=''}}class at{constructor(e=0){if(l(e))throw new TypeError('offset is not a number');if(0>e)throw new TypeError('offset is less than zero');if(e===Infinity)throw new TypeError('offset is Infinity');if(0<e)this.text=' OFFSET ${offset}';else this.text=''}}class it extends et{constructor(e,t=[]){super('SELECT');this._where=new tt;this._order=new rt;this._limit=new nt;this._offset=new at;let r=Array.isArray(t)?t:Object.keys(t);r=r.map((e)=>`"${e}"`);this._command=`SELECT ${r.join(', ')||'*'} FROM "${e.scheme}"."${e.table}"`}where(e,...t){this._where=new tt(e,0,t);return this}order(e){this._order=new rt(e);return this}limit(e){this._limit=new nt(e);return this}offset(e){this._offset=new at(e);return this}get text(){return this._command+this._where.text+this._order.text+this._limit.text+this._offset.text}get values(){return this._where.values}}class ot{constructor(e=[]){let t=Array.isArray(e)?e:Object.keys(e);t=t.map((e)=>`"${e}"`);this.text=` RETURNING ${t.join(', ')||'*'}`}}class st extends et{constructor(e,t={}){super('INSERT');this._returning=new ot;let r=Object.keys(t);if(0===r.length)throw new TypeError('filtred value is an empty object');this.values=[];let n=[];r.forEach((e)=>{if(t[e]===undefined){n.push('DEFAULT');return}let r=this.values.push(t[e]);n.push(`$${r}`)});r=r.map((e)=>`"${e}"`);this._command=`INSERT INTO "${e.scheme}"."${e.table}" (${r.join(', ')}) VALUES (${n.join(', ')})`}returning(e){this._returning=new ot(e);return this}get text(){return this._command+this._returning.text}}class lt extends et{constructor(e,t=[]){super('UPDATE');this._returning=new ot;this._where=new tt;let r=Object.keys(t);if(0===r.length)throw new TypeError('filtred value is an empty object');this._values=[];r=r.map((e)=>{let r=`"${e}" = `;if(t[e]===undefined){return r+'DEFAULT'}let n=this._values.push(t[e]);return r+`$${n}`});this._command=`UPDATE "${e.scheme}"."${e.table}" SET ${r.join(', ')}`}where(e,...t){this._where=new tt(e,this._values.length,t);return this}returning(e){this._returning=new ot(e);return this}get text(){return this._command+this._where.text+this._returning.text}get values(){return[...this._values,...this._where.values]}}class dt extends et{constructor(e){super('DELETE');this._where=new tt;this._returning=new ot;this._command=`DELETE FROM "${e.scheme}"."${e.table}"`}where(e,...t){this._where=new tt(e,0,t);return this}returning(e){this._returning=new ot(e);return this}get text(){return this._command+this._where.text+this._returning.text}get values(){return this._where.values}}var pt=this&&this.__decorate||function(e,t,n,a){var o=arguments.length,s=3>o?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a,r;if('object'===typeof Reflect&&'function'===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;0<=l;l--)if(r=e[l])s=(3>o?r(s):3<o?r(t,n,s):r(t,n))||s;return 3<o&&s&&Object.defineProperty(t,n,s),s},ut=this&&this.__metadata||function(e,t){if('object'===typeof Reflect&&'function'===typeof Reflect.metadata)return Reflect.metadata(e,t)};class ct extends Q{async getData(e){const t=e.route,r=e.db,n=d(parseInt(t.data.id),0);if(!n){e.set(404);return}const a=new Ke.LargeObjectManager({pg:r});await r.query('BEGIN');let i;try{const e=await a.openAsync(n,Ke.LargeObjectManager.READ),t=await e.sizeAsync();i=await e.readAsync(t);await e.closeAsync()}catch(t){await r.query('ROLLBACK');if(Je.parseError(t)===Je.UNDEFINED_OBJECT){e.set(404);return}e.throw(t);return}await r.query('COMMIT');return i}async getIMG(e){const t=await this.getData(e);if(!t)return;e.set(t)}async getRAW(e){const t=await this.getData(e);if(!t)return;e.set(t)}}pt([q(`/img/:id`),ut('design:type',Function),ut('design:paramtypes',[D,Function]),ut('design:returntype',Promise)],ct.prototype,'getIMG',null);pt([q(`/:id`),ut('design:type',Function),ut('design:paramtypes',[D,Function]),ut('design:returntype',Promise)],ct.prototype,'getRAW',null);process.env.TZ='UTC';new X(new class extends P{constructor(){super();this.pool=ae}async main(e,t){e.db=await this.pool.connect();await t();e.db.release()}}(),new class extends P{async main(e,t){const r=new Ye(e),n=e.db,a={text:`SELECT
               "users".*
             FROM
               "sessions"
               LEFT JOIN
               "users"
               ON "sessions"."owner" = "users"."id"
             WHERE
               "sessions"."id" = $1
               AND
               "users"."enable"
               AND
               "sessions"."expires" > timezone('UTC', now())`,values:[r.id]};e.debug(`=== SQL Query SESSION ===\n%s`,a);const i=await n.query(a);e.debug(`=== SQL Result SESSION ===\n%s`,i.rows);if(1===i.rowCount)r.user=new Ve(i.rows[0]);e.session=r;e.debug('=== Input session ===\n%s',e.session);await t();e.debug('=== Output session ===\n%s',e.session)}}(),new ct())},function(e){e.exports=require('querystring')},function(e,t,r){'use strict';var n=r(1).EventEmitter,a=r(0),i=r(7),o=r(32),s=r(13),l=r(14),d=r(40),p=r(2),u=r(15),c=function(e){n.call(this);this.connectionParameters=new l(e);this.user=this.connectionParameters.user;this.database=this.connectionParameters.database;this.port=this.connectionParameters.port;this.host=this.connectionParameters.host;this.password=this.connectionParameters.password;this.replication=this.connectionParameters.replication;var t=e||{};this._types=new s(t.types);this._ending=false;this._connecting=false;this._connected=false;this._connectionError=false;this.connection=t.connection||new u({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||false,encoding:this.connectionParameters.client_encoding||'utf8'});this.queryQueue=[];this.binary=t.binary||p.binary;this.processID=null;this.secretKey=null;this.ssl=this.connectionParameters.ssl||false};a.inherits(c,n);c.prototype.connect=function(e){var r=this,n=this.connection;if(this._connecting||this._connected){const t=new Error('Client has already been connected. You cannot reuse a client.');if(e){e(t);return}return Promise.reject(t)}this._connecting=true;if(this.host&&0===this.host.indexOf('/')){n.connect(this.host+'/.s.PGSQL.'+this.port)}else{n.connect(this.port,this.host)}n.on('connect',function(){if(r.ssl){n.requestSsl()}else{n.startup(r.getStartupConf())}});n.on('sslconnect',function(){n.startup(r.getStartupConf())});function t(e){return function(t){if(null!==r.password){e(t)}else{o(r.connectionParameters,function(n){if(undefined!==n){r.connectionParameters.password=r.password=n}e(t)})}}}n.on('authenticationCleartextPassword',t(function(){n.password(r.password)}));n.on('authenticationMD5Password',t(function(e){n.password(i.postgresMd5PasswordHash(r.user,r.password,e.salt))}));n.once('backendKeyData',function(e){r.processID=e.processID;r.secretKey=e.secretKey});const a=(t)=>{if(this._connectionError){return}this._connectionError=true;if(e){return e(t)}this.emit('error',t)},s=(e)=>{if(this.activeQuery){var t=r.activeQuery;this.activeQuery=null;return t.handleError(e,n)}this.emit('error',e)};n.on('error',a);n.once('readyForQuery',function(){r._connecting=false;r._connected=true;r._attachListeners(n);n.removeListener('error',a);n.on('error',s);if(e){e(null,r);e=null}r.emit('connect')});n.on('readyForQuery',function(){var e=r.activeQuery;r.activeQuery=null;r.readyForQuery=true;if(e){e.handleReadyForQuery(n)}r._pulseQueryQueue()});n.once('end',()=>{if(this.activeQuery){var t=new Error('Connection terminated');this.activeQuery.handleError(t,n);this.activeQuery=null}if(!this._ending){const t=new Error('Connection terminated unexpectedly');if(this._connecting&&!this._connectionError){if(e){e(t)}else{this.emit('error',t)}}else if(!this._connectionError){this.emit('error',t)}}this.emit('end')});n.on('notice',function(e){r.emit('notice',e)});if(!e){return new global.Promise((e,t)=>{this.once('error',t);this.once('connect',()=>{this.removeListener('error',t);e()})})}};c.prototype._attachListeners=function(e){const t=this;e.on('rowDescription',function(e){t.activeQuery.handleRowDescription(e)});e.on('dataRow',function(e){t.activeQuery.handleDataRow(e)});e.on('portalSuspended',function(){t.activeQuery.handlePortalSuspended(e)});e.on('emptyQuery',function(){t.activeQuery.handleEmptyQuery(e)});e.on('commandComplete',function(r){t.activeQuery.handleCommandComplete(r,e)});e.on('parseComplete',function(){if(t.activeQuery.name){e.parsedStatements[t.activeQuery.name]=true}});e.on('copyInResponse',function(){t.activeQuery.handleCopyInResponse(t.connection)});e.on('copyData',function(e){t.activeQuery.handleCopyData(e,t.connection)});e.on('notification',function(e){t.emit('notification',e)})};c.prototype.getStartupConf=function(){var e=this.connectionParameters,t={user:e.user,database:e.database},r=e.application_name||e.fallback_application_name;if(r){t.application_name=r}if(e.replication){t.replication=''+e.replication}if(e.statement_timeout){t.statement_timeout=String(parseInt(e.statement_timeout,10))}return t};c.prototype.cancel=function(e,t){if(e.activeQuery===t){var r=this.connection;if(this.host&&0===this.host.indexOf('/')){r.connect(this.host+'/.s.PGSQL.'+this.port)}else{r.connect(this.port,this.host)}r.on('connect',function(){r.cancel(e.processID,e.secretKey)})}else if(-1!==e.queryQueue.indexOf(t)){e.queryQueue.splice(e.queryQueue.indexOf(t),1)}};c.prototype.setTypeParser=function(e,t,r){return this._types.setTypeParser(e,t,r)};c.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)};c.prototype.escapeIdentifier=function(e){for(var t='"',r=0,n;r<e.length;r++){n=e[r];if('"'===n){t+=n+n}else{t+=n}}t+='"';return t};c.prototype.escapeLiteral=function(e){for(var t=false,r='\'',n=0,a;n<e.length;n++){a=e[n];if('\''===a){r+=a+a}else if('\\'===a){r+=a+a;t=true}else{r+=a}}r+='\'';if(true===t){r=' E'+r}return r};c.prototype._pulseQueryQueue=function(){if(true===this.readyForQuery){this.activeQuery=this.queryQueue.shift();if(this.activeQuery){this.readyForQuery=false;this.hasExecuted=true;this.activeQuery.submit(this.connection)}else if(this.hasExecuted){this.activeQuery=null;this.emit('drain')}}};c.prototype.query=function(e,t,r){var n,a;if('function'===typeof e.submit){a=n=e;if('function'===typeof t){n.callback=n.callback||t}}else{n=new d(e,t,r);if(!n.callback){let e,t;a=new Promise((r,n)=>{e=r;t=n});n.callback=(r,n)=>r?t(r):e(n)}}if(this.binary&&!n.binary){n.binary=true}if(n._result){n._result._getTypeParser=this._types.getTypeParser.bind(this._types)}this.queryQueue.push(n);this._pulseQueryQueue();return a};c.prototype.end=function(e){this._ending=true;if(this.activeQuery){this.connection.stream.destroy(new Error('Connection terminated by user'));return e?e():Promise.resolve()}if(e){this.connection.end();this.connection.once('end',e)}else{return new global.Promise((e)=>{this.connection.end();this.connection.once('end',e)})}};c.Query=d;e.exports=c},function(e,t,r){var d=r(11),u=r(12),p=r(27),c=r(28),m=r(30);function n(e){return function(t){if(null===t)return t;return e(t)}}function a(e){if(null===e)return e;return'TRUE'===e||'t'===e||'true'===e||'y'===e||'yes'===e||'on'===e||'1'===e}function i(e){if(!e)return null;return d.parse(e,a)}function o(e){return parseInt(e,10)}function s(e){if(!e)return null;return d.parse(e,n(o))}function l(e){if(!e)return null;return d.parse(e,n(function(e){return E(e).trim()}))}var g=function(e){if(!e){return null}var t=u.create(e,function(e){if(null!==e){e=I(e)}return e});return t.parse()},f=function(e){if(!e){return null}var t=u.create(e,function(e){if(null!==e){e=parseFloat(e)}return e});return t.parse()},y=function(e){if(!e){return null}var t=u.create(e);return t.parse()},h=function(e){if(!e){return null}var t=u.create(e,function(e){if(null!==e){e=p(e)}return e});return t.parse()},b=function(e){if(!e){return null}return d.parse(e,n(m))},_=function(e){return parseInt(e,10)},E=function(e){var t=String(e);if(/^\d+$/.test(t)){return t}return e},v=function(e){var t=y(e);if(!t){return t}return t.map(function(e){return JSON.parse(e)})},I=function(e){if('('!==e[0]){return null}e=e.substring(1,e.length-1).split(',');return{x:parseFloat(e[0]),y:parseFloat(e[1])}},T=function(e){if('<'!==e[0]&&'('!==e[1]){return null}for(var t='(',r='',n=false,a=2;a<e.length-1;a++){if(!n){t+=e[a]}if(')'===e[a]){n=true;continue}else if(!n){continue}if(','===e[a]){continue}r+=e[a]}var i=I(t);i.radius=parseFloat(r);return i};e.exports={init:function(e){e(20,E);e(21,_);e(23,_);e(26,_);e(700,parseFloat);e(701,parseFloat);e(16,a);e(1082,p);e(1114,p);e(1184,p);e(600,I);e(651,y);e(718,T);e(1e3,i);e(1001,b);e(1005,s);e(1007,s);e(1028,s);e(1016,l);e(1017,g);e(1021,f);e(1022,f);e(1231,f);e(1014,y);e(1015,y);e(1008,y);e(1009,y);e(1040,y);e(1041,y);e(1115,h);e(1182,h);e(1185,h);e(1186,c);e(17,m);e(114,JSON.parse.bind(JSON));e(3802,JSON.parse.bind(JSON));e(199,v);e(3807,v);e(3907,y);e(2951,y);e(791,y);e(1183,y);e(1270,y)}}},function(e){'use strict';var n=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?/,a=/^(\d{1,})-(\d{2})-(\d{2})$/,i=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,o=/BC$/,s=/^-?infinity$/;e.exports=function(e){if(s.test(e)){return Number(e.replace('i','I'))}var i=n.exec(e);if(!i){return a.test(e)?t(e):null}var l=o.test(e),d=parseInt(i[1],10),p=0<d&&100>d;d=(l?'-':'')+d;var u=parseInt(i[2],10)-1,c=i[3],m=parseInt(i[4],10),g=parseInt(i[5],10),f=parseInt(i[6],10),y=i[7];y=y?1e3*parseFloat(y):0;var h,b=r(e);if(null!=b){var _=Date.UTC(d,u,c,m,g,f,y);h=new Date(_-b)}else{h=new Date(d,u,c,m,g,f,y)}if(p){h.setUTCFullYear(d)}return h};function t(e){var t=a.exec(e),r=parseInt(t[1],10),n=parseInt(t[2],10)-1,i=t[3],o=new Date(r,n,i);o.setFullYear(r);return o}function r(e){var t=i.exec(e.split(' ')[1]);if(!t)return;var r=t[1];if('Z'===r){return 0}var n='-'===r?-1:1,a=3600*parseInt(t[2],10)+60*parseInt(t[3]||0,10)+parseInt(t[4]||0,10);return 1e3*(a*n)}},function(e,t,r){'use strict';var o=r(29);e.exports=n;function n(e){if(!(this instanceof n)){return new n(e)}o(this,i(e))}var s=['seconds','minutes','hours','days','months','years'];n.prototype.toPostgres=function(){var e=s.filter(this.hasOwnProperty,this);if(this.milliseconds&&0>e.indexOf('seconds')){e.push('seconds')}if(0===e.length)return'0';return e.map(function(e){var t=this[e]||0;if('seconds'===e&&this.milliseconds){t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,'')}return t+' '+e},this).join(' ')};var l={years:'Y',months:'M',days:'D',hours:'H',minutes:'M',seconds:'S'},d=['years','months','days'],p=['hours','minutes','seconds'];n.prototype.toISO=function(){var t=d.map(e,this).join(''),r=p.map(e,this).join('');return'P'+t+'T'+r;function e(e){var t=this[e]||0;if('seconds'===e&&this.milliseconds){t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,'')}return t+l[e]}};var u='([+-]?\\d+)',c=new RegExp([u+'\\s+years?',u+'\\s+mons?',u+'\\s+days?','([+-])?([\\d]*):(\\d\\d):(\\d\\d).?(\\d{1,6})?'].map(function(e){return'('+e+')?'}).join('\\s*')),m={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},g=['hours','minutes','seconds','milliseconds'];function a(e){var t=e+'000000'.slice(e.length);return parseInt(t,10)/1e3}function i(e){if(!e)return{};var t=c.exec(e),r='-'===t[8];return Object.keys(m).reduce(function(e,n){var i=m[n],o=t[i];if(!o)return e;o='milliseconds'===n?a(o):parseInt(o,10);if(!o)return e;if(r&&~g.indexOf(n)){o*=-1}e[n]=o;return e},{})}},function(e){e.exports=function(e){for(var r=1,n;r<arguments.length;r++){n=arguments[r];for(var a in n){if(t.call(n,a)){e[a]=n[a]}}}return e};var t=Object.prototype.hasOwnProperty},function(e){'use strict';var t=Math.floor;e.exports=function(e){if(/^\\x/.test(e)){return new Buffer(e.substr(2),'hex')}var r='',n=0;while(n<e.length){if('\\'!==e[n]){r+=e[n];++n}else{if(/[0-7]{3}/.test(e.substr(n+1,3))){r+=String.fromCharCode(parseInt(e.substr(n+1,3),8));n+=4}else{var a=1;while(n+a<e.length&&'\\'===e[n+a]){a++}for(var i=0;i<t(a/2);++i){r+='\\'}n+=2*t(a/2)}}}return new Buffer(r,'binary')}},function(e){var t=Math.pow,r=function(e,r,n,a,o){n=n||0;a=a||false;o=o||function(e,r,n){return e*t(2,n)+r};var s=n>>3,l=function(e){if(a){return 255&~e}return e},d=255,p=8-n%8;if(r<p){d=255&255<<8-r;p=r}if(n){d=d>>n%8}var u=0;if(8<=n%8+r){u=o(0,l(e[s])&d,p)}for(var c=r+n>>3,m=s+1;m<c;m++){u=o(u,l(e[m]),8)}var i=(r+n)%8;if(0<i){u=o(u,l(e[c])>>8-i,i)}return u},n=function(e,n,a){var i=t(2,a-1)-1,o=r(e,1),s=r(e,a,1);if(0===s){return 0}var l=1,d=r(e,n,a+1,false,function(e,t,r){if(0===e){e=1}for(var n=1;n<=r;n++){l/=2;if(0<(t&1<<r-n)){e+=l}}return e});if(s==t(2,a+1)-1){if(0===d){return 0===o?Infinity:-Infinity}return NaN}return(0===o?1:-1)*t(2,s-i)*d},a=function(e){if(1==r(e,1)){return-1*(r(e,15,1,true)+1)}return r(e,15,1)},i=function(e){if(1==r(e,1)){return-1*(r(e,31,1,true)+1)}return r(e,31,1)},o=function(e){return n(e,23,8)},s=function(e){return n(e,52,11)},l=function(e){var n=r(e,16,32);if(49152==n){return NaN}for(var a=t(1e4,r(e,16,16)),o=0,s=r(e,16),l=0;l<s;l++){o+=r(e,16,64+16*l)*a;a/=1e4}var i=t(10,r(e,16,48));return(0===n?1:-1)*Math.round(o*i)/i},d=function(e,t){var n=r(t,1),a=r(t,63,1),i=new Date((0===n?1:-1)*a/1e3+9.466848e11);if(!e){i.setTime(i.getTime()+6e4*i.getTimezoneOffset())}i.usec=a%1e3;i.getMicroSeconds=function(){return this.usec};i.setMicroSeconds=function(e){this.usec=e};i.getUTCMicroSeconds=function(){return this.usec};return i},p=function(e){for(var t=r(e,32),n=r(e,32,32),a=r(e,32,64),o=96,s=[],l=0;l<t;l++){s[l]=r(e,32,o);o+=32;o+=32}var d=function(t){var n=r(e,32,o);o+=32;if(4294967295==n){return null}var a;if(23==t||20==t){a=r(e,8*n,o);o+=8*n;return a}else if(25==t){a=e.toString(this.encoding,o>>3,(o+=n<<3)>>3);return a}else{console.log('ERROR: ElementType not implemented: '+t)}},p=function(e,t){var r=[],n;if(1<e.length){var a=e.shift();for(n=0;n<a;n++){r[n]=p(e,t)}e.unshift(a)}else{for(n=0;n<e[0];n++){r[n]=d(t)}}return r};return p(s,a)},u=function(e){return e.toString('utf8')},c=function(e){if(null===e)return null;return 0<r(e,8)};e.exports={init:function(e){e(21,a);e(23,i);e(26,i);e(1700,l);e(700,o);e(701,s);e(16,c);e(1114,d.bind(null,false));e(1184,d.bind(null,true));e(1e3,p);e(1007,p);e(1016,p);e(1008,p);e(1009,p);e(25,u)}}},function(e,t,r){'use strict';var n=r(6),a=r(33),i=r(34);e.exports=function(e,t){var r=i.getFileName();a.stat(r,function(n,o){if(n||!i.usePgPass(o,r)){return t(undefined)}var s=a.createReadStream(r);i.getPassword(e,s,t)})};e.exports.warnTo=i.warnTo},function(e){e.exports=require('fs')},function(e,t,r){'use strict';var i=r(6),o=r(4).Stream,s=r(35),l=r(0),d='win32'===process.platform,p=process.stderr;function n(e){return(e&61440)==32768}var u=['host','port','database','user','password'],c=u.length,m=u[c-1];function a(){var e=p instanceof o&&true===p.writable;if(e){var t=Array.prototype.slice.call(arguments).concat('\n');p.write(l.format.apply(l,t))}}Object.defineProperty(e.exports,'isWin',{get:function(){return d},set:function(e){d=e}});e.exports.warnTo=function(e){var t=p;p=e;return t};e.exports.getFileName=function(e){e=e||process.env;var t=e.PGPASSFILE||(d?i.join(e.APPDATA,'postgresql','pgpass.conf'):i.join(e.HOME,'.pgpass'));return t};e.exports.usePgPass=function(e,t){if(Object.prototype.hasOwnProperty.call(process.env,'PGPASSWORD')){return false}if(d){return true}t=t||'<unkn>';if(!n(e.mode)){a('WARNING: password file "%s" is not a plain file',t);return false}if(e.mode&(56|7)){a('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',t);return false}return true};var g=e.exports.match=function(e,t){return u.slice(0,-1).reduce(function(r,n,a){if(1==a){if(Number(e[n]||5432)===Number(t[n])){return r&&true}}return r&&('*'===t[n]||t[n]===e[n])},true)};e.exports.getPassword=function(e,t,r){var n,i=t.pipe(new s);var o=function(e){t.destroy();a('WARNING: error on reading file: %s',e);r(undefined)};t.on('error',o);i.on('data',function(t){var r=f(t);if(r&&y(r)&&g(e,r)){n=r[m];i.end()}}).on('end',function(){t.destroy();r(n)}).on('error',o)};var f=e.exports.parseLine=function(e){if(11>e.length||e.match(/^\s+#/)){return null}for(var t='',r='',n=0,a=0,o={},s=false,l=function(t,r,n){var a=e.substring(r,n);if(!Object.hasOwnProperty.call(process.env,'PGPASS_NO_DEESCAPE')){a=a.replace(/\\([:\\])/g,'$1')}o[u[t]]=a},d=0;d<e.length-1;d+=1){t=e.charAt(d+1);r=e.charAt(d);s=n==c-1;if(s){l(n,a);break}if(0<=d&&':'==t&&'\\'!==r){l(n,a,d+1);a=d+2;n+=1}}o=Object.keys(o).length===c?o:null;return o},y=e.exports.isValidEntry=function(e){for(var t={0:function(e){return 0<e.length},1:function(e){if('*'===e){return true}e=Number(e);return isFinite(e)&&0<e&&9007199254740992>e&&Math.floor(e)===e},2:function(e){return 0<e.length},3:function(e){return 0<e.length},4:function(e){return 0<e.length}},r=0;r<u.length;r+=1){var n=t[r],a=e[u[r]]||'',i=n(a);if(!i){return false}}return true}},function(e,t,r){var n=r(36),a=r(8).StringDecoder;e.exports=function(e,t,r){var s=new a,l='',d=r&&r.maxLength,p=r&&false===r.trailing?false:true;if('function'===typeof e)t=e,e=null;if(!e)e=/\r?\n/;function o(e,r){if(t){try{r=t(r)}catch(t){return e.emit('error',t)}if('undefined'!==typeof r)e.queue(r)}else e.queue(r)}function i(t,r){var n=((null!=l?l:'')+r).split(e);l=n.pop();if(d&&l.length>d)return t.emit('error',new Error('maximum buffer reached'));for(var a=0,i;a<n.length;a++){i=n[a];o(t,i)}}return n(function(e){i(this,s.write(e))},function(){if(s.end)i(this,s.end());if(p&&null!=l)o(this,l);this.queue(null)})}},function(e,t,r){var a=r(4);t=e.exports=n;n.through=n;function n(e,t,r){e=e||function(e){this.queue(e)};t=t||function(){this.queue(null)};var o=false,s=false,l=[],d=false,p=new a;p.readable=p.writable=true;p.paused=false;p.autoDestroy=!(r&&false===r.autoDestroy);p.write=function(t){e.call(this,t);return!p.paused};function n(){while(l.length&&!p.paused){var e=l.shift();if(null===e)return p.emit('end');else p.emit('data',e)}}p.queue=p.push=function(e){if(d)return p;if(null===e)d=true;l.push(e);n();return p};p.on('end',function(){p.readable=false;if(!p.writable&&p.autoDestroy)process.nextTick(function(){p.destroy()})});function i(){p.writable=false;t.call(p);if(!p.readable&&p.autoDestroy)p.destroy()}p.end=function(e){if(o)return;o=true;if(arguments.length)p.write(e);i();return p};p.destroy=function(){if(s)return;s=true;o=true;l.length=0;p.writable=p.readable=false;p.emit('close');return p};p.pause=function(){if(p.paused)return;p.paused=true;return p};p.resume=function(){if(p.paused){p.paused=false;p.emit('resume')}n();if(!p.paused)p.emit('drain');return p};return p}},function(e){e.exports=require('dns')},function(e,t,r){'use strict';var n=r(39);e.exports={parse:function(e){var t;if('/'===e.charAt(0)){t=e.split(' ');return{host:t[0],database:t[1]}}if(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(e)){e=encodeURI(e).replace(/\%25(\d\d)/g,'%$1')}var r=n.parse(e,true);t={};if(r.query.application_name){t.application_name=r.query.application_name}if(r.query.fallback_application_name){t.fallback_application_name=r.query.fallback_application_name}t.port=r.port;if('socket:'==r.protocol){t.host=decodeURI(r.pathname);t.database=r.query.db;t.client_encoding=r.query.encoding;return t}t.host=r.hostname;var a=r.pathname;if(a&&'/'===a.charAt(0)){a=r.pathname.slice(1)||null}t.database=a&&decodeURI(a);var i=(r.auth||':').split(':');t.user=i[0];t.password=i.splice(1).join(':');var o=r.query.ssl;if('true'===o||'1'===o){t.ssl=true}return t}}},function(e){e.exports=require('url')},function(e,t,r){'use strict';var n=r(1).EventEmitter,a=r(0),i=r(41),o=r(7),s=function(e,t,r){if(!(this instanceof s)){return new s(e,t,r)}e=o.normalizeQueryConfig(e,t,r);this.text=e.text;this.values=e.values;this.rows=e.rows;this.types=e.types;this.name=e.name;this.binary=e.binary;this.stream=e.stream;this.portal=e.portal||'';this.callback=e.callback;this._rowMode=e.rowMode;if(process.domain&&e.callback){this.callback=process.domain.bind(e.callback)}this._result=new i(this._rowMode,this.types);this._results=this._result;this.isPreparedStatement=false;this._canceledDueToError=false;this._promise=null;n.call(this)};a.inherits(s,n);s.prototype.requiresPreparation=function(){if(this.name){return true}if(this.rows){return true}if(!this.text){return false}if(!this.values){return false}return 0<this.values.length};s.prototype._checkForMultirow=function(){if(this._result.command){if(!Array.isArray(this._results)){this._results=[this._result]}this._result=new i(this._rowMode,this.types);this._results.push(this._result)}};s.prototype.handleRowDescription=function(e){this._checkForMultirow();this._result.addFields(e.fields);this._accumulateRows=this.callback||!this.listeners('row').length};s.prototype.handleDataRow=function(e){var t;if(this._canceledDueToError){return}try{t=this._result.parseRow(e.fields)}catch(e){this._canceledDueToError=e;return}this.emit('row',t,this._result);if(this._accumulateRows){this._result.addRow(t)}};s.prototype.handleCommandComplete=function(e,t){this._checkForMultirow();this._result.addCommandComplete(e);if(this.isPreparedStatement){t.sync()}};s.prototype.handleEmptyQuery=function(e){if(this.isPreparedStatement){e.sync()}};s.prototype.handleReadyForQuery=function(e){if(this._canceledDueToError){return this.handleError(this._canceledDueToError,e)}if(this.callback){this.callback(null,this._results)}this.emit('end',this._results)};s.prototype.handleError=function(e,t){if(this.isPreparedStatement){t.sync()}if(this._canceledDueToError){e=this._canceledDueToError;this._canceledDueToError=false}if(this.callback){return this.callback(e)}this.emit('error',e)};s.prototype.submit=function(e){if('string'!==typeof this.text&&'string'!==typeof this.name){const t=new Error('A query must have either text or a name. Supplying neither is unsupported.');e.emit('error',t);e.emit('readyForQuery');return}if(this.values&&!Array.isArray(this.values)){const t=new Error('Query values must be an array');e.emit('error',t);e.emit('readyForQuery');return}if(this.requiresPreparation()){this.prepare(e)}else{e.query(this.text)}};s.prototype.hasBeenParsed=function(e){return this.name&&e.parsedStatements[this.name]};s.prototype.handlePortalSuspended=function(e){this._getRows(e,this.rows)};s.prototype._getRows=function(e,t){e.execute({portal:this.portalName,rows:t},true);e.flush()};s.prototype.prepare=function(e){var t=this;this.isPreparedStatement=true;if(!this.hasBeenParsed(e)){e.parse({text:t.text,name:t.name,types:t.types},true)}if(t.values){t.values=t.values.map(o.prepareValue)}e.bind({portal:t.portalName,statement:t.name,values:t.values,binary:t.binary},true);e.describe({type:'P',name:t.portalName||''},true);this._getRows(e,this.rows)};s.prototype.handleCopyInResponse=function(e){if(this.stream)this.stream.startStreamingToConnection(e);else e.sendCopyFail('No source stream defined')};s.prototype.handleCopyData=function(e){var t=e.chunk;if(this.stream){this.stream.handleChunk(t)}};e.exports=s},function(e,t,r){'use strict';var n=r(3),a=r(42),i=function(e){this.command=null;this.rowCount=null;this.oid=null;this.rows=[];this.fields=[];this._parsers=[];this.RowCtor=null;this.rowAsArray='array'===e;if(this.rowAsArray){this.parseRow=this._parseRowAsArray}},o=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/;i.prototype.addCommandComplete=function(e){var t;if(e.text){t=o.exec(e.text)}else{t=o.exec(e.command)}if(t){this.command=t[1];if(t[3]){this.oid=parseInt(t[2],10);this.rowCount=parseInt(t[3],10)}else if(t[2]){this.rowCount=parseInt(t[2],10)}}};i.prototype._parseRowAsArray=function(e){for(var t=[],r=0,n=e.length,a;r<n;r++){a=e[r];if(null!==a){t.push(this._parsers[r](a))}else{t.push(null)}}return t};i.prototype.parseRow=function(e){return new this.RowCtor(this._parsers,e)};i.prototype.addRow=function(e){this.rows.push(e)};var s=function(e,t){return'\nthis[\''+a(e)+'\'] = rowData['+t+'] == null ? null : parsers['+t+'](rowData['+t+']);'};i.prototype.addFields=function(e){if(this.fields.length){this.fields=[];this._parsers=[]}for(var t='',r=0,n;r<e.length;r++){n=e[r];this.fields.push(n);var a=this._getTypeParser(n.dataTypeID,n.format||'text');this._parsers.push(a);t+=s(n.name,r)}if(!this.rowAsArray){this.RowCtor=Function('parsers','rowData',t)}};i.prototype._getTypeParser=n.getTypeParser;e.exports=i},function(e){e.exports=function(e){return(''+e).replace(/["'\\\n\r\u2028\u2029]/g,function(e){switch(e){case'"':case'\'':case'\\':return'\\'+e;case'\n':return'\\n';case'\r':return'\\r';case'\u2028':return'\\u2028';case'\u2029':return'\\u2029';}})}},function(e){e.exports=require('net')},function(e){var t=e.exports=function(e){this.size=e||1024;this.buffer=Buffer(this.size+5);this.offset=5;this.headerPosition=0};t.prototype._ensure=function(e){var t=this.buffer.length-this.offset;if(t<e){var r=this.buffer,n=r.length+(r.length>>1)+e;this.buffer=new Buffer(n);r.copy(this.buffer)}};t.prototype.addInt32=function(e){this._ensure(4);this.buffer[this.offset++]=255&e>>>24;this.buffer[this.offset++]=255&e>>>16;this.buffer[this.offset++]=255&e>>>8;this.buffer[this.offset++]=255&e>>>0;return this};t.prototype.addInt16=function(e){this._ensure(2);this.buffer[this.offset++]=255&e>>>8;this.buffer[this.offset++]=255&e>>>0;return this};var r=function(e,t,r,n){e.write(t,r,n)};if(3===Buffer.prototype.write.length){r=function(e,t,r){e.write(t,r)}}t.prototype.addCString=function(e){if(!e){this._ensure(1)}else{var t=Buffer.byteLength(e);this._ensure(t+1);r(this.buffer,e,this.offset,t);this.offset+=t}this.buffer[this.offset++]=0;return this};t.prototype.addChar=function(e){this._ensure(1);r(this.buffer,e,this.offset,1);this.offset++;return this};t.prototype.addString=function(e){e=e||'';var t=Buffer.byteLength(e);this._ensure(t);this.buffer.write(e,this.offset);this.offset+=t;return this};t.prototype.getByteLength=function(){return this.offset-5};t.prototype.add=function(e){this._ensure(e.length);e.copy(this.buffer,this.offset);this.offset+=e.length;return this};t.prototype.clear=function(){this.offset=5;this.headerPosition=0;this.lastEnd=0};t.prototype.addHeader=function(e,t){var r=this.offset;this.offset=this.headerPosition;this.buffer[this.offset++]=e;this.addInt32(r-(this.headerPosition+1));this.headerPosition=r;this.offset=r;if(!t){this._ensure(5);this.offset+=5}};t.prototype.join=function(e){if(e){this.addHeader(e,true)}return this.buffer.slice(e?0:5,this.offset)};t.prototype.flush=function(e){var t=this.join(e);this.clear();return t}},function(e,t,r){var n=r(16),a=e.exports=function(e){if('number'==typeof e){e={headerSize:e}}e=e||{};this.offset=0;this.lastChunk=false;this.chunk=null;this.chunkLength=0;this.headerSize=e.headerSize||0;this.lengthPadding=e.lengthPadding||0;this.header=null;n(2>this.headerSize,'pre-length header of more than 1 byte length not currently supported')};a.prototype.addChunk=function(e){if(!this.chunk||this.offset===this.chunkLength){this.chunk=e;this.chunkLength=e.length;this.offset=0;return}var t=e.length,r=this.chunkLength+t;if(r>this.chunk.length){var n=2*this.chunk.length;while(r>=n){n*=2}var a=new Buffer(n);this.chunk.copy(a);this.chunk=a}e.copy(this.chunk,this.chunkLength);this.chunkLength=r};a.prototype.read=function(){if(this.chunkLength<this.headerSize+4+this.offset){return false}if(this.headerSize){this.header=this.chunk[this.offset]}var e=this.chunk.readUInt32BE(this.offset+this.headerSize)+this.lengthPadding,t=this.chunkLength-(this.offset+4+this.headerSize);if(e>t){return false}this.offset+=this.headerSize+4;var r=this.chunk.slice(this.offset,this.offset+e);this.offset+=e;return r}},function(e){e.exports=require('tls')},function(e,t,r){'use strict';const o=r(1).EventEmitter,s=function(){},l=(e,t)=>{const r=e.findIndex(t);return-1===r?undefined:e.splice(r,1)[0]};class d{constructor(e,t){this.client=e;this.timeoutId=t}}function n(){throw new Error('Release called on client which has already been released to the pool.')}function a(e,t){e.release=n;if(t||this.ending){this._remove(e);this._pulseQueue();return}let r;if(this.options.idleTimeoutMillis){r=setTimeout(()=>{this.log('remove idle client');this._remove(e)},this.options.idleTimeoutMillis)}this._idle.push(new d(e,r));this._pulseQueue()}function i(e,t){if(t){return{callback:t,result:undefined}}let r,n;const a=new e(function(e,t){n=e;r=t});return{callback:function(e,t){e?r(e):n(t)},result:a}}class p extends o{constructor(e,t){super();this.options=Object.assign({},e);this.options.max=this.options.max||this.options.poolSize||10;this.log=this.options.log||function(){};this.Client=this.options.Client||t||r(9).Client;this.Promise=this.options.Promise||global.Promise;if('undefined'===typeof this.options.idleTimeoutMillis){this.options.idleTimeoutMillis=1e4}this._clients=[];this._idle=[];this._pendingQueue=[];this._endCallback=undefined;this.ending=false}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){this.log('pulse queue');if(this.ending){this.log('pulse queue on ending');if(this._idle.length){this._idle.slice().map((e)=>{this._remove(e.client)})}if(!this._clients.length){this._endCallback()}return}if(!this._pendingQueue.length){this.log('no queued requests');return}if(!this._idle.length&&this._isFull()){return}const e=this._pendingQueue.shift();if(this._idle.length){const t=this._idle.pop();clearTimeout(t.timeoutId);const r=t.client;r.release=a.bind(this,r);this.emit('acquire',r);return e(undefined,r,r.release)}if(!this._isFull()){return this.connect(e)}throw new Error('unexpected condition')}_remove(e){const t=l(this._idle,(t)=>t.client===e);if(t!==undefined){clearTimeout(t.timeoutId)}this._clients=this._clients.filter((t)=>t!==e);e.end();this.emit('remove',e)}connect(e){if(this.ending){const t=new Error('Cannot use a pool after calling end on the pool');return e?e(t):this.Promise.reject(t)}if(this._clients.length>=this.options.max||this._idle.length){const t=i(this.Promise,e),r=t.result;if(this._idle.length){process.nextTick(()=>this._pulseQueue())}if(!this.options.connectionTimeoutMillis){this._pendingQueue.push(t.callback);return r}const n=setTimeout(()=>{this._pendingQueue=this._pendingQueue.filter((e)=>e===t.callback);t.callback(new Error('timeout exceeded when trying to connect'))},this.options.connectionTimeoutMillis);this._pendingQueue.push(function(e,r,a){clearTimeout(n);t.callback(e,r,a)});return r}const t=new this.Client(this.options);this._clients.push(t);const r=(e)=>{e.client=t;t.removeListener('error',r);t.on('error',()=>{this.log('additional client error after disconnection due to error',e)});this._remove(t);this.emit('error',e,t)};this.log('connecting new client');let n,o=false;if(this.options.connectionTimeoutMillis){n=setTimeout(()=>{this.log('ending client due to timeout');o=true;t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)}const l=i(this.Promise,e);e=l.callback;this.log('connecting new client');t.connect((i)=>{this.log('new client connected');if(n){clearTimeout(n)}t.on('error',r);if(i){this._clients=this._clients.filter((e)=>e!==t);if(o){i.message='Connection terminiated due to connection timeout'}e(i,undefined,s)}else{t.release=a.bind(this,t);this.emit('connect',t);this.emit('acquire',t);if(this.options.verify){this.options.verify(t,e)}else{e(undefined,t,t.release)}}});return l.result}query(e,t,r){if('function'===typeof e){const t=i(this.Promise,e);setImmediate(function(){return t.callback(new Error('Passing a function as the first parameter to pool.query is not supported'))});return t.result}if('function'===typeof t){r=t;t=undefined}const n=i(this.Promise,r);r=n.callback;this.connect((n,a)=>{if(n){return r(n)}this.log('dispatching query');a.query(e,t,(e,t)=>{this.log('query dispatched');a.release(e);if(e){return r(e)}else{return r(undefined,t)}})});return n.result}end(e){this.log('ending');if(this.ending){const t=new Error('Called end on pool more than once');return e?e(t):this.Promise.reject(t)}this.ending=true;const t=i(this.Promise,e);this._endCallback=t.callback;this._pulseQueue();return t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get totalCount(){return this._clients.length}}e.exports=p},function(e,t,r){'use strict';var n=r(!function(){var t=new Error('Cannot find module "pg-native"');t.code='MODULE_NOT_FOUND';throw t}()),a=r(13),i=r(49),o=r(50),s=r(16),l=r(1).EventEmitter,d=r(0),p=r(14),u='Version >= '+o.minNativeVersion+' of pg-native required.';s(i.gte(n.version,o.minNativeVersion),u);var c=r(51),m=e.exports=function(e){l.call(this);e=e||{};this._types=new a(e.types);this.native=new n({types:this._types});this._queryQueue=[];this._connected=false;this._connecting=false;var t=this.connectionParameters=new p(e);this.user=t.user;this.password=t.password;this.database=t.database;this.host=t.host;this.port=t.port;this.namedQueries={}};m.Query=c;d.inherits(m,l);m.prototype.connect=function(e){var t=this,r=function(r){if(e)return e(r);return t.emit('error',r)},n;if(!e){var a,i;e=(e)=>e?i(e):a();n=new global.Promise(function(e,t){a=e;i=t})}if(this._connecting){process.nextTick(()=>e(new Error('Client has already been connected. You cannot reuse a client.')));return n}this._connecting=true;this.connectionParameters.getLibpqConnectionString(function(n,a){if(n)return r(n);t.native.connect(a,function(n){if(n)return r(n);t._connected=true;t.native.on('error',function(e){if(t._activeQuery&&'end'!==t._activeQuery.state){return}t.emit('error',e)});t.native.on('notification',function(e){t.emit('notification',{channel:e.relname,payload:e.extra})});t.emit('connect');t._pulseQueryQueue(true);if(e)e()})});return n};m.prototype.query=function(e,t,r){if('function'===typeof e.submit){if('function'===typeof t){e.callback=t}this._queryQueue.push(e);this._pulseQueryQueue();return e}var n=new c(e,t,r),a;if(!n.callback){let e,t;a=new Promise((r,n)=>{e=r;t=n});n.callback=(r,n)=>r?t(r):e(n)}this._queryQueue.push(n);this._pulseQueryQueue();return a};m.prototype.end=function(e){var t=this;if(!this._connected){this.once('connect',this.end.bind(this,e))}var r;if(!e){var n,a;e=(e)=>e?a(e):n();r=new global.Promise(function(e,t){n=e;a=t})}this.native.end(function(){if(t._hasActiveQuery()){t._queryQueue.length=0;t._activeQuery.handleError(new Error('Connection terminated'))}t.emit('end');if(e)e()});return r};m.prototype._hasActiveQuery=function(){return this._activeQuery&&'error'!==this._activeQuery.state&&'end'!==this._activeQuery.state};m.prototype._pulseQueryQueue=function(e){if(!this._connected){return}if(this._hasActiveQuery()){return}var t=this._queryQueue.shift();if(!t){if(!e){this.emit('drain')}return}this._activeQuery=t;t.submit(this);var r=this;t.once('_done',function(){r._pulseQueryQueue()})};m.prototype.cancel=function(e){if(this._activeQuery===e){this.native.cancel(function(){})}else if(-1!==this._queryQueue.indexOf(e)){this._queryQueue.splice(this._queryQueue.indexOf(e),1)}};m.prototype.setTypeParser=function(e,t,r){return this._types.setTypeParser(e,t,r)};m.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)}},function(e,t,r){var A,k;if('object'===typeof e&&e.exports===t)t=e.exports=o;var L;if('object'===typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG))L=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift('SEMVER');console.log.apply(console,e)};else L=function(){};t.SEMVER_SPEC_VERSION='2.0.0';var N=256,M=Number.MAX_SAFE_INTEGER||9007199254740991,j=t.re=[],q=t.src=[],U=0,R=U++;q[R]='0|[1-9]\\d*';var F=U++;q[F]='[0-9]+';var Q=U++;q[Q]='\\d*[a-zA-Z-][a-zA-Z0-9-]*';var G=U++;q[G]='('+q[R]+')\\.('+q[R]+')\\.('+q[R]+')';var H=U++;q[H]='('+q[F]+')\\.('+q[F]+')\\.('+q[F]+')';var z=U++;q[z]='(?:'+q[R]+'|'+q[Q]+')';var V=U++;q[V]='(?:'+q[F]+'|'+q[Q]+')';var B=U++;q[B]='(?:-('+q[z]+'(?:\\.'+q[z]+')*))';var $=U++;q[$]='(?:-?('+q[V]+'(?:\\.'+q[V]+')*))';var X=U++;q[X]='[0-9A-Za-z-]+';var W=U++;q[W]='(?:\\+('+q[X]+'(?:\\.'+q[X]+')*))';var Y=U++,K='v?'+q[G]+q[B]+'?'+q[W]+'?';q[Y]='^'+K+'$';var Z='[v=\\s]*'+q[H]+q[$]+'?'+q[W]+'?',J=U++;q[J]='^'+Z+'$';var ee=U++;q[ee]='((?:<|>)?=?)';var te=U++;q[te]=q[F]+'|x|X|\\*';var re=U++;q[re]=q[R]+'|x|X|\\*';var ne=U++;q[ne]='[v=\\s]*('+q[re]+')(?:\\.('+q[re]+')(?:\\.('+q[re]+')(?:'+q[B]+')?'+q[W]+'?)?)?';var ae=U++;q[ae]='[v=\\s]*('+q[te]+')(?:\\.('+q[te]+')(?:\\.('+q[te]+')(?:'+q[$]+')?'+q[W]+'?)?)?';var ie=U++;q[ie]='^'+q[ee]+'\\s*'+q[ne]+'$';var oe=U++;q[oe]='^'+q[ee]+'\\s*'+q[ae]+'$';var se=U++;q[se]='(?:~>?)';var le=U++;q[le]='(\\s*)'+q[se]+'\\s+';j[le]=new RegExp(q[le],'g');var de=U++;q[de]='^'+q[se]+q[ne]+'$';var pe=U++;q[pe]='^'+q[se]+q[ae]+'$';var ue=U++;q[ue]='(?:\\^)';var ce=U++;q[ce]='(\\s*)'+q[ue]+'\\s+';j[ce]=new RegExp(q[ce],'g');var me=U++;q[me]='^'+q[ue]+q[ne]+'$';var ge=U++;q[ge]='^'+q[ue]+q[ae]+'$';var fe=U++;q[fe]='^'+q[ee]+'\\s*('+Z+')$|^$';var ye=U++;q[ye]='^'+q[ee]+'\\s*('+K+')$|^$';var he=U++;q[he]='(\\s*)'+q[ee]+'\\s*('+Z+'|'+q[ne]+')';j[he]=new RegExp(q[he],'g');var be=U++;q[be]='^\\s*('+q[ne]+')\\s+-\\s+('+q[ne]+')\\s*$';var _e=U++;q[_e]='^\\s*('+q[ae]+')\\s+-\\s+('+q[ae]+')\\s*$';var Ee=U++;q[Ee]='(<|>)?=?\\s*\\*';for(var ve=0;ve<U;ve++){L(ve,q[ve]);if(!j[ve])j[ve]=new RegExp(q[ve])}t.parse=n;function n(e,t){if(e.length>N)return null;var n=t?j[J]:j[Y];if(!n.test(e))return null;try{return new o(e,t)}catch(e){return null}}t.valid=function(e,t){var r=n(e,t);return r?r.version:null};t.clean=function(e,t){var r=n(e.trim().replace(/^[=v]+/,''),t);return r?r.version:null};t.SemVer=o;function o(e,t){if(e instanceof o){if(e.loose===t)return e;else e=e.version}else if('string'!==typeof e){throw new TypeError('Invalid Version: '+e)}if(e.length>N)throw new TypeError('version is longer than '+N+' characters');if(!(this instanceof o))return new o(e,t);L('SemVer',e,t);this.loose=t;var r=e.trim().match(t?j[J]:j[Y]);if(!r)throw new TypeError('Invalid Version: '+e);this.raw=e;this.major=+r[1];this.minor=+r[2];this.patch=+r[3];if(this.major>M||0>this.major)throw new TypeError('Invalid major version');if(this.minor>M||0>this.minor)throw new TypeError('Invalid minor version');if(this.patch>M||0>this.patch)throw new TypeError('Invalid patch version');if(!r[4])this.prerelease=[];else this.prerelease=r[4].split('.').map(function(e){return /^[0-9]+$/.test(e)?+e:e});this.build=r[5]?r[5].split('.'):[];this.format()}o.prototype.format=function(){this.version=this.major+'.'+this.minor+'.'+this.patch;if(this.prerelease.length)this.version+='-'+this.prerelease.join('.');return this.version};o.prototype.inspect=function(){return'<SemVer "'+this+'">'};o.prototype.toString=function(){return this.version};o.prototype.compare=function(e){L('SemVer.compare',this.version,this.loose,e);if(!(e instanceof o))e=new o(e,this.loose);return this.compareMain(e)||this.comparePre(e)};o.prototype.compareMain=function(e){if(!(e instanceof o))e=new o(e,this.loose);return s(this.major,e.major)||s(this.minor,e.minor)||s(this.patch,e.patch)};o.prototype.comparePre=function(e){if(!(e instanceof o))e=new o(e,this.loose);if(this.prerelease.length&&!e.prerelease.length)return-1;else if(!this.prerelease.length&&e.prerelease.length)return 1;else if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];L('prerelease compare',t,r,n);if(r===undefined&&n===undefined)return 0;else if(n===undefined)return 1;else if(r===undefined)return-1;else if(r===n)continue;else return s(r,n)}while(++t)};o.prototype.inc=function(e,t){switch(e){case'premajor':this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc('pre',t);break;case'preminor':this.prerelease.length=0;this.patch=0;this.minor++;this.inc('pre',t);break;case'prepatch':this.prerelease.length=0;this.inc('patch',t);this.inc('pre',t);break;case'prerelease':if(0===this.prerelease.length)this.inc('patch',t);this.inc('pre',t);break;case'major':if(0!==this.minor||0!==this.patch||0===this.prerelease.length)this.major++;this.minor=0;this.patch=0;this.prerelease=[];break;case'minor':if(0!==this.patch||0===this.prerelease.length)this.minor++;this.patch=0;this.prerelease=[];break;case'patch':if(0===this.prerelease.length)this.patch++;this.prerelease=[];break;case'pre':if(0===this.prerelease.length)this.prerelease=[0];else{var r=this.prerelease.length;while(0<=--r){if('number'===typeof this.prerelease[r]){this.prerelease[r]++;r=-2}}if(-1===r)this.prerelease.push(0)}if(t){if(this.prerelease[0]===t){if(isNaN(this.prerelease[1]))this.prerelease=[t,0]}else this.prerelease=[t,0]}break;default:throw new Error('invalid increment argument: '+e);}this.format();return this};t.inc=function(e,t,r,n){if('string'===typeof r){n=r;r=undefined}try{return new o(e,r).inc(t,n).version}catch(e){return null}};t.diff=function(e,t){if(c(e,t)){return null}else{var r=n(e),a=n(t);if(r.prerelease.length||a.prerelease.length){for(var i in r){if('major'===i||'minor'===i||'patch'===i){if(r[i]!==a[i]){return'pre'+i}}}return'prerelease'}for(var i in r){if('major'===i||'minor'===i||'patch'===i){if(r[i]!==a[i]){return i}}}}};t.compareIdentifiers=s;var i=/^[0-9]+$/;function s(e,t){var r=i.test(e),n=i.test(t);if(r&&n){e=+e;t=+t}return r&&!n?-1:n&&!r?1:e<t?-1:e>t?1:0}t.rcompareIdentifiers=function(e,t){return s(t,e)};t.major=function(e,t){return new o(e,t).major};t.minor=function(e,t){return new o(e,t).minor};t.patch=function(e,t){return new o(e,t).patch};t.compare=l;function l(e,t,r){return new o(e,r).compare(t)}t.compareLoose=function(e,t){return l(e,t,true)};t.rcompare=d;function d(e,t,r){return l(t,e,r)}t.sort=function(e,r){return e.sort(function(e,n){return t.compare(e,n,r)})};t.rsort=function(e,r){return e.sort(function(e,n){return t.rcompare(e,n,r)})};t.gt=p;function p(e,t,r){return 0<l(e,t,r)}t.lt=u;function u(e,t,r){return 0>l(e,t,r)}t.eq=c;function c(e,t,r){return 0===l(e,t,r)}t.neq=m;function m(e,t,r){return 0!==l(e,t,r)}t.gte=g;function g(e,t,r){return 0<=l(e,t,r)}t.lte=f;function f(e,t,r){return 0>=l(e,t,r)}t.cmp=a;function a(e,t,r,n){var i;switch(t){case'===':if('object'===typeof e)e=e.version;if('object'===typeof r)r=r.version;i=e===r;break;case'!==':if('object'===typeof e)e=e.version;if('object'===typeof r)r=r.version;i=e!==r;break;case'':case'=':case'==':i=c(e,r,n);break;case'!=':i=m(e,r,n);break;case'>':i=p(e,r,n);break;case'>=':i=g(e,r,n);break;case'<':i=u(e,r,n);break;case'<=':i=f(e,r,n);break;default:throw new TypeError('Invalid operator: '+t);}return i}t.Comparator=y;function y(e,t){if(e instanceof y){if(e.loose===t)return e;else e=e.value}if(!(this instanceof y))return new y(e,t);L('comparator',e,t);this.loose=t;this.parse(e);if(this.semver===Ie)this.value='';else this.value=this.operator+this.semver.version;L('comp',this)}var Ie={};y.prototype.parse=function(e){var t=this.loose?j[fe]:j[ye],r=e.match(t);if(!r)throw new TypeError('Invalid comparator: '+e);this.operator=r[1];if('='===this.operator)this.operator='';if(!r[2])this.semver=Ie;else this.semver=new o(r[2],this.loose)};y.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'};y.prototype.toString=function(){return this.value};y.prototype.test=function(e){L('Comparator.test',e,this.loose);if(this.semver===Ie)return true;if('string'===typeof e)e=new o(e,this.loose);return a(e,this.operator,this.semver,this.loose)};t.Range=h;function h(e,t){if(e instanceof h&&e.loose===t)return e;if(!(this instanceof h))return new h(e,t);this.loose=t;this.raw=e;this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length});if(!this.set.length){throw new TypeError('Invalid SemVer Range: '+e)}this.format()}h.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'};h.prototype.format=function(){this.range=this.set.map(function(e){return e.join(' ').trim()}).join('||').trim();return this.range};h.prototype.toString=function(){return this.range};h.prototype.parseRange=function(e){var t=this.loose;e=e.trim();L('range',e,t);var r=t?j[_e]:j[be];e=e.replace(r,C);L('hyphen replace',e);e=e.replace(j[he],'$1$2$3');L('comparator trim',e,j[he]);e=e.replace(j[le],'$1~');e=e.replace(j[ce],'$1^');e=e.split(/\s+/).join(' ');var n=t?j[fe]:j[ye],a=e.split(' ').map(function(e){return b(e,t)}).join(' ').split(/\s+/);if(this.loose){a=a.filter(function(e){return!!e.match(n)})}a=a.map(function(e){return new y(e,t)});return a};t.toComparators=function(e,t){return new h(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(' ').trim().split(' ')})};function b(e,t){L('comp',e);e=I(e,t);L('caret',e);e=_(e,t);L('tildes',e);e=S(e,t);L('xrange',e);e=w(e,t);L('stars',e);return e}function E(e){return!e||'x'===e.toLowerCase()||'*'===e}function _(e,t){return e.trim().split(/\s+/).map(function(e){return v(e,t)}).join(' ')}function v(e,t){var n=t?j[pe]:j[de];return e.replace(n,function(t,r,n,a,i){L('tilde',e,t,r,n,a,i);var o;if(E(r))o='';else if(E(n))o='>='+r+'.0.0 <'+(+r+1)+'.0.0';else if(E(a))o='>='+r+'.'+n+'.0 <'+r+'.'+(+n+1)+'.0';else if(i){L('replaceTilde pr',i);if('-'!==i.charAt(0))i='-'+i;o='>='+r+'.'+n+'.'+a+i+' <'+r+'.'+(+n+1)+'.0'}else o='>='+r+'.'+n+'.'+a+' <'+r+'.'+(+n+1)+'.0';L('tilde return',o);return o})}function I(e,t){return e.trim().split(/\s+/).map(function(e){return T(e,t)}).join(' ')}function T(e,t){L('caret',e,t);var n=t?j[ge]:j[me];return e.replace(n,function(t,r,n,a,i){L('caret',e,t,r,n,a,i);var o;if(E(r))o='';else if(E(n))o='>='+r+'.0.0 <'+(+r+1)+'.0.0';else if(E(a)){if('0'===r)o='>='+r+'.'+n+'.0 <'+r+'.'+(+n+1)+'.0';else o='>='+r+'.'+n+'.0 <'+(+r+1)+'.0.0'}else if(i){L('replaceCaret pr',i);if('-'!==i.charAt(0))i='-'+i;if('0'===r){if('0'===n)o='>='+r+'.'+n+'.'+a+i+' <'+r+'.'+n+'.'+(+a+1);else o='>='+r+'.'+n+'.'+a+i+' <'+r+'.'+(+n+1)+'.0'}else o='>='+r+'.'+n+'.'+a+i+' <'+(+r+1)+'.0.0'}else{L('no pr');if('0'===r){if('0'===n)o='>='+r+'.'+n+'.'+a+' <'+r+'.'+n+'.'+(+a+1);else o='>='+r+'.'+n+'.'+a+' <'+r+'.'+(+n+1)+'.0'}else o='>='+r+'.'+n+'.'+a+' <'+(+r+1)+'.0.0'}L('caret return',o);return o})}function S(e,t){L('replaceXRanges',e,t);return e.split(/\s+/).map(function(e){return x(e,t)}).join(' ')}function x(e,t){e=e.trim();var n=t?j[oe]:j[ie];return e.replace(n,function(t,r,n,a,i,o){L('xRange',e,t,r,n,a,i,o);var s=E(n),l=s||E(a),d=l||E(i),p=d;if('='===r&&p)r='';if(s){if('>'===r||'<'===r){t='<0.0.0'}else{t='*'}}else if(r&&p){if(l)a=0;if(d)i=0;if('>'===r){r='>=';if(l){n=+n+1;a=0;i=0}else if(d){a=+a+1;i=0}}else if('<='===r){r='<';if(l)n=+n+1;else a=+a+1}t=r+n+'.'+a+'.'+i}else if(l){t='>='+n+'.0.0 <'+(+n+1)+'.0.0'}else if(d){t='>='+n+'.'+a+'.0 <'+n+'.'+(+a+1)+'.0'}L('xRange return',t);return t})}function w(e,t){L('replaceStars',e,t);return e.trim().replace(j[Ee],'')}function C(e,t,r,n,a,i,o,s,l,d,p,u){if(E(r))t='';else if(E(n))t='>='+r+'.0.0';else if(E(a))t='>='+r+'.'+n+'.0';else t='>='+t;if(E(l))s='';else if(E(d))s='<'+(+l+1)+'.0.0';else if(E(p))s='<'+l+'.'+(+d+1)+'.0';else if(u)s='<='+l+'.'+d+'.'+p+'-'+u;else s='<='+s;return(t+' '+s).trim()}h.prototype.test=function(e){if(!e)return false;if('string'===typeof e)e=new o(e,this.loose);for(var t=0;t<this.set.length;t++){if(D(this.set[t],e))return true}return false};function D(e,t){for(var r=0;r<e.length;r++){if(!e[r].test(t))return false}if(t.prerelease.length){for(var r=0;r<e.length;r++){L(e[r].semver);if(e[r].semver===Ie)return true;if(0<e[r].semver.prerelease.length){var n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return true}}return false}return true}t.satisfies=O;function O(e,t,r){try{t=new h(t,r)}catch(e){return false}return t.test(e)}t.maxSatisfying=function(e,t,r){return e.filter(function(e){return O(e,t,r)}).sort(function(e,t){return d(e,t,r)})[0]||null};t.validRange=function(e,t){try{return new h(e,t).range||'*'}catch(e){return null}};t.ltr=function(e,t,r){return P(e,t,'<',r)};t.gtr=function(e,t,r){return P(e,t,'>',r)};t.outside=P;function P(e,t,r,n){e=new o(e,n);t=new h(t,n);var a,s,l,d,c;switch(r){case'>':a=p;s=f;l=u;d='>';c='>=';break;case'<':a=u;s=g;l=p;d='<';c='<=';break;default:throw new TypeError('Must provide a hilo val of "<" or ">"');}if(O(e,t,n)){return false}for(var m=0;m<t.set.length;++m){var i=t.set[m],y=null,b=null;i.forEach(function(e){y=y||e;b=b||e;if(a(e.semver,y.semver,n)){y=e}else if(l(e.semver,b.semver,n)){b=e}});if(y.operator===d||y.operator===c){return false}if((!b.operator||b.operator===d)&&s(e,b.semver)){return false}else if(b.operator===c&&l(e,b.semver)){return false}}return true}!(A=t,k='function'===typeof A?A.call(t,r,t,e):A,k!==undefined&&(e.exports=k))},function(e){e.exports={_from:'pg@^7.4.0',_id:'pg@7.4.0',_inBundle:false,_integrity:'sha1-4lYGHSxScjw8hY3vuX8RWcpmD4M=',_location:'/pg',_phantomChildren:{},_requested:{type:'range',registry:true,raw:'pg@^7.4.0',name:'pg',escapedName:'pg',rawSpec:'^7.4.0',saveSpec:null,fetchSpec:'^7.4.0'},_requiredBy:['/'],_resolved:'https://registry.npmjs.org/pg/-/pg-7.4.0.tgz',_shasum:'e256061d2c52723c3c858defb97f1159ca660f83',_spec:'pg@^7.4.0',_where:'/Users/wisdman/Projects/bitjournal',author:{name:'Brian Carlson',email:'brian.m.carlson@gmail.com'},bugs:{url:'https://github.com/brianc/node-postgres/issues'},bundleDependencies:false,dependencies:{"buffer-writer":'1.0.1',"js-string-escape":'1.0.1',"packet-reader":'0.3.1',"pg-connection-string":'0.1.3',"pg-pool":'~2.0.3',"pg-types":'~1.12.1',pgpass:'1.x',semver:'4.3.2'},deprecated:false,description:'PostgreSQL client - pure javascript & libpq with the same API',devDependencies:{async:'0.9.0',co:'4.6.0',eslint:'4.2.0',"eslint-config-standard":'10.2.1',"eslint-plugin-import":'2.7.0',"eslint-plugin-node":'5.1.0',"eslint-plugin-promise":'3.5.0',"eslint-plugin-standard":'3.0.1',"pg-copy-streams":'0.3.0'},engines:{node:'>= 4.5.0'},homepage:'http://github.com/brianc/node-postgres',keywords:['database','libpq','pg','postgre','postgres','postgresql','rdbms'],license:'MIT',main:'./lib',minNativeVersion:'2.0.0',name:'pg',repository:{type:'git',url:'git://github.com/brianc/node-postgres.git'},scripts:{test:'make test-all'},version:'7.4.0'}},function(e,t,r){'use strict';var n=r(1).EventEmitter,a=r(0),i=r(7),o=e.exports=function(e,t,r){n.call(this);e=i.normalizeQueryConfig(e,t,r);this.text=e.text;this.values=e.values;this.name=e.name;this.callback=e.callback;this.state='new';this._arrayMode='array'===e.rowMode;this._emitRowEvents=false;this.on('newListener',function(e){if('row'===e)this._emitRowEvents=true}.bind(this))};a.inherits(o,n);var s={sqlState:'code',statementPosition:'position',messagePrimary:'message',context:'where',schemaName:'schema',tableName:'table',columnName:'column',dataTypeName:'dataType',constraintName:'constraint',sourceFile:'file',sourceLine:'line',sourceFunction:'routine'};o.prototype.handleError=function(e){var t=this.native.pq.resultErrorFields();if(t){for(var r in t){var n=s[r]||r;e[n]=t[r]}}if(this.callback){this.callback(e)}else{this.emit('error',e)}this.state='error'};o.prototype.then=function(e,t){return this._getPromise().then(e,t)};o.prototype.catch=function(e){return this._getPromise().catch(e)};o.prototype._getPromise=function(){if(this._promise)return this._promise;this._promise=new Promise(function(e,t){this._once('end',e);this._once('error',t)}.bind(this));return this._promise};o.prototype.submit=function(e){this.state='running';var t=this;this.native=e.native;e.native.arrayMode=this._arrayMode;var r=function(r,n,a){e.native.arrayMode=false;setImmediate(function(){t.emit('_done')});if(r){return t.handleError(r)}if(t._emitRowEvents){if(1<a.length){n.forEach((e,r)=>{e.forEach((e)=>{t.emit('row',e,a[r])})})}else{n.forEach(function(e){t.emit('row',e,a)})}}t.state='end';t.emit('end',a);if(t.callback){t.callback(null,a)}};if(process.domain){r=process.domain.bind(r)}if(this.name){if(63<this.name.length){console.error('Warning! Postgres only supports 63 characters for query names.');console.error('You supplied',this.name,'(',this.name.length,')');console.error('This can cause conflicts and silent errors executing queries')}var n=(this.values||[]).map(i.prepareValue);if(e.namedQueries[this.name]){return e.native.execute(this.name,n,r)}return e.native.prepare(this.name,this.text,n.length,function(a){if(a)return r(a);e.namedQueries[t.name]=true;return t.native.execute(t.name,n,r)})}else if(this.values){if(!Array.isArray(this.values)){const e=new Error('Query values must be an array');return r(e)}var a=this.values.map(i.prepareValue);e.native.query(this.text,a,r)}else{e.native.query(this.text,r)}}},function(e,t,r){'use strict';t.LargeObjectManager=r(53);t.LargeObject=r(19);t.ReadStream=r(20);t.WriteStream=r(21)},function(e,t,r){'use strict';var i=r(18),o=r(19);function n(e){return function(t,r){e.query(t).then(function(e){r(null,{rows:e})}).catch(function(e){r(e)})}}function a(e){if('function'===typeof e.query){var t=e;this._query=t.query.bind(t)}else if(e.pg){var t=e.pg;this._query=t.query.bind(t)}else if(e.pgPromise){var r=e.pgPromise;this._query=n(r)}else{throw Error('Either the `pg` or `pgPromise` option must be given')}}a.WRITE=131072;a.READ=262144;a.READWRITE=393216;a.prototype.open=function(e,t,r){if(!e){throw Error('Illegal Argument')}this._query({name:'npg_lo_open',text:'SELECT lo_open($1, $2) AS fd',values:[e,t]},function(t,n){if(t)return r(t);var a=n.rows[0].fd;r(null,new o(this._query,e,a))}.bind(this))};a.prototype.openAsync=function(e,t){return i(function(r){this.open(e,t,r)},this)};a.prototype.create=function(e){this._query({name:'npg_lo_creat',text:'SELECT lo_creat($1) AS oid',values:[a.READWRITE]},function(t,r){if(t)return e(t);var n=r.rows[0].oid;e(null,n)})};a.prototype.createAsync=function(){return i(function(e){this.create(e)},this)};a.prototype.unlink=function(e,t){if(!e){throw Error('Illegal Argument')}this._query({name:'npg_lo_unlink',text:'SELECT lo_unlink($1) as ok',values:[e]},t?function(e){t(e)}:undefined)};a.prototype.unlinkAsync=function(e){return i(function(t){this.unlink(e,t)},this)};a.prototype.openAndReadableStream=function(e,t,r){if('function'===typeof t){r=t;t=undefined}this.open(e,a.READ,function(e,n){if(e)return r(e);n.size(function(e,a){if(e)return r(e);var i=n.getReadableStream(t);i.on('end',function(){n.close(function(e){if(e){console.error('Warning: closing a large object failed:',e)}})});r(null,a,i)})})};a.prototype.openAndReadableStreamAsync=function(e,t){return i(function(r){this.openAndReadableStream(e,t,r)},this,{twoArgs:true})};a.prototype.createAndWritableStream=function(e,t){if('function'===typeof e){t=e;e=undefined}var r=this;r.create(function(n,i){if(n)return t(n);r.open(i,a.WRITE,function(r,n){if(r)return t(r);var a=n.getWritableStream(e);a.on('finish',function(){n.close(function(e){if(e){console.error('Warning: closing a large object failed:',e)}})});t(null,i,a)})})};a.prototype.createAndWritableStreamAsync=function(e){return i(function(t){this.createAndWritableStream(e,t)},this,{twoArgs:true})};e.exports=a}]);